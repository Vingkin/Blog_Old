<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å®¹å™¨ä¸ bean | Vingkinçš„å­¦ä¹ æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/Blog/vuepress/favicon.ico">
    <script language="javascript" type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="/Blog/js/MouseClickEffect.js"></script>
    <meta name="description" content="~~~">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.17f0d514.css" as="style"><link rel="preload" href="/Blog/assets/js/app.4417eb82.js" as="script"><link rel="preload" href="/Blog/assets/js/3.2daec6eb.js" as="script"><link rel="preload" href="/Blog/assets/js/1.3441dec7.js" as="script"><link rel="preload" href="/Blog/assets/js/44.155af8d3.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.f0f7997f.js"><link rel="prefetch" href="/Blog/assets/js/11.385157e5.js"><link rel="prefetch" href="/Blog/assets/js/12.43533bfe.js"><link rel="prefetch" href="/Blog/assets/js/13.fca9ec1a.js"><link rel="prefetch" href="/Blog/assets/js/14.4ef5a506.js"><link rel="prefetch" href="/Blog/assets/js/15.25d1439b.js"><link rel="prefetch" href="/Blog/assets/js/16.e4200779.js"><link rel="prefetch" href="/Blog/assets/js/17.0f620a4b.js"><link rel="prefetch" href="/Blog/assets/js/18.3e2c61c2.js"><link rel="prefetch" href="/Blog/assets/js/19.c841fda6.js"><link rel="prefetch" href="/Blog/assets/js/20.7e7aa66c.js"><link rel="prefetch" href="/Blog/assets/js/21.c4003560.js"><link rel="prefetch" href="/Blog/assets/js/22.0406d90f.js"><link rel="prefetch" href="/Blog/assets/js/23.71a12a58.js"><link rel="prefetch" href="/Blog/assets/js/24.dae641fb.js"><link rel="prefetch" href="/Blog/assets/js/25.219b65bd.js"><link rel="prefetch" href="/Blog/assets/js/26.4e8222ba.js"><link rel="prefetch" href="/Blog/assets/js/27.09e9f908.js"><link rel="prefetch" href="/Blog/assets/js/28.c3952bad.js"><link rel="prefetch" href="/Blog/assets/js/29.6f972569.js"><link rel="prefetch" href="/Blog/assets/js/30.c34fffbe.js"><link rel="prefetch" href="/Blog/assets/js/31.c79fd8b8.js"><link rel="prefetch" href="/Blog/assets/js/32.e8d64e7e.js"><link rel="prefetch" href="/Blog/assets/js/33.d1b0b891.js"><link rel="prefetch" href="/Blog/assets/js/34.1f6ad2c0.js"><link rel="prefetch" href="/Blog/assets/js/35.1fac3064.js"><link rel="prefetch" href="/Blog/assets/js/36.80d4f061.js"><link rel="prefetch" href="/Blog/assets/js/37.7aa2ac27.js"><link rel="prefetch" href="/Blog/assets/js/38.2e6db6ef.js"><link rel="prefetch" href="/Blog/assets/js/39.c694788f.js"><link rel="prefetch" href="/Blog/assets/js/4.75bd0991.js"><link rel="prefetch" href="/Blog/assets/js/40.f46a350c.js"><link rel="prefetch" href="/Blog/assets/js/41.31e6560f.js"><link rel="prefetch" href="/Blog/assets/js/42.97d443e9.js"><link rel="prefetch" href="/Blog/assets/js/43.bd75055b.js"><link rel="prefetch" href="/Blog/assets/js/45.a371798f.js"><link rel="prefetch" href="/Blog/assets/js/46.01c1199d.js"><link rel="prefetch" href="/Blog/assets/js/47.d4a385db.js"><link rel="prefetch" href="/Blog/assets/js/48.0ebb7ce7.js"><link rel="prefetch" href="/Blog/assets/js/49.b1cab958.js"><link rel="prefetch" href="/Blog/assets/js/5.fb11ee35.js"><link rel="prefetch" href="/Blog/assets/js/50.6b058eb4.js"><link rel="prefetch" href="/Blog/assets/js/51.a5d807a2.js"><link rel="prefetch" href="/Blog/assets/js/52.3054df5d.js"><link rel="prefetch" href="/Blog/assets/js/53.7470179e.js"><link rel="prefetch" href="/Blog/assets/js/54.7f3159e8.js"><link rel="prefetch" href="/Blog/assets/js/55.5e8ba284.js"><link rel="prefetch" href="/Blog/assets/js/56.acb1d7cf.js"><link rel="prefetch" href="/Blog/assets/js/57.a115610c.js"><link rel="prefetch" href="/Blog/assets/js/58.a97752ca.js"><link rel="prefetch" href="/Blog/assets/js/59.0ffd11b8.js"><link rel="prefetch" href="/Blog/assets/js/6.623615b6.js"><link rel="prefetch" href="/Blog/assets/js/60.e7dc7070.js"><link rel="prefetch" href="/Blog/assets/js/61.e63abaa0.js"><link rel="prefetch" href="/Blog/assets/js/62.d32de587.js"><link rel="prefetch" href="/Blog/assets/js/63.2f3f0652.js"><link rel="prefetch" href="/Blog/assets/js/64.4f989fd3.js"><link rel="prefetch" href="/Blog/assets/js/65.e358d834.js"><link rel="prefetch" href="/Blog/assets/js/66.026d73ea.js"><link rel="prefetch" href="/Blog/assets/js/67.576ada3a.js"><link rel="prefetch" href="/Blog/assets/js/68.9f8f16af.js"><link rel="prefetch" href="/Blog/assets/js/69.07b64bdb.js"><link rel="prefetch" href="/Blog/assets/js/7.9749877c.js"><link rel="prefetch" href="/Blog/assets/js/70.2ee86b48.js"><link rel="prefetch" href="/Blog/assets/js/8.5d1f39fa.js"><link rel="prefetch" href="/Blog/assets/js/9.84e28c7d.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.17f0d514.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-130b300a><div data-v-130b300a><div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-130b300a data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>Vingkinçš„å­¦ä¹ æ–‡æ¡£</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>~~~</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>Vingkin</span>
          Â Â 
          <!---->
          2023
        </a></span></div></div> <div class="hide" data-v-130b300a><header class="navbar" data-v-130b300a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><img src="/Blog/logo.gif" alt="Vingkinçš„å­¦ä¹ æ–‡æ¡£" class="logo"> <span class="site-name">Vingkinçš„å­¦ä¹ æ–‡æ¡£</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/" class="nav-link"><i class="undefined"></i>
  Home
</a></div><div class="nav-item"><a href="/Blog/guide/interview/Java.html" class="nav-link"><i class="undefined"></i>
  Javaç›¸å…³
</a></div><div class="nav-item"><a href="/Blog/OS/OS1.html" class="nav-link"><i class="undefined"></i>
  æ“ä½œç³»ç»Ÿ
</a></div><div class="nav-item"><a href="/Blog/netty/nio/three_component.html" class="nav-link"><i class="undefined"></i>
  Netty
</a></div><div class="nav-item"><a href="/Blog/designmode/SoftwareDesignPrinciples.html" class="nav-link"><i class="undefined"></i>
  è®¾è®¡æ¨¡å¼
</a></div><div class="nav-item"><a href="/Blog/ml/YOLOv3.html" class="nav-link"><i class="undefined"></i>
  æœºå™¨å­¦ä¹ 
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å¾®æœåŠ¡
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/microservice/reactive/reactivestream.html" class="nav-link"><i class="undefined"></i>
  å“åº”å¼ç¼–ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/Blog/microservice/middleware/elasticsearch/ElasticSearchBase.html" class="nav-link"><i class="undefined"></i>
  ä¸­é—´ä»¶
</a></li></ul></div></div> <a href="https://github.com/vingkin/Blog" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask" data-v-130b300a></div> <aside class="sidebar" data-v-130b300a><div class="personal-info-wrapper" data-v-39576ba9 data-v-130b300a><!----> <h3 class="name" data-v-39576ba9>
    Vingkin
  </h3> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>60</h3> <h6 data-v-39576ba9>æ–‡ç« </h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>0</h3> <h6 data-v-39576ba9>æ ‡ç­¾</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/Blog/" class="nav-link"><i class="undefined"></i>
  Home
</a></div><div class="nav-item"><a href="/Blog/guide/interview/Java.html" class="nav-link"><i class="undefined"></i>
  Javaç›¸å…³
</a></div><div class="nav-item"><a href="/Blog/OS/OS1.html" class="nav-link"><i class="undefined"></i>
  æ“ä½œç³»ç»Ÿ
</a></div><div class="nav-item"><a href="/Blog/netty/nio/three_component.html" class="nav-link"><i class="undefined"></i>
  Netty
</a></div><div class="nav-item"><a href="/Blog/designmode/SoftwareDesignPrinciples.html" class="nav-link"><i class="undefined"></i>
  è®¾è®¡æ¨¡å¼
</a></div><div class="nav-item"><a href="/Blog/ml/YOLOv3.html" class="nav-link"><i class="undefined"></i>
  æœºå™¨å­¦ä¹ 
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å¾®æœåŠ¡
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/microservice/reactive/reactivestream.html" class="nav-link"><i class="undefined"></i>
  å“åº”å¼ç¼–ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/Blog/microservice/middleware/elasticsearch/ElasticSearchBase.html" class="nav-link"><i class="undefined"></i>
  ä¸­é—´ä»¶
</a></li></ul></div></div> <a href="https://github.com/vingkin/Blog" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/guide/interview/Java.html" class="sidebar-link">JavaåŸºç¡€</a></li><li><a href="/Blog/guide/interview/JDK8.html" class="sidebar-link">JDK8æ–°ç‰¹æ€§</a></li><li><a href="/Blog/guide/interview/concurrent.html" class="sidebar-link">Javaå¹¶å‘</a></li><li><a href="/Blog/guide/interview/JVM.html" class="sidebar-link">JVM</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ç³»ç»Ÿè®¾è®¡</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ•°æ®åº“</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è®¡ç®—æœºåŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æµ·é‡æ•°æ®</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>åˆ†å¸ƒå¼</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2></h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>Vingkin</span>
          Â Â 
          <!---->
          2023
        </a></span></div></div> <div data-v-130b300a><main class="page"><section><div class="page-title"><h1 class="title">å®¹å™¨ä¸ bean</h1> <div data-v-f875f3fc><i class="iconfont reco-account" data-v-f875f3fc><span data-v-f875f3fc>Vingkin</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h2 id="å®¹å™¨ä¸-bean"><a href="#å®¹å™¨ä¸-bean" class="header-anchor">#</a> å®¹å™¨ä¸ bean</h2> <h3 id="_1-å®¹å™¨æ¥å£"><a href="#_1-å®¹å™¨æ¥å£" class="header-anchor">#</a> 1) å®¹å™¨æ¥å£</h3> <ul><li><p>BeanFactory æ¥å£ï¼Œå…¸å‹åŠŸèƒ½æœ‰ï¼š</p> <ul><li>getBean</li></ul></li> <li><p>ApplicationContext æ¥å£ï¼Œæ˜¯ BeanFactory çš„å­æ¥å£ã€‚å®ƒæ‰©å±•äº† BeanFactory æ¥å£çš„åŠŸèƒ½ï¼Œå¦‚ï¼š</p> <ul><li>å›½é™…åŒ–</li> <li>é€šé…ç¬¦æ–¹å¼è·å–ä¸€ç»„ Resource èµ„æº</li> <li>æ•´åˆ Environment ç¯å¢ƒï¼ˆèƒ½é€šè¿‡å®ƒè·å–å„ç§æ¥æºçš„é…ç½®ä¿¡æ¯ï¼‰</li> <li>äº‹ä»¶å‘å¸ƒä¸ç›‘å¬ï¼Œå®ç°ç»„ä»¶ä¹‹é—´çš„è§£è€¦</li></ul></li></ul> <p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¯¾ä¸Šè®²çš„ï¼Œéƒ½æ˜¯ BeanFactory æä¾›çš„åŸºæœ¬åŠŸèƒ½ï¼ŒApplicationContext ä¸­çš„æ‰©å±•åŠŸèƒ½éƒ½æ²¡æœ‰ç”¨åˆ°ã€‚</p> <h4 id="æ¼”ç¤º1-beanfactory-ä¸-applicationcontext-çš„åŒºåˆ«"><a href="#æ¼”ç¤º1-beanfactory-ä¸-applicationcontext-çš„åŒºåˆ«" class="header-anchor">#</a> æ¼”ç¤º1 - BeanFactory ä¸ ApplicationContext çš„åŒºåˆ«</h4> <h5 id="ä»£ç å‚è€ƒ"><a href="#ä»£ç å‚è€ƒ" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a01</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡"><a href="#æ”¶è·ğŸ’¡" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>é€šè¿‡è¿™ä¸ªç¤ºä¾‹ç»“åˆ debug æŸ¥çœ‹ ApplicationContext å¯¹è±¡çš„å†…éƒ¨ç»“æ„ï¼Œå­¦åˆ°ï¼š</p> <ol><li><p>åˆ°åº•ä»€ä¹ˆæ˜¯ BeanFactory</p> <ul><li>å®ƒæ˜¯ ApplicationContext çš„çˆ¶æ¥å£</li> <li>å®ƒæ‰æ˜¯ Spring çš„æ ¸å¿ƒå®¹å™¨, ä¸»è¦çš„ ApplicationContext å®ç°éƒ½ã€ç»„åˆã€‘äº†å®ƒçš„åŠŸèƒ½ï¼Œã€ç»„åˆã€‘æ˜¯æŒ‡ ApplicationContext çš„ä¸€ä¸ªé‡è¦æˆå‘˜å˜é‡å°±æ˜¯ BeanFactory</li></ul></li> <li><p>BeanFactory èƒ½å¹²ç‚¹å•¥</p> <ul><li>è¡¨é¢ä¸Šåªæœ‰ getBean</li> <li>å®é™…ä¸Šæ§åˆ¶åè½¬ã€åŸºæœ¬çš„ä¾èµ–æ³¨å…¥ã€ç›´è‡³ Bean çš„ç”Ÿå‘½å‘¨æœŸçš„å„ç§åŠŸèƒ½ï¼Œéƒ½ç”±å®ƒçš„å®ç°ç±»æä¾›</li> <li>ä¾‹å­ä¸­é€šè¿‡åå°„æŸ¥çœ‹äº†å®ƒçš„æˆå‘˜å˜é‡ singletonObjectsï¼Œå†…éƒ¨åŒ…å«äº†æ‰€æœ‰çš„å•ä¾‹ bean</li></ul></li> <li><p>ApplicationContext æ¯” BeanFactory å¤šç‚¹å•¥</p> <ul><li>ApplicationContext ç»„åˆå¹¶æ‰©å±•äº† BeanFactory çš„åŠŸèƒ½</li> <li>å›½é™…åŒ–ã€é€šé…ç¬¦æ–¹å¼è·å–ä¸€ç»„ Resource èµ„æºã€æ•´åˆ Environment ç¯å¢ƒã€äº‹ä»¶å‘å¸ƒä¸ç›‘å¬</li> <li>æ–°å­¦ä¸€ç§ä»£ç ä¹‹é—´è§£è€¦é€”å¾„ï¼Œäº‹ä»¶è§£è€¦</li></ul></li></ol> <p>å»ºè®®ç»ƒä¹ ï¼šå®Œæˆç”¨æˆ·æ³¨å†Œä¸å‘é€çŸ­ä¿¡ä¹‹é—´çš„è§£è€¦ï¼Œç”¨äº‹ä»¶æ–¹å¼ã€å’Œ AOP æ–¹å¼åˆ†åˆ«å®ç°</p> <blockquote><p><em><strong>æ³¨æ„</strong></em></p> <ul><li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  --add-opens java.base/java.lang=ALL-UNNAMEDï¼Œè¿™æ˜¯å› ä¸ºè¿™äº›ç‰ˆæœ¬çš„ jdk é»˜è®¤ä¸å…è®¸è·¨ module åå°„</li> <li>äº‹ä»¶å‘å¸ƒè¿˜å¯ä»¥å¼‚æ­¥ï¼Œè¿™ä¸ªè§†é¢‘ä¸­æ²¡æœ‰å±•ç¤ºï¼Œè¯·è‡ªè¡ŒæŸ¥é˜… @EnableAsyncï¼Œ@Async çš„ç”¨æ³•</li></ul></blockquote> <h4 id="æ¼”ç¤º2-å›½é™…åŒ–"><a href="#æ¼”ç¤º2-å›½é™…åŒ–" class="header-anchor">#</a> æ¼”ç¤º2 - å›½é™…åŒ–</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMessageSource</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">GenericApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        context<span class="token punctuation">.</span><span class="token function">registerBean</span><span class="token punctuation">(</span><span class="token string">&quot;messageSource&quot;</span><span class="token punctuation">,</span> <span class="token class-name">MessageSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">ResourceBundleMessageSource</span> ms <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceBundleMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ms<span class="token punctuation">.</span><span class="token function">setDefaultEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ms<span class="token punctuation">.</span><span class="token function">setBasename</span><span class="token punctuation">(</span><span class="token string">&quot;messages&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ms<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        context<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token constant">ENGLISH</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token constant">CHINESE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token constant">JAPANESE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>å›½é™…åŒ–æ–‡ä»¶å‡åœ¨ src/resources ç›®å½•ä¸‹</p> <p>messages.propertiesï¼ˆç©ºï¼‰</p> <p>messages_en.properties</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">hi</span><span class="token punctuation">=</span><span class="token value attr-value">Hello</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>messages_ja.properties</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">hi</span><span class="token punctuation">=</span><span class="token value attr-value">ã“ã‚“ã«ã¡ã¯</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>messages_zh.properties</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">hi</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ å¥½</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p><em><strong>æ³¨æ„</strong></em></p> <ul><li>ApplicationContext ä¸­ MessageSource bean çš„åå­—å›ºå®šä¸º messageSource</li> <li>ä½¿ç”¨ SpringBoot æ—¶ï¼Œå›½é™…åŒ–æ–‡ä»¶åå›ºå®šä¸º messages</li> <li>ç©ºçš„ messages.properties ä¹Ÿå¿…é¡»å­˜åœ¨</li></ul></blockquote> <h3 id="_2-å®¹å™¨å®ç°"><a href="#_2-å®¹å™¨å®ç°" class="header-anchor">#</a> 2) å®¹å™¨å®ç°</h3> <p>Spring çš„å‘å±•å†å²è¾ƒä¸ºæ‚ ä¹…ï¼Œå› æ­¤å¾ˆå¤šèµ„æ–™è¿˜åœ¨è®²è§£å®ƒè¾ƒæ—§çš„å®ç°ï¼Œè¿™é‡Œå‡ºäºæ€€æ—§çš„åŸå› ï¼ŒæŠŠå®ƒä»¬éƒ½åˆ—å‡ºæ¥ï¼Œä¾›å¤§å®¶å‚è€ƒ</p> <ul><li>DefaultListableBeanFactoryï¼Œæ˜¯ BeanFactory æœ€é‡è¦çš„å®ç°ï¼Œåƒ<strong>æ§åˆ¶åè½¬</strong>å’Œ<strong>ä¾èµ–æ³¨å…¥</strong>åŠŸèƒ½ï¼Œéƒ½æ˜¯å®ƒæ¥å®ç°</li> <li>ClassPathXmlApplicationContextï¼Œä»ç±»è·¯å¾„æŸ¥æ‰¾ XML é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºå®¹å™¨ï¼ˆæ—§ï¼‰</li> <li>FileSystemXmlApplicationContextï¼Œä»ç£ç›˜è·¯å¾„æŸ¥æ‰¾ XML é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºå®¹å™¨ï¼ˆæ—§ï¼‰</li> <li>XmlWebApplicationContextï¼Œä¼ ç»Ÿ SSM æ•´åˆæ—¶ï¼ŒåŸºäº XML é…ç½®æ–‡ä»¶çš„å®¹å™¨ï¼ˆæ—§ï¼‰</li> <li>AnnotationConfigWebApplicationContextï¼Œä¼ ç»Ÿ SSM æ•´åˆæ—¶ï¼ŒåŸºäº java é…ç½®ç±»çš„å®¹å™¨ï¼ˆæ—§ï¼‰</li> <li>AnnotationConfigApplicationContextï¼ŒSpring boot ä¸­é web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li> <li>AnnotationConfigServletWebServerApplicationContextï¼ŒSpring boot ä¸­ servlet web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li> <li>AnnotationConfigReactiveWebServerApplicationContextï¼ŒSpring boot ä¸­ reactive web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li></ul> <p>å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œåé¢è¿™äº›å¸¦æœ‰ ApplicationContext çš„ç±»éƒ½æ˜¯ ApplicationContext æ¥å£çš„å®ç°ï¼Œä½†å®ƒä»¬æ˜¯<strong>ç»„åˆ</strong>äº† DefaultListableBeanFactory çš„åŠŸèƒ½ï¼Œå¹¶éç»§æ‰¿è€Œæ¥</p> <h4 id="æ¼”ç¤º1-defaultlistablebeanfactory"><a href="#æ¼”ç¤º1-defaultlistablebeanfactory" class="header-anchor">#</a> æ¼”ç¤º1 - DefaultListableBeanFactory</h4> <h5 id="ä»£ç å‚è€ƒ-2"><a href="#ä»£ç å‚è€ƒ-2" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a02.TestBeanFactory</strong></p> <h4 id="æ”¶è·ğŸ’¡-2"><a href="#æ”¶è·ğŸ’¡-2" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ul><li>beanFactory å¯ä»¥é€šè¿‡ registerBeanDefinition æ³¨å†Œä¸€ä¸ª bean definition å¯¹è±¡
<ul><li>æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„é…ç½®ç±»ã€xmlã€ç»„ä»¶æ‰«æç­‰æ–¹å¼éƒ½æ˜¯ç”Ÿæˆ bean definition å¯¹è±¡æ³¨å†Œåˆ° beanFactory å½“ä¸­</li> <li>bean definition æè¿°äº†è¿™ä¸ª bean çš„åˆ›å»ºè“å›¾ï¼šscope æ˜¯ä»€ä¹ˆã€ç”¨æ„é€ è¿˜æ˜¯å·¥å‚åˆ›å»ºã€åˆå§‹åŒ–é”€æ¯æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œç­‰ç­‰</li></ul></li> <li>beanFactory éœ€è¦æ‰‹åŠ¨è°ƒç”¨ beanFactory åå¤„ç†å™¨å¯¹å®ƒåšå¢å¼º
<ul><li>ä¾‹å¦‚é€šè¿‡è§£æ @Beanã€@ComponentScan ç­‰æ³¨è§£ï¼Œæ¥è¡¥å……ä¸€äº› bean definition</li></ul></li> <li>beanFactory éœ€è¦æ‰‹åŠ¨æ·»åŠ  bean åå¤„ç†å™¨ï¼Œä»¥ä¾¿å¯¹åç»­ bean çš„åˆ›å»ºè¿‡ç¨‹æä¾›å¢å¼º
<ul><li>ä¾‹å¦‚ @Autowiredï¼Œ@Resource ç­‰æ³¨è§£çš„è§£æéƒ½æ˜¯ bean åå¤„ç†å™¨å®Œæˆçš„</li> <li>bean åå¤„ç†çš„æ·»åŠ é¡ºåºä¼šå¯¹è§£æç»“æœæœ‰å½±å“ï¼Œè§è§†é¢‘ä¸­åŒæ—¶åŠ  @Autowiredï¼Œ@Resource çš„ä¾‹å­</li></ul></li> <li>beanFactory éœ€è¦æ‰‹åŠ¨è°ƒç”¨æ–¹æ³•æ¥åˆå§‹åŒ–å•ä¾‹</li> <li>beanFactory éœ€è¦é¢å¤–è®¾ç½®æ‰èƒ½è§£æ ${} ä¸ #{}</li></ul> <h4 id="æ¼”ç¤º2-å¸¸è§-applicationcontext-å®ç°"><a href="#æ¼”ç¤º2-å¸¸è§-applicationcontext-å®ç°" class="header-anchor">#</a> æ¼”ç¤º2 - å¸¸è§ ApplicationContext å®ç°</h4> <h5 id="ä»£ç å‚è€ƒ-3"><a href="#ä»£ç å‚è€ƒ-3" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a02.A02</strong></p> <h4 id="æ”¶è·ğŸ’¡-3"><a href="#æ”¶è·ğŸ’¡-3" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å¸¸è§çš„ ApplicationContext å®¹å™¨å®ç°</li> <li>å†…åµŒå®¹å™¨ã€DispatcherServlet çš„åˆ›å»ºæ–¹æ³•ã€ä½œç”¨</li></ol> <h3 id="_3-bean-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#_3-bean-çš„ç”Ÿå‘½å‘¨æœŸ" class="header-anchor">#</a> 3) Bean çš„ç”Ÿå‘½å‘¨æœŸ</h3> <p>ä¸€ä¸ªå— Spring ç®¡ç†çš„ beanï¼Œç”Ÿå‘½å‘¨æœŸä¸»è¦é˜¶æ®µæœ‰</p> <ol><li>åˆ›å»ºï¼šæ ¹æ® bean çš„æ„é€ æ–¹æ³•æˆ–è€…å·¥å‚æ–¹æ³•æ¥åˆ›å»º bean å®ä¾‹å¯¹è±¡</li> <li>ä¾èµ–æ³¨å…¥ï¼šæ ¹æ® @Autowiredï¼Œ@Value æˆ–å…¶å®ƒä¸€äº›æ‰‹æ®µï¼Œä¸º bean çš„æˆå‘˜å˜é‡å¡«å……å€¼ã€å»ºç«‹å…³ç³»</li> <li>åˆå§‹åŒ–ï¼šå›è°ƒå„ç§ Aware æ¥å£ï¼Œè°ƒç”¨å¯¹è±¡çš„å„ç§åˆå§‹åŒ–æ–¹æ³•</li> <li>é”€æ¯ï¼šåœ¨å®¹å™¨å…³é—­æ—¶ï¼Œä¼šé”€æ¯æ‰€æœ‰å•ä¾‹å¯¹è±¡ï¼ˆå³è°ƒç”¨å®ƒä»¬çš„é”€æ¯æ–¹æ³•ï¼‰
<ul><li>prototype å¯¹è±¡ä¹Ÿèƒ½å¤Ÿé”€æ¯ï¼Œä¸è¿‡éœ€è¦å®¹å™¨è¿™è¾¹ä¸»åŠ¨è°ƒç”¨</li></ul></li></ol> <p>ä¸€äº›èµ„æ–™ä¼šæåˆ°ï¼Œç”Ÿå‘½å‘¨æœŸä¸­è¿˜æœ‰ä¸€ç±» bean åå¤„ç†å™¨ï¼šBeanPostProcessorï¼Œä¼šåœ¨ bean çš„åˆå§‹åŒ–çš„å‰åï¼Œæä¾›ä¸€äº›æ‰©å±•é€»è¾‘ã€‚ä½†è¿™ç§è¯´æ³•æ˜¯ä¸å®Œæ•´çš„ï¼Œè§ä¸‹é¢çš„æ¼”ç¤º1</p> <h4 id="æ¼”ç¤º1-bean-ç”Ÿå‘½å‘¨æœŸ"><a href="#æ¼”ç¤º1-bean-ç”Ÿå‘½å‘¨æœŸ" class="header-anchor">#</a> æ¼”ç¤º1 - bean ç”Ÿå‘½å‘¨æœŸ</h4> <h5 id="ä»£ç å‚è€ƒ-4"><a href="#ä»£ç å‚è€ƒ-4" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a03</strong> åŒ…</p> <p><img src="https://vingkin-1304361015.cos.ap-shanghai.myqcloud.com/os/20220809110503.png" alt=""></p> <p>åˆ›å»ºå‰åçš„å¢å¼º</p> <ul><li>postProcessBeforeInstantiation
<ul><li>è¿™é‡Œè¿”å›çš„å¯¹è±¡è‹¥ä¸ä¸º null ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ beanï¼Œå¹¶ä¸”ä»…ä¼šèµ° postProcessAfterInitialization æµç¨‹</li></ul></li> <li>postProcessAfterInstantiation
<ul><li>è¿™é‡Œå¦‚æœè¿”å› false ä¼šè·³è¿‡ä¾èµ–æ³¨å…¥é˜¶æ®µ</li></ul></li></ul> <p>ä¾èµ–æ³¨å…¥å‰çš„å¢å¼º</p> <ul><li>postProcessProperties
<ul><li>å¦‚ @Autowiredã€@Valueã€@Resource</li></ul></li></ul> <p>åˆå§‹åŒ–å‰åçš„å¢å¼º</p> <ul><li>postProcessBeforeInitialization
<ul><li>è¿™é‡Œè¿”å›çš„å¯¹è±¡ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ bean</li> <li>å¦‚ @PostConstructã€@ConfigurationProperties</li></ul></li> <li>postProcessAfterInitialization
<ul><li>è¿™é‡Œè¿”å›çš„å¯¹è±¡ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ bean</li> <li>å¦‚ä»£ç†å¢å¼º</li></ul></li></ul> <p>é”€æ¯ä¹‹å‰çš„å¢å¼º</p> <ul><li>postProcessBeforeDestruction
<ul><li>å¦‚ @PreDestroy</li></ul></li></ul> <h4 id="æ”¶è·ğŸ’¡-4"><a href="#æ”¶è·ğŸ’¡-4" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>Spring bean ç”Ÿå‘½å‘¨æœŸå„ä¸ªé˜¶æ®µ</li> <li>æ¨¡æ¿è®¾è®¡æ¨¡å¼, æŒ‡å¤§æµç¨‹å·²ç»å›ºå®šå¥½äº†, é€šè¿‡æ¥å£å›è°ƒï¼ˆbean åå¤„ç†å™¨ï¼‰åœ¨ä¸€äº›å…³é”®ç‚¹å‰åæä¾›æ‰©å±•</li></ol> <h4 id="æ¼”ç¤º2-æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼"><a href="#æ¼”ç¤º2-æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼" class="header-anchor">#</a> æ¼”ç¤º2 - æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼</h4> <h5 id="å…³é”®ä»£ç "><a href="#å…³é”®ä»£ç " class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMethodTemplate</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MyBeanFactory</span> beanFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">addBeanPostProcessor</span><span class="token punctuation">(</span>bean <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è§£æ @Autowired&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">addBeanPostProcessor</span><span class="token punctuation">(</span>bean <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è§£æ @Resource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ¨¡æ¿æ–¹æ³•  Template Method Pattern</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyBeanFactory</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ„é€  &quot;</span> <span class="token operator">+</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¾èµ–æ³¨å…¥ &quot;</span> <span class="token operator">+</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// @Autowired, @Resource</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BeanPostProcessor</span> processor <span class="token operator">:</span> processors<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                processor<span class="token punctuation">.</span><span class="token function">inject</span><span class="token punctuation">(</span>bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åˆå§‹åŒ– &quot;</span> <span class="token operator">+</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanPostProcessor</span><span class="token punctuation">&gt;</span></span> processors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addBeanPostProcessor</span><span class="token punctuation">(</span><span class="token class-name">BeanPostProcessor</span> processor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            processors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>processor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">interface</span> <span class="token class-name">BeanPostProcessor</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯¹ä¾èµ–æ³¨å…¥é˜¶æ®µçš„æ‰©å±•</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h4 id="æ¼”ç¤º3-bean-åå¤„ç†å™¨æ’åº"><a href="#æ¼”ç¤º3-bean-åå¤„ç†å™¨æ’åº" class="header-anchor">#</a> æ¼”ç¤º3 - bean åå¤„ç†å™¨æ’åº</h4> <h5 id="ä»£ç å‚è€ƒ-5"><a href="#ä»£ç å‚è€ƒ-5" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a03.TestProcessOrder</strong></p> <h4 id="æ”¶è·ğŸ’¡-5"><a href="#æ”¶è·ğŸ’¡-5" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å®ç°äº† PriorityOrdered æ¥å£çš„ä¼˜å…ˆçº§æœ€é«˜</li> <li>å®ç°äº† Ordered æ¥å£ä¸åŠ äº† @Order æ³¨è§£çš„å¹³çº§, æŒ‰æ•°å­—å‡åº</li> <li>å…¶å®ƒçš„æ’åœ¨æœ€å</li></ol> <h3 id="_4-bean-åå¤„ç†å™¨"><a href="#_4-bean-åå¤„ç†å™¨" class="header-anchor">#</a> 4) Bean åå¤„ç†å™¨</h3> <h4 id="æ¼”ç¤º1-åå¤„ç†å™¨ä½œç”¨"><a href="#æ¼”ç¤º1-åå¤„ç†å™¨ä½œç”¨" class="header-anchor">#</a> æ¼”ç¤º1 - åå¤„ç†å™¨ä½œç”¨</h4> <h5 id="ä»£ç å‚è€ƒ-6"><a href="#ä»£ç å‚è€ƒ-6" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a04</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-6"><a href="#æ”¶è·ğŸ’¡-6" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>@Autowired ç­‰æ³¨è§£çš„è§£æå±äº bean ç”Ÿå‘½å‘¨æœŸé˜¶æ®µï¼ˆä¾èµ–æ³¨å…¥, åˆå§‹åŒ–ï¼‰çš„æ‰©å±•åŠŸèƒ½ï¼Œè¿™äº›æ‰©å±•åŠŸèƒ½ç”± bean åå¤„ç†å™¨æ¥å®Œæˆ</li> <li>æ¯ä¸ªåå¤„ç†å™¨å„è‡ªå¢å¼ºä»€ä¹ˆåŠŸèƒ½
<ul><li>AutowiredAnnotationBeanPostProcessor è§£æ @Autowired ä¸ @Value</li> <li>CommonAnnotationBeanPostProcessor è§£æ @Resourceã€@PostConstructã€@PreDestroy</li> <li>ConfigurationPropertiesBindingPostProcessor è§£æ @ConfigurationProperties</li></ul></li> <li>å¦å¤– ContextAnnotationAutowireCandidateResolver è´Ÿè´£è·å– @Value çš„å€¼ï¼Œè§£æ @Qualifierã€æ³›å‹ã€@Lazy ç­‰</li></ol> <h4 id="æ¼”ç¤º2-autowired-bean-åå¤„ç†å™¨è¿è¡Œåˆ†æ"><a href="#æ¼”ç¤º2-autowired-bean-åå¤„ç†å™¨è¿è¡Œåˆ†æ" class="header-anchor">#</a> æ¼”ç¤º2 - @Autowired bean åå¤„ç†å™¨è¿è¡Œåˆ†æ</h4> <h5 id="ä»£ç å‚è€ƒ-7"><a href="#ä»£ç å‚è€ƒ-7" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a04.DigInAutowired</strong></p> <h4 id="æ”¶è·ğŸ’¡-7"><a href="#æ”¶è·ğŸ’¡-7" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>AutowiredAnnotationBeanPostProcessor.findAutowiringMetadata ç”¨æ¥è·å–æŸä¸ª bean ä¸ŠåŠ äº† @Value @Autowired çš„æˆå‘˜å˜é‡ï¼Œæ–¹æ³•å‚æ•°çš„ä¿¡æ¯ï¼Œè¡¨ç¤ºä¸º InjectionMetadata</li> <li>InjectionMetadata å¯ä»¥å®Œæˆä¾èµ–æ³¨å…¥</li> <li>InjectionMetadata å†…éƒ¨æ ¹æ®æˆå‘˜å˜é‡ï¼Œæ–¹æ³•å‚æ•°å°è£…ä¸º DependencyDescriptor ç±»å‹</li> <li>æœ‰äº† DependencyDescriptorï¼Œå°±å¯ä»¥åˆ©ç”¨ beanFactory.doResolveDependency æ–¹æ³•è¿›è¡ŒåŸºäºç±»å‹çš„æŸ¥æ‰¾</li></ol> <h3 id="_5-beanfactory-åå¤„ç†å™¨"><a href="#_5-beanfactory-åå¤„ç†å™¨" class="header-anchor">#</a> 5) BeanFactory åå¤„ç†å™¨</h3> <h4 id="æ¼”ç¤º1-beanfactory-åå¤„ç†å™¨çš„ä½œç”¨"><a href="#æ¼”ç¤º1-beanfactory-åå¤„ç†å™¨çš„ä½œç”¨" class="header-anchor">#</a> æ¼”ç¤º1 - BeanFactory åå¤„ç†å™¨çš„ä½œç”¨</h4> <h5 id="ä»£ç å‚è€ƒ-8"><a href="#ä»£ç å‚è€ƒ-8" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a05</strong> åŒ…</p> <ul><li>ConfigurationClassPostProcessor å¯ä»¥è§£æ
<ul><li>@ComponentScan</li> <li>@Bean</li> <li>@Import</li> <li>@ImportResource</li></ul></li> <li>MapperScannerConfigurer å¯ä»¥è§£æ
<ul><li>Mapper æ¥å£</li></ul></li></ul> <h4 id="æ”¶è·ğŸ’¡-8"><a href="#æ”¶è·ğŸ’¡-8" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>@ComponentScan, @Bean, @Mapper ç­‰æ³¨è§£çš„è§£æå±äºæ ¸å¿ƒå®¹å™¨ï¼ˆå³ BeanFactoryï¼‰çš„æ‰©å±•åŠŸèƒ½</li> <li>è¿™äº›æ‰©å±•åŠŸèƒ½ç”±ä¸åŒçš„ BeanFactory åå¤„ç†å™¨æ¥å®Œæˆï¼Œå…¶å®ä¸»è¦å°±æ˜¯è¡¥å……äº†ä¸€äº› bean å®šä¹‰</li></ol> <h4 id="æ¼”ç¤º2-æ¨¡æ‹Ÿè§£æ-componentscan"><a href="#æ¼”ç¤º2-æ¨¡æ‹Ÿè§£æ-componentscan" class="header-anchor">#</a> æ¼”ç¤º2 - æ¨¡æ‹Ÿè§£æ @ComponentScan</h4> <h5 id="ä»£ç å‚è€ƒ-9"><a href="#ä»£ç å‚è€ƒ-9" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a05.ComponentScanPostProcessor</strong></p> <h4 id="æ”¶è·ğŸ’¡-9"><a href="#æ”¶è·ğŸ’¡-9" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>Spring æ“ä½œå…ƒæ•°æ®çš„å·¥å…·ç±» CachingMetadataReaderFactory</li> <li>é€šè¿‡æ³¨è§£å…ƒæ•°æ®ï¼ˆAnnotationMetadataï¼‰è·å–ç›´æ¥æˆ–é—´æ¥æ ‡æ³¨çš„æ³¨è§£ä¿¡æ¯</li> <li>é€šè¿‡ç±»å…ƒæ•°æ®ï¼ˆClassMetadataï¼‰è·å–ç±»åï¼ŒAnnotationBeanNameGenerator ç”Ÿæˆ bean å</li> <li>è§£æå…ƒæ•°æ®æ˜¯åŸºäº ASM æŠ€æœ¯</li></ol> <h4 id="æ¼”ç¤º3-æ¨¡æ‹Ÿè§£æ-bean"><a href="#æ¼”ç¤º3-æ¨¡æ‹Ÿè§£æ-bean" class="header-anchor">#</a> æ¼”ç¤º3 - æ¨¡æ‹Ÿè§£æ @Bean</h4> <h5 id="ä»£ç å‚è€ƒ-10"><a href="#ä»£ç å‚è€ƒ-10" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a05.AtBeanPostProcessor</strong></p> <h4 id="æ”¶è·ğŸ’¡-10"><a href="#æ”¶è·ğŸ’¡-10" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>è¿›ä¸€æ­¥ç†Ÿæ‚‰æ³¨è§£å…ƒæ•°æ®ï¼ˆAnnotationMetadataï¼‰è·å–æ–¹æ³•ä¸Šæ³¨è§£ä¿¡æ¯</li></ol> <h4 id="æ¼”ç¤º4-æ¨¡æ‹Ÿè§£æ-mapper-æ¥å£"><a href="#æ¼”ç¤º4-æ¨¡æ‹Ÿè§£æ-mapper-æ¥å£" class="header-anchor">#</a> æ¼”ç¤º4 - æ¨¡æ‹Ÿè§£æ Mapper æ¥å£</h4> <h5 id="ä»£ç å‚è€ƒ-11"><a href="#ä»£ç å‚è€ƒ-11" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a05.MapperPostProcessor</strong></p> <h4 id="æ”¶è·ğŸ’¡-11"><a href="#æ”¶è·ğŸ’¡-11" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>Mapper æ¥å£è¢« Spring ç®¡ç†çš„æœ¬è´¨ï¼šå®é™…æ˜¯è¢«ä½œä¸º MapperFactoryBean æ³¨å†Œåˆ°å®¹å™¨ä¸­</li> <li>Spring çš„è¯¡å¼‚åšæ³•ï¼Œæ ¹æ®æ¥å£ç”Ÿæˆçš„ BeanDefinition ä»…ä¸ºæ ¹æ®æ¥å£åç”Ÿæˆ bean å</li></ol> <h3 id="_6-aware-æ¥å£"><a href="#_6-aware-æ¥å£" class="header-anchor">#</a> 6) Aware æ¥å£</h3> <h4 id="æ¼”ç¤º-aware-æ¥å£åŠ-initializingbean-æ¥å£"><a href="#æ¼”ç¤º-aware-æ¥å£åŠ-initializingbean-æ¥å£" class="header-anchor">#</a> æ¼”ç¤º - Aware æ¥å£åŠ InitializingBean æ¥å£</h4> <h5 id="ä»£ç å‚è€ƒ-12"><a href="#ä»£ç å‚è€ƒ-12" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a06</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-12"><a href="#æ”¶è·ğŸ’¡-12" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>Aware æ¥å£æä¾›äº†ä¸€ç§ã€å†…ç½®ã€‘ çš„æ³¨å…¥æ‰‹æ®µï¼Œä¾‹å¦‚
<ul><li>BeanNameAware æ³¨å…¥ bean çš„åå­—</li> <li>BeanFactoryAware æ³¨å…¥ BeanFactory å®¹å™¨</li> <li>ApplicationContextAware æ³¨å…¥ ApplicationContext å®¹å™¨</li> <li>EmbeddedValueResolverAware æ³¨å…¥ ${} è§£æå™¨</li></ul></li> <li>InitializingBean æ¥å£æä¾›äº†ä¸€ç§ã€å†…ç½®ã€‘çš„åˆå§‹åŒ–æ‰‹æ®µ</li> <li>å¯¹æ¯”
<ul><li>å†…ç½®çš„æ³¨å…¥å’Œåˆå§‹åŒ–ä¸å—æ‰©å±•åŠŸèƒ½çš„å½±å“ï¼Œæ€»ä¼šè¢«æ‰§è¡Œ</li> <li>è€Œæ‰©å±•åŠŸèƒ½å—æŸäº›æƒ…å†µå½±å“å¯èƒ½ä¼šå¤±æ•ˆ</li> <li>å› æ­¤ Spring æ¡†æ¶å†…éƒ¨çš„ç±»å¸¸ç”¨å†…ç½®æ³¨å…¥å’Œåˆå§‹åŒ–</li></ul></li></ol> <h4 id="é…ç½®ç±»-autowired-å¤±æ•ˆåˆ†æ"><a href="#é…ç½®ç±»-autowired-å¤±æ•ˆåˆ†æ" class="header-anchor">#</a> é…ç½®ç±» @Autowired å¤±æ•ˆåˆ†æ</h4> <p>Java é…ç½®ç±»ä¸åŒ…å« BeanFactoryPostProcessor çš„æƒ…å†µ</p> <p><img src="https://vingkin-1304361015.cos.ap-shanghai.myqcloud.com/os/20220809110602.png" alt=""></p> <p>Java é…ç½®ç±»åŒ…å« BeanFactoryPostProcessor çš„æƒ…å†µï¼Œå› æ­¤è¦åˆ›å»ºå…¶ä¸­çš„ BeanFactoryPostProcessor å¿…é¡»æå‰åˆ›å»º Java é…ç½®ç±»ï¼Œè€Œæ­¤æ—¶çš„ BeanPostProcessor è¿˜æœªå‡†å¤‡å¥½ï¼Œå¯¼è‡´ @Autowired ç­‰æ³¨è§£å¤±æ•ˆ</p> <p><img src="https://vingkin-1304361015.cos.ap-shanghai.myqcloud.com/os/20220809110628.png" alt=""></p> <p>å¯¹åº”ä»£ç </p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig1</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MyConfig1</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;æ³¨å…¥ ApplicationContext&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;åˆå§‹åŒ–&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span> <span class="token comment">//  â¬…ï¸ æ³¨é‡Šæˆ–æ·»åŠ  beanFactory åå¤„ç†å™¨å¯¹åº”ä¸Šæ–¹ä¸¤ç§æƒ…å†µ</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanFactoryPostProcessor</span> <span class="token function">processor1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> beanFactory <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰§è¡Œ processor1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><blockquote><p><em><strong>æ³¨æ„</strong></em></p> <p>è§£å†³æ–¹æ³•ï¼š</p> <ul><li>ç”¨å†…ç½®ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–å–ä»£æ‰©å±•ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–</li> <li>ç”¨é™æ€å·¥å‚æ–¹æ³•ä»£æ›¿å®ä¾‹å·¥å‚æ–¹æ³•ï¼Œé¿å…å·¥å‚å¯¹è±¡æå‰è¢«åˆ›å»º</li></ul></blockquote> <h3 id="_7-åˆå§‹åŒ–ä¸é”€æ¯"><a href="#_7-åˆå§‹åŒ–ä¸é”€æ¯" class="header-anchor">#</a> 7) åˆå§‹åŒ–ä¸é”€æ¯</h3> <h4 id="æ¼”ç¤º-åˆå§‹åŒ–é”€æ¯é¡ºåº"><a href="#æ¼”ç¤º-åˆå§‹åŒ–é”€æ¯é¡ºåº" class="header-anchor">#</a> æ¼”ç¤º - åˆå§‹åŒ–é”€æ¯é¡ºåº</h4> <h5 id="ä»£ç å‚è€ƒ-13"><a href="#ä»£ç å‚è€ƒ-13" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a07</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-13"><a href="#æ”¶è·ğŸ’¡-13" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>Spring æä¾›äº†å¤šç§åˆå§‹åŒ–æ‰‹æ®µï¼Œé™¤äº†è¯¾å ‚ä¸Šè®²çš„ @PostConstructï¼Œ@Bean(initMethod) ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å®ç° InitializingBean æ¥å£æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœåŒä¸€ä¸ª bean ç”¨äº†ä»¥ä¸Šæ‰‹æ®µå£°æ˜äº† 3 ä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯</p> <ol><li>@PostConstruct æ ‡æ³¨çš„åˆå§‹åŒ–æ–¹æ³•</li> <li>InitializingBean æ¥å£çš„åˆå§‹åŒ–æ–¹æ³•</li> <li>@Bean(initMethod) æŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³•</li></ol> <p>ä¸åˆå§‹åŒ–ç±»ä¼¼ï¼ŒSpring ä¹Ÿæä¾›äº†å¤šç§é”€æ¯æ‰‹æ®µï¼Œæ‰§è¡Œé¡ºåºä¸º</p> <ol><li>@PreDestroy æ ‡æ³¨çš„é”€æ¯æ–¹æ³•</li> <li>DisposableBean æ¥å£çš„é”€æ¯æ–¹æ³•</li> <li>@Bean(destroyMethod) æŒ‡å®šçš„é”€æ¯æ–¹æ³•</li></ol> <h3 id="_8-scope"><a href="#_8-scope" class="header-anchor">#</a> 8) Scope</h3> <p>åœ¨å½“å‰ç‰ˆæœ¬çš„ Spring å’Œ Spring Boot ç¨‹åºä¸­ï¼Œæ”¯æŒäº”ç§ Scope</p> <ul><li>singletonï¼Œå®¹å™¨å¯åŠ¨æ—¶åˆ›å»ºï¼ˆæœªè®¾ç½®å»¶è¿Ÿï¼‰ï¼Œå®¹å™¨å…³é—­æ—¶é”€æ¯</li> <li>prototypeï¼Œæ¯æ¬¡ä½¿ç”¨æ—¶åˆ›å»ºï¼Œä¸ä¼šè‡ªåŠ¨é”€æ¯ï¼Œéœ€è¦è°ƒç”¨ DefaultListableBeanFactory.destroyBean(bean) é”€æ¯</li> <li>requestï¼Œæ¯æ¬¡è¯·æ±‚ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œè¯·æ±‚ç»“æŸæ—¶é”€æ¯</li> <li>sessionï¼Œæ¯ä¸ªä¼šè¯ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œä¼šè¯ç»“æŸæ—¶é”€æ¯</li> <li>applicationï¼Œweb å®¹å™¨ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œå®¹å™¨åœæ­¢æ—¶é”€æ¯</li></ul> <p>æœ‰äº›æ–‡ç« æåˆ°æœ‰ globalSession è¿™ä¸€ Scopeï¼Œä¹Ÿæ˜¯é™ˆæ—§çš„è¯´æ³•ï¼Œç›®å‰ Spring ä¸­å·²åºŸå¼ƒ</p> <p>ä½†è¦æ³¨æ„ï¼Œå¦‚æœåœ¨ singleton æ³¨å…¥å…¶å®ƒ scope éƒ½ä¼šæœ‰é—®é¢˜ï¼Œè§£å†³æ–¹æ³•æœ‰</p> <ul><li>@Lazy</li> <li>@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)</li> <li>ObjectFactory</li> <li>ApplicationContext.getBean</li></ul> <h4 id="æ¼”ç¤º1-request-session-application-ä½œç”¨åŸŸ"><a href="#æ¼”ç¤º1-request-session-application-ä½œç”¨åŸŸ" class="header-anchor">#</a> æ¼”ç¤º1 - request, session, application ä½œç”¨åŸŸ</h4> <h5 id="ä»£ç å‚è€ƒ-14"><a href="#ä»£ç å‚è€ƒ-14" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a08</strong> åŒ…</p> <ul><li>æ‰“å¼€ä¸åŒçš„æµè§ˆå™¨, åˆ·æ–° http://localhost:8080/test å³å¯æŸ¥çœ‹æ•ˆæœ</li> <li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  --add-opens java.base/java.lang=ALL-UNNAMED</li></ul> <h4 id="æ”¶è·ğŸ’¡-14"><a href="#æ”¶è·ğŸ’¡-14" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>æœ‰å‡ ç§ scope</li> <li>åœ¨ singleton ä¸­ä½¿ç”¨å…¶å®ƒå‡ ç§ scope çš„æ–¹æ³•</li> <li>å…¶å®ƒ scope çš„é”€æ¯æ—¶æœº
<ul><li>å¯ä»¥å°†é€šè¿‡ server.servlet.session.timeout=30s è§‚å¯Ÿ session bean çš„é”€æ¯</li> <li>ServletContextScope é”€æ¯æœºåˆ¶ç–‘ä¼¼å®ç°æœ‰è¯¯</li></ul></li></ol> <h4 id="åˆ†æ-singleton-æ³¨å…¥å…¶å®ƒ-scope-å¤±æ•ˆ"><a href="#åˆ†æ-singleton-æ³¨å…¥å…¶å®ƒ-scope-å¤±æ•ˆ" class="header-anchor">#</a> åˆ†æ - singleton æ³¨å…¥å…¶å®ƒ scope å¤±æ•ˆ</h4> <p>ä»¥å•ä¾‹æ³¨å…¥å¤šä¾‹ä¸ºä¾‹</p> <p>æœ‰ä¸€ä¸ªå•ä¾‹å¯¹è±¡ E</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">E</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">F</span> f<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;E()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setF</span><span class="token punctuation">(</span><span class="token class-name">F</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>f <span class="token operator">=</span> f<span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;setF(F f) {}&quot;</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">F</span> <span class="token function">getF</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> f<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>è¦æ³¨å…¥çš„å¯¹è±¡ F æœŸæœ›æ˜¯å¤šä¾‹</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token string">&quot;prototype&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">F</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">F</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;F()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>æµ‹è¯•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">E</span> e <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">F</span> f1 <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">F</span> f2 <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¾“å‡º</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>com.itheima.demo.cycle.F@6622fc65
com.itheima.demo.cycle.F@6622fc65
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å‘ç°å®ƒä»¬æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯æœŸæœ›çš„å¤šä¾‹å¯¹è±¡</p> <p>å¯¹äºå•ä¾‹å¯¹è±¡æ¥è®²ï¼Œä¾èµ–æ³¨å…¥ä»…å‘ç”Ÿäº†ä¸€æ¬¡ï¼Œåç»­å†æ²¡æœ‰ç”¨åˆ°å¤šä¾‹çš„ Fï¼Œå› æ­¤ E ç”¨çš„å§‹ç»ˆæ˜¯ç¬¬ä¸€æ¬¡ä¾èµ–æ³¨å…¥çš„ F</p> <p><img src="https://vingkin-1304361015.cos.ap-shanghai.myqcloud.com/os/20220809110704.png" alt=""></p> <p>è§£å†³</p> <ul><li>ä»ç„¶ä½¿ç”¨ @Lazy ç”Ÿæˆä»£ç†</li> <li>ä»£ç†å¯¹è±¡è™½ç„¶è¿˜æ˜¯åŒä¸€ä¸ªï¼Œä½†å½“æ¯æ¬¡<strong>ä½¿ç”¨ä»£ç†å¯¹è±¡çš„ä»»æ„æ–¹æ³•</strong>æ—¶ï¼Œç”±ä»£ç†åˆ›å»ºæ–°çš„ f å¯¹è±¡</li> <li><img src="https://vingkin-1304361015.cos.ap-shanghai.myqcloud.com/os/20220809110738.png" alt=""></li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">E</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token annotation punctuation">@Lazy</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setF</span><span class="token punctuation">(</span><span class="token class-name">F</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>f <span class="token operator">=</span> f<span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;setF(F f) {}&quot;</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p><em><strong>æ³¨æ„</strong></em></p> <ul><li>@Lazy åŠ åœ¨ä¹Ÿå¯ä»¥åŠ åœ¨æˆå‘˜å˜é‡ä¸Šï¼Œä½†åŠ åœ¨ set æ–¹æ³•ä¸Šçš„ç›®çš„æ˜¯å¯ä»¥è§‚å¯Ÿè¾“å‡ºï¼ŒåŠ åœ¨æˆå‘˜å˜é‡ä¸Šå°±ä¸è¡Œäº†</li> <li>@Autowired åŠ åœ¨ set æ–¹æ³•çš„ç›®çš„ç±»ä¼¼</li></ul></blockquote> <p>è¾“å‡º</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>E: setF(F f) class com.itheima.demo.cycle.F$$EnhancerBySpringCGLIB$$8b54f2bc
F: F()
com.itheima.demo.cycle.F@3a6f2de3
F: F()
com.itheima.demo.cycle.F@56303b57
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ä»è¾“å‡ºæ—¥å¿—å¯ä»¥çœ‹åˆ°è°ƒç”¨ setF æ–¹æ³•æ—¶ï¼Œf å¯¹è±¡çš„ç±»å‹æ˜¯ä»£ç†ç±»å‹</p> <h4 id="æ¼”ç¤º2-4ç§è§£å†³æ–¹æ³•"><a href="#æ¼”ç¤º2-4ç§è§£å†³æ–¹æ³•" class="header-anchor">#</a> æ¼”ç¤º2 - 4ç§è§£å†³æ–¹æ³•</h4> <h5 id="ä»£ç å‚è€ƒ-15"><a href="#ä»£ç å‚è€ƒ-15" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a08.sub</strong> åŒ…</p> <ul><li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  --add-opens java.base/java.lang=ALL-UNNAMED</li></ul> <h4 id="æ”¶è·ğŸ’¡-15"><a href="#æ”¶è·ğŸ’¡-15" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å•ä¾‹æ³¨å…¥å…¶å®ƒ scope çš„å››ç§è§£å†³æ–¹æ³•
<ul><li>@Lazy</li> <li>@Scope(value = &quot;prototype&quot;, proxyMode = ScopedProxyMode.TARGET_CLASS)</li> <li>ObjectFactory</li> <li>ApplicationContext</li></ul></li> <li>è§£å†³æ–¹æ³•è™½ç„¶ä¸åŒï¼Œä½†ç†å¿µä¸Šæ®Šé€”åŒå½’: éƒ½æ˜¯æ¨è¿Ÿå…¶å®ƒ scope bean çš„è·å–</li></ol> <h2 id="aop"><a href="#aop" class="header-anchor">#</a> AOP</h2> <p>AOP åº•å±‚å®ç°æ–¹å¼ä¹‹ä¸€æ˜¯ä»£ç†ï¼Œç”±ä»£ç†ç»“åˆé€šçŸ¥å’Œç›®æ ‡ï¼Œæä¾›å¢å¼ºåŠŸèƒ½</p> <p>é™¤æ­¤ä»¥å¤–ï¼Œaspectj æä¾›äº†ä¸¤ç§å¦å¤–çš„ AOP åº•å±‚å®ç°ï¼š</p> <ul><li><p>ç¬¬ä¸€ç§æ˜¯é€šè¿‡ ajc ç¼–è¯‘å™¨åœ¨<strong>ç¼–è¯‘</strong> class ç±»æ–‡ä»¶æ—¶ï¼Œå°±æŠŠé€šçŸ¥çš„å¢å¼ºåŠŸèƒ½ï¼Œç»‡å…¥åˆ°ç›®æ ‡ç±»çš„å­—èŠ‚ç ä¸­</p></li> <li><p>ç¬¬äºŒç§æ˜¯é€šè¿‡ agent åœ¨<strong>åŠ è½½</strong>ç›®æ ‡ç±»æ—¶ï¼Œä¿®æ”¹ç›®æ ‡ç±»çš„å­—èŠ‚ç ï¼Œç»‡å…¥å¢å¼ºåŠŸèƒ½</p></li> <li><p>ä½œä¸ºå¯¹æ¯”ï¼Œä¹‹å‰å­¦ä¹ çš„ä»£ç†æ˜¯<strong>è¿è¡Œ</strong>æ—¶ç”Ÿæˆæ–°çš„å­—èŠ‚ç </p></li></ul> <p>ç®€å•æ¯”è¾ƒçš„è¯ï¼š</p> <ul><li>aspectj åœ¨ç¼–è¯‘å’ŒåŠ è½½æ—¶ï¼Œä¿®æ”¹ç›®æ ‡å­—èŠ‚ç ï¼Œæ€§èƒ½è¾ƒé«˜</li> <li>aspectj å› ä¸ºä¸ç”¨ä»£ç†ï¼Œèƒ½çªç ´ä¸€äº›æŠ€æœ¯ä¸Šçš„é™åˆ¶ï¼Œä¾‹å¦‚å¯¹æ„é€ ã€å¯¹é™æ€æ–¹æ³•ã€å¯¹ final ä¹Ÿèƒ½å¢å¼º</li> <li>ä½† aspectj ä¾µå…¥æ€§è¾ƒå¼ºï¼Œä¸”éœ€è¦å­¦ä¹ æ–°çš„ aspectj ç‰¹æœ‰è¯­æ³•ï¼Œå› æ­¤æ²¡æœ‰å¹¿æ³›æµè¡Œ</li></ul> <h3 id="_9-aop-å®ç°ä¹‹-ajc-ç¼–è¯‘å™¨"><a href="#_9-aop-å®ç°ä¹‹-ajc-ç¼–è¯‘å™¨" class="header-anchor">#</a> 9) AOP å®ç°ä¹‹ ajc ç¼–è¯‘å™¨</h3> <p>ä»£ç å‚è€ƒé¡¹ç›® <strong>demo6_advanced_aspectj_01</strong></p> <h4 id="æ”¶è·ğŸ’¡-16"><a href="#æ”¶è·ğŸ’¡-16" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>ç¼–è¯‘å™¨ä¹Ÿèƒ½ä¿®æ”¹ class å®ç°å¢å¼º</li> <li>ç¼–è¯‘å™¨å¢å¼ºèƒ½çªç ´ä»£ç†ä»…èƒ½é€šè¿‡æ–¹æ³•é‡å†™å¢å¼ºçš„é™åˆ¶ï¼šå¯ä»¥å¯¹æ„é€ æ–¹æ³•ã€é™æ€æ–¹æ³•ç­‰å®ç°å¢å¼º</li></ol> <blockquote><p><em><strong>æ³¨æ„</strong></em></p> <ul><li>ç‰ˆæœ¬é€‰æ‹©äº† java 8, å› ä¸ºç›®å‰çš„ aspectj-maven-plugin 1.14.0 æœ€é«˜åªæ”¯æŒåˆ° java 16</li> <li>ä¸€å®šè¦ç”¨ maven çš„ compile æ¥ç¼–è¯‘, idea ä¸ä¼šè°ƒç”¨ ajc ç¼–è¯‘å™¨</li></ul></blockquote> <h3 id="_10-aop-å®ç°ä¹‹-agent-ç±»åŠ è½½"><a href="#_10-aop-å®ç°ä¹‹-agent-ç±»åŠ è½½" class="header-anchor">#</a> 10) AOP å®ç°ä¹‹ agent ç±»åŠ è½½</h3> <p>ä»£ç å‚è€ƒé¡¹ç›® <strong>demo6_advanced_aspectj_02</strong></p> <h4 id="æ”¶è·ğŸ’¡-17"><a href="#æ”¶è·ğŸ’¡-17" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>ç±»åŠ è½½æ—¶å¯ä»¥é€šè¿‡ agent ä¿®æ”¹ class å®ç°å¢å¼º</li></ol> <h3 id="_11-aop-å®ç°ä¹‹-proxy"><a href="#_11-aop-å®ç°ä¹‹-proxy" class="header-anchor">#</a> 11) AOP å®ç°ä¹‹ proxy</h3> <h4 id="æ¼”ç¤º1-jdk-åŠ¨æ€ä»£ç†"><a href="#æ¼”ç¤º1-jdk-åŠ¨æ€ä»£ç†" class="header-anchor">#</a> æ¼”ç¤º1 - jdk åŠ¨æ€ä»£ç†</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdkProxyDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">interface</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token keyword">implements</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;target foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç›®æ ‡å¯¹è±¡</span>
        <span class="token class-name">Target</span> target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä»£ç†å¯¹è±¡</span>
        <span class="token class-name">Foo</span> proxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Foo</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>
                <span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Foo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span>p<span class="token punctuation">,</span> method<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;proxy before...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">Object</span> result <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;proxy after...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è°ƒç”¨ä»£ç†</span>
        proxy<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>è¿è¡Œç»“æœ</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>proxy before...
target foo
proxy after...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-18"><a href="#æ”¶è·ğŸ’¡-18" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ul><li>jdk åŠ¨æ€ä»£ç†è¦æ±‚ç›®æ ‡<strong>å¿…é¡»</strong>å®ç°æ¥å£ï¼Œç”Ÿæˆçš„ä»£ç†ç±»å®ç°ç›¸åŒæ¥å£ï¼Œå› æ­¤ä»£ç†ä¸ç›®æ ‡ä¹‹é—´æ˜¯å¹³çº§å…„å¼Ÿå…³ç³»</li></ul> <h4 id="æ¼”ç¤º2-cglib-ä»£ç†"><a href="#æ¼”ç¤º2-cglib-ä»£ç†" class="header-anchor">#</a> æ¼”ç¤º2 - cglib ä»£ç†</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CglibProxyDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;target foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç›®æ ‡å¯¹è±¡</span>
        <span class="token class-name">Target</span> target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä»£ç†å¯¹è±¡</span>
        <span class="token class-name">Target</span> proxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">)</span> <span class="token class-name">Enhancer</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> 
                <span class="token punctuation">(</span><span class="token class-name">MethodInterceptor</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> method<span class="token punctuation">,</span> args<span class="token punctuation">,</span> methodProxy<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;proxy before...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> result <span class="token operator">=</span> methodProxy<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å¦ä¸€ç§è°ƒç”¨æ–¹æ³•ï¼Œä¸éœ€è¦ç›®æ ‡å¯¹è±¡å®ä¾‹</span>
<span class="token comment">//            Object result = methodProxy.invokeSuper(p, args);</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;proxy after...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è°ƒç”¨ä»£ç†</span>
        proxy<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>è¿è¡Œç»“æœä¸ jdk åŠ¨æ€ä»£ç†ç›¸åŒ</p> <h4 id="æ”¶è·ğŸ’¡-19"><a href="#æ”¶è·ğŸ’¡-19" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ul><li>cglib ä¸è¦æ±‚ç›®æ ‡å®ç°æ¥å£ï¼Œå®ƒç”Ÿæˆçš„ä»£ç†ç±»æ˜¯ç›®æ ‡çš„å­ç±»ï¼Œå› æ­¤ä»£ç†ä¸ç›®æ ‡ä¹‹é—´æ˜¯å­çˆ¶å…³ç³»</li> <li>é™åˆ¶â›”ï¼šæ ¹æ®ä¸Šè¿°åˆ†æ final ç±»æ— æ³•è¢« cglib å¢å¼º</li></ul> <h3 id="_12-jdk-åŠ¨æ€ä»£ç†è¿›é˜¶"><a href="#_12-jdk-åŠ¨æ€ä»£ç†è¿›é˜¶" class="header-anchor">#</a> 12) jdk åŠ¨æ€ä»£ç†è¿›é˜¶</h3> <h4 id="æ¼”ç¤º1-æ¨¡æ‹Ÿ-jdk-åŠ¨æ€ä»£ç†"><a href="#æ¼”ç¤º1-æ¨¡æ‹Ÿ-jdk-åŠ¨æ€ä»£ç†" class="header-anchor">#</a> æ¼”ç¤º1 - æ¨¡æ‹Ÿ jdk åŠ¨æ€ä»£ç†</h4> <p>ç›®æ ‡æ¥å£Foo.java</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ç›®æ ‡ç±»Target.java</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token keyword">implements</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>InvocationHandleræ¥å£</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä»£ç†ç±»$Proxy0</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// â¬‡ï¸è¿™å°±æ˜¯ jdk ä»£ç†ç±»çš„æºç , ç§˜å¯†éƒ½åœ¨é‡Œé¢</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> $<span class="token class-name">Proxy0</span> <span class="token keyword">implements</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">InvocationHandler</span> h<span class="token punctuation">;</span>

    <span class="token keyword">public</span> $<span class="token class-name">Proxy0</span><span class="token punctuation">(</span><span class="token class-name">InvocationHandler</span> h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>h <span class="token operator">=</span> h<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// â¬‡ï¸3. è¿›å…¥ä»£ç†æ–¹æ³•</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// â¬‡ï¸4. å›è°ƒ InvocationHandler</span>
            h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> foo<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span> result <span class="token operator">=</span> h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> bar<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">Method</span> foo<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">Method</span> bar<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            foo <span class="token operator">=</span> <span class="token class-name">A12<span class="token punctuation">.</span>Foo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bar <span class="token operator">=</span> <span class="token class-name">A12<span class="token punctuation">.</span>Foo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchMethodException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchMethodError</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>æµ‹è¯•æ–¹æ³•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token class-name">Proxy0</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> $<span class="token class-name">Proxy0</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvocationTargetException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;before...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// å‘å°„è°ƒç”¨ç›®æ ‡æ–¹æ³•</span>
                <span class="token class-name">Object</span> result <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;after...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> result<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxy<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxy<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-20"><a href="#æ”¶è·ğŸ’¡-20" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>ä»£ç†ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œæ— éå°±æ˜¯åˆ©ç”¨äº†å¤šæ€ã€åå°„çš„çŸ¥è¯†</p> <ol><li>æ–¹æ³•é‡å†™å¯ä»¥å¢å¼ºé€»è¾‘ï¼Œåªä¸è¿‡è¿™ã€å¢å¼ºé€»è¾‘ã€‘åƒå˜ä¸‡åŒ–ï¼Œä¸èƒ½å†™æ­»åœ¨ä»£ç†å†…éƒ¨</li> <li>é€šè¿‡æ¥å£å›è°ƒå°†ã€å¢å¼ºé€»è¾‘ã€‘ç½®äºä»£ç†ç±»ä¹‹å¤–</li> <li>é…åˆæ¥å£æ–¹æ³•åå°„ï¼ˆæ˜¯å¤šæ€è°ƒç”¨ï¼‰ï¼Œå°±å¯ä»¥å†è”åŠ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•</li> <li>ä¼šç”¨ arthas çš„ jad å·¥å…·åç¼–è¯‘ä»£ç†ç±»</li> <li>é™åˆ¶â›”ï¼šä»£ç†å¢å¼ºæ˜¯å€ŸåŠ©å¤šæ€æ¥å®ç°ï¼Œå› æ­¤æˆå‘˜å˜é‡ã€é™æ€æ–¹æ³•ã€final æ–¹æ³•å‡ä¸èƒ½é€šè¿‡ä»£ç†å®ç°</li></ol> <h4 id="æ¼”ç¤º2-æ–¹æ³•åå°„ä¼˜åŒ–"><a href="#æ¼”ç¤º2-æ–¹æ³•åå°„ä¼˜åŒ–" class="header-anchor">#</a> æ¼”ç¤º2 - æ–¹æ³•åå°„ä¼˜åŒ–</h4> <h5 id="ä»£ç å‚è€ƒ-16"><a href="#ä»£ç å‚è€ƒ-16" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a12.TestMethodInvoke</strong></p> <h4 id="æ”¶è·ğŸ’¡-21"><a href="#æ”¶è·ğŸ’¡-21" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å‰ 16 æ¬¡åå°„æ€§èƒ½è¾ƒä½</li> <li>ç¬¬ 17 æ¬¡è°ƒç”¨ä¼šç”Ÿæˆä»£ç†ç±»ï¼Œä¼˜åŒ–ä¸ºéåå°„è°ƒç”¨</li> <li>ä¼šç”¨ arthas çš„ jad å·¥å…·åç¼–è¯‘ç¬¬ 17 æ¬¡è°ƒç”¨ç”Ÿæˆçš„ä»£ç†ç±»</li></ol> <blockquote><p><em><strong>æ³¨æ„</strong></em></p> <p>è¿è¡Œæ—¶è¯·æ·»åŠ  --add-opens java.base/java.lang.reflect=ALL-UNNAMED --add-opens java.base/jdk.internal.reflect=ALL-UNNAMED</p></blockquote> <h3 id="_13-cglib-ä»£ç†è¿›é˜¶"><a href="#_13-cglib-ä»£ç†è¿›é˜¶" class="header-anchor">#</a> 13) cglib ä»£ç†è¿›é˜¶</h3> <h4 id="æ¼”ç¤º-æ¨¡æ‹Ÿ-cglib-ä»£ç†"><a href="#æ¼”ç¤º-æ¨¡æ‹Ÿ-cglib-ä»£ç†" class="header-anchor">#</a> æ¼”ç¤º - æ¨¡æ‹Ÿ cglib ä»£ç†</h4> <h5 id="ä»£ç å‚è€ƒ-17"><a href="#ä»£ç å‚è€ƒ-17" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a13</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-22"><a href="#æ”¶è·ğŸ’¡-22" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>å’Œ jdk åŠ¨æ€ä»£ç†åŸç†æŸ¥ä¸å¤š</p> <ol><li>å›è°ƒçš„æ¥å£æ¢äº†ä¸€ä¸‹ï¼ŒInvocationHandler æ”¹æˆäº† MethodInterceptor</li> <li>è°ƒç”¨ç›®æ ‡æ—¶æœ‰æ‰€æ”¹è¿›ï¼Œè§ä¸‹é¢ä»£ç ç‰‡æ®µ
<ol><li>method.invoke æ˜¯åå°„è°ƒç”¨ï¼Œå¿…é¡»è°ƒç”¨åˆ°è¶³å¤Ÿæ¬¡æ•°æ‰ä¼šè¿›è¡Œä¼˜åŒ–</li> <li>methodProxy.invoke æ˜¯ä¸åå°„è°ƒç”¨ï¼Œå®ƒä¼šæ­£å¸¸ï¼ˆé—´æ¥ï¼‰è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ï¼ˆSpring é‡‡ç”¨ï¼‰</li> <li>methodProxy.invokeSuper ä¹Ÿæ˜¯ä¸åå°„è°ƒç”¨ï¼Œå®ƒä¼šæ­£å¸¸ï¼ˆé—´æ¥ï¼‰è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œå¯ä»¥çœç•¥ç›®æ ‡å¯¹è±¡</li></ol></li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A14Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvocationTargetException</span> <span class="token punctuation">{</span>

        <span class="token class-name">Target</span> target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Proxy</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        proxy<span class="token punctuation">.</span><span class="token function">setCallbacks</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callback</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token class-name">MethodInterceptor</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> m<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mp<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;proxy before...&quot;</span> <span class="token operator">+</span> mp<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// â¬‡ï¸è°ƒç”¨ç›®æ ‡æ–¹æ³•(ä¸‰ç§)</span>
<span class="token comment">//            Object result = m.invoke(target, a);  // â¬…ï¸åå°„è°ƒç”¨</span>
<span class="token comment">//            Object result = mp.invoke(target, a); // â¬…ï¸éåå°„è°ƒç”¨, ç»“åˆç›®æ ‡ç”¨</span>
            <span class="token class-name">Object</span> result <span class="token operator">=</span> mp<span class="token punctuation">.</span><span class="token function">invokeSuper</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// â¬…ï¸éåå°„è°ƒç”¨, ç»“åˆä»£ç†ç”¨</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;proxy after...&quot;</span> <span class="token operator">+</span> mp<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// â¬‡ï¸è°ƒç”¨ä»£ç†æ–¹æ³•</span>
        proxy<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p><em><strong>æ³¨æ„</strong></em></p> <ul><li>è°ƒç”¨ Object çš„æ–¹æ³•, åä¸¤ç§åœ¨ jdk &gt;= 9 æ—¶éƒ½æœ‰é—®é¢˜, éœ€è¦ --add-opens java.base/java.lang=ALL-UNNAMED</li></ul></blockquote> <h3 id="_14-cglib-é¿å…åå°„è°ƒç”¨"><a href="#_14-cglib-é¿å…åå°„è°ƒç”¨" class="header-anchor">#</a> 14) cglib é¿å…åå°„è°ƒç”¨</h3> <h4 id="æ¼”ç¤º-cglib-å¦‚ä½•é¿å…åå°„"><a href="#æ¼”ç¤º-cglib-å¦‚ä½•é¿å…åå°„" class="header-anchor">#</a> æ¼”ç¤º - cglib å¦‚ä½•é¿å…åå°„</h4> <h5 id="ä»£ç å‚è€ƒ-18"><a href="#ä»£ç å‚è€ƒ-18" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a13.ProxyFastClass</strong>ï¼Œ<strong>com.itheima.a13.TargetFastClass</strong></p> <h4 id="æ”¶è·ğŸ’¡-23"><a href="#æ”¶è·ğŸ’¡-23" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å½“è°ƒç”¨ MethodProxy çš„ invoke æˆ– invokeSuper æ–¹æ³•æ—¶, ä¼šåŠ¨æ€ç”Ÿæˆä¸¤ä¸ªç±»
<ul><li>ProxyFastClass é…åˆä»£ç†å¯¹è±¡ä¸€èµ·ä½¿ç”¨, é¿å…åå°„</li> <li>TargetFastClass é…åˆç›®æ ‡å¯¹è±¡ä¸€èµ·ä½¿ç”¨, é¿å…åå°„ (Spring ç”¨çš„è¿™ç§)</li></ul></li> <li>TargetFastClass è®°å½•äº† Target ä¸­æ–¹æ³•ä¸ç¼–å·çš„å¯¹åº”å…³ç³»
<ul><li>save(long) ç¼–å· 2</li> <li>save(int) ç¼–å· 1</li> <li>save() ç¼–å· 0</li> <li>é¦–å…ˆæ ¹æ®æ–¹æ³•åå’Œå‚æ•°ä¸ªæ•°ã€ç±»å‹, ç”¨ switch å’Œ if æ‰¾åˆ°è¿™äº›æ–¹æ³•ç¼–å·</li> <li>ç„¶åå†æ ¹æ®ç¼–å·å»è°ƒç”¨ç›®æ ‡æ–¹æ³•, åˆç”¨äº†ä¸€å¤§å † switch å’Œ if, ä½†é¿å…äº†åå°„</li></ul></li> <li>ProxyFastClass è®°å½•äº† Proxy ä¸­æ–¹æ³•ä¸ç¼–å·çš„å¯¹åº”å…³ç³»ï¼Œä¸è¿‡ Proxy é¢å¤–æä¾›äº†ä¸‹é¢å‡ ä¸ªæ–¹æ³•
<ul><li>saveSuper(long) ç¼–å· 2ï¼Œä¸å¢å¼ºï¼Œä»…æ˜¯è°ƒç”¨ super.save(long)</li> <li>saveSuper(int) ç¼–å· 1ï¼Œä¸å¢å¼º, ä»…æ˜¯è°ƒç”¨ super.save(int)</li> <li>saveSuper() ç¼–å· 0ï¼Œä¸å¢å¼º, ä»…æ˜¯è°ƒç”¨ super.save()</li> <li>æŸ¥æ‰¾æ–¹å¼ä¸ TargetFastClass ç±»ä¼¼</li></ul></li> <li>ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆéº»çƒ¦çš„ä¸€å¥—ä¸œè¥¿å‘¢ï¼Ÿ
<ul><li>é¿å…åå°„, æé«˜æ€§èƒ½, ä»£ä»·æ˜¯ä¸€ä¸ªä»£ç†ç±»é…ä¸¤ä¸ª FastClass ç±», ä»£ç†ç±»ä¸­è¿˜å¾—å¢åŠ ä»…è°ƒç”¨ super çš„ä¸€å †æ–¹æ³•</li> <li>ç”¨ç¼–å·å¤„ç†æ–¹æ³•å¯¹åº”å…³ç³»æ¯”è¾ƒçœå†…å­˜, å¦å¤–, æœ€åˆè·å¾—æ–¹æ³•é¡ºåºæ˜¯ä¸ç¡®å®šçš„, è¿™ä¸ªè¿‡ç¨‹æ²¡æ³•å›ºå®šæ­»</li></ul></li></ol> <h3 id="_15-jdk-å’Œ-cglib-åœ¨-spring-ä¸­çš„ç»Ÿä¸€"><a href="#_15-jdk-å’Œ-cglib-åœ¨-spring-ä¸­çš„ç»Ÿä¸€" class="header-anchor">#</a> 15) jdk å’Œ cglib åœ¨ Spring ä¸­çš„ç»Ÿä¸€</h3> <p>Spring ä¸­å¯¹åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢çš„æŠ½è±¡å¦‚ä¸‹</p> <ul><li>åˆ‡ç‚¹ï¼šæ¥å£ Pointcutï¼Œå…¸å‹å®ç° AspectJExpressionPointcut</li> <li>é€šçŸ¥ï¼šå…¸å‹æ¥å£ä¸º MethodInterceptor ä»£è¡¨ç¯ç»•é€šçŸ¥</li> <li>åˆ‡é¢ï¼šAdvisorï¼ŒåŒ…å«ä¸€ä¸ª Advice é€šçŸ¥ï¼ŒPointcutAdvisor åŒ…å«ä¸€ä¸ª Advice é€šçŸ¥å’Œä¸€ä¸ª Pointcut</li></ul> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">classDiagram</span>

<span class="token keyword">class</span> Advice
<span class="token keyword">class</span> MethodInterceptor
<span class="token keyword">class</span> Advisor
<span class="token keyword">class</span> PointcutAdvisor

Pointcut <span class="token arrow operator">&lt;|--</span> AspectJExpressionPointcut
Advice <span class="token arrow operator">&lt;|--</span> MethodInterceptor
Advisor <span class="token arrow operator">&lt;|--</span> PointcutAdvisor
PointcutAdvisor <span class="token arrow operator">o--</span> <span class="token string">&quot;ä¸€&quot;</span> Pointcut
PointcutAdvisor <span class="token arrow operator">o--</span> <span class="token string">&quot;ä¸€&quot;</span> Advice

<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> Advice
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> MethodInterceptor
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> Pointcut
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> Advisor
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> PointcutAdvisor
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>ä»£ç†ç›¸å…³ç±»å›¾</p> <ul><li>AopProxyFactory æ ¹æ® proxyTargetClass ç­‰è®¾ç½®é€‰æ‹© AopProxy å®ç°</li> <li>AopProxy é€šè¿‡ getProxy åˆ›å»ºä»£ç†å¯¹è±¡</li> <li>å›¾ä¸­ Proxy éƒ½å®ç°äº† Advised æ¥å£ï¼Œèƒ½å¤Ÿè·å¾—å…³è”çš„åˆ‡é¢é›†åˆä¸ç›®æ ‡ï¼ˆå…¶å®æ˜¯ä» ProxyFactory å–å¾—ï¼‰</li> <li>è°ƒç”¨ä»£ç†æ–¹æ³•æ—¶ï¼Œä¼šå€ŸåŠ© ProxyFactory å°†é€šçŸ¥ç»Ÿä¸€è½¬ä¸ºç¯ç»•é€šçŸ¥ï¼šMethodInterceptor</li></ul> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">classDiagram</span>

Advised <span class="token arrow operator">&lt;|--</span> ProxyFactory
ProxyFactory <span class="token arrow operator">o--</span> Target
ProxyFactory <span class="token arrow operator">o--</span> <span class="token string">&quot;å¤š&quot;</span> Advisor

ProxyFactory <span class="token arrow operator">--&gt;</span> AopProxyFactory <span class="token operator">:</span> ä½¿ç”¨
AopProxyFactory <span class="token arrow operator">--&gt;</span> AopProxy
Advised <span class="token arrow operator">&lt;|--</span> åŸºäºCGLIBçš„Proxy
åŸºäºCGLIBçš„Proxy <span class="token arrow operator">&lt;--</span> ObjenesisCglibAopProxy <span class="token operator">:</span> åˆ›å»º
AopProxy <span class="token arrow operator">&lt;|--</span> ObjenesisCglibAopProxy
AopProxy <span class="token arrow operator">&lt;|--</span> JdkDynamicAopProxy
åŸºäºJDKçš„Proxy <span class="token arrow operator">&lt;--</span> JdkDynamicAopProxy <span class="token operator">:</span> åˆ›å»º
Advised <span class="token arrow operator">&lt;|--</span> åŸºäºJDKçš„Proxy

<span class="token keyword">class</span> AopProxy <span class="token punctuation">{</span>
   +getProxy<span class="token punctuation">(</span><span class="token punctuation">)</span> Object
<span class="token punctuation">}</span>

<span class="token keyword">class</span> ProxyFactory <span class="token punctuation">{</span>
    proxyTargetClass <span class="token operator">:</span> boolean
<span class="token punctuation">}</span>

<span class="token keyword">class</span> ObjenesisCglibAopProxy <span class="token punctuation">{</span>
    advised <span class="token operator">:</span> ProxyFactory
<span class="token punctuation">}</span>

<span class="token keyword">class</span> JdkDynamicAopProxy <span class="token punctuation">{</span>
    advised <span class="token operator">:</span> ProxyFactory
<span class="token punctuation">}</span>

<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> Advised
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> AopProxyFactory
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> AopProxy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="æ¼”ç¤º-åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢"><a href="#æ¼”ç¤º-åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢" class="header-anchor">#</a> æ¼”ç¤º - åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢</h4> <h5 id="ä»£ç å‚è€ƒ-19"><a href="#ä»£ç å‚è€ƒ-19" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a15.A15</strong></p> <h4 id="æ”¶è·ğŸ’¡-24"><a href="#æ”¶è·ğŸ’¡-24" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>åº•å±‚çš„åˆ‡ç‚¹å®ç°</li> <li>åº•å±‚çš„é€šçŸ¥å®ç°</li> <li>åº•å±‚çš„åˆ‡é¢å®ç°</li> <li>ProxyFactory ç”¨æ¥åˆ›å»ºä»£ç†
<ul><li>å¦‚æœæŒ‡å®šäº†æ¥å£ï¼Œä¸” proxyTargetClass = falseï¼Œä½¿ç”¨ JdkDynamicAopProxy</li> <li>å¦‚æœæ²¡æœ‰æŒ‡å®šæ¥å£ï¼Œæˆ–è€… proxyTargetClass = trueï¼Œä½¿ç”¨ ObjenesisCglibAopProxy
<ul><li>ä¾‹å¤–ï¼šå¦‚æœç›®æ ‡æ˜¯æ¥å£ç±»å‹æˆ–å·²ç»æ˜¯ Jdk ä»£ç†ï¼Œä½¿ç”¨ JdkDynamicAopProxy</li></ul></li></ul></li></ol> <blockquote><p><em><strong>æ³¨æ„</strong></em></p> <ul><li>è¦åŒºåˆ†æœ¬ç« èŠ‚æåˆ°çš„ MethodInterceptorï¼Œå®ƒä¸ä¹‹å‰ cglib ä¸­ç”¨çš„çš„ MethodInterceptor æ˜¯ä¸åŒçš„æ¥å£</li></ul></blockquote> <h3 id="_16-åˆ‡ç‚¹åŒ¹é…"><a href="#_16-åˆ‡ç‚¹åŒ¹é…" class="header-anchor">#</a> 16) åˆ‡ç‚¹åŒ¹é…</h3> <h4 id="æ¼”ç¤º-åˆ‡ç‚¹åŒ¹é…"><a href="#æ¼”ç¤º-åˆ‡ç‚¹åŒ¹é…" class="header-anchor">#</a> æ¼”ç¤º - åˆ‡ç‚¹åŒ¹é…</h4> <h5 id="ä»£ç å‚è€ƒ-20"><a href="#ä»£ç å‚è€ƒ-20" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a16.A16</strong></p> <h4 id="æ”¶è·ğŸ’¡-25"><a href="#æ”¶è·ğŸ’¡-25" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å¸¸è§ aspectj åˆ‡ç‚¹ç”¨æ³•</li> <li>aspectj åˆ‡ç‚¹çš„å±€é™æ€§ï¼Œå®é™…çš„ @Transactional åˆ‡ç‚¹å®ç°</li></ol> <h3 id="_17-ä»-aspect-åˆ°-advisor"><a href="#_17-ä»-aspect-åˆ°-advisor" class="header-anchor">#</a> 17) ä» @Aspect åˆ° Advisor</h3> <h4 id="æ¼”ç¤º1-ä»£ç†åˆ›å»ºå™¨"><a href="#æ¼”ç¤º1-ä»£ç†åˆ›å»ºå™¨" class="header-anchor">#</a> æ¼”ç¤º1 - ä»£ç†åˆ›å»ºå™¨</h4> <h5 id="ä»£ç å‚è€ƒ-21"><a href="#ä»£ç å‚è€ƒ-21" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>org.springframework.aop.framework.autoproxy</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-26"><a href="#æ”¶è·ğŸ’¡-26" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>AnnotationAwareAspectJAutoProxyCreator çš„ä½œç”¨
<ul><li>å°†é«˜çº§ @Aspect åˆ‡é¢ç»Ÿä¸€ä¸ºä½çº§ Advisor åˆ‡é¢</li> <li>åœ¨åˆé€‚çš„æ—¶æœºåˆ›å»ºä»£ç†</li></ul></li> <li>findEligibleAdvisors æ‰¾åˆ°æœ‰ã€èµ„æ ¼ã€‘çš„ Advisors
<ul><li>æœ‰ã€èµ„æ ¼ã€‘çš„ Advisor ä¸€éƒ¨åˆ†æ˜¯ä½çº§çš„, å¯ä»¥ç”±è‡ªå·±ç¼–å†™, å¦‚æœ¬ä¾‹ A17 ä¸­çš„ advisor3</li> <li>æœ‰ã€èµ„æ ¼ã€‘çš„ Advisor å¦ä¸€éƒ¨åˆ†æ˜¯é«˜çº§çš„, ç”±è§£æ @Aspect åè·å¾—</li></ul></li> <li>wrapIfNecessary
<ul><li>å®ƒå†…éƒ¨è°ƒç”¨ findEligibleAdvisors, åªè¦è¿”å›é›†åˆä¸ç©º, åˆ™è¡¨ç¤ºéœ€è¦åˆ›å»ºä»£ç†</li> <li>å®ƒçš„è°ƒç”¨æ—¶æœºé€šå¸¸åœ¨åŸå§‹å¯¹è±¡åˆå§‹åŒ–åæ‰§è¡Œ, ä½†ç¢°åˆ°å¾ªç¯ä¾èµ–ä¼šæå‰è‡³ä¾èµ–æ³¨å…¥ä¹‹å‰æ‰§è¡Œ</li></ul></li></ol> <h4 id="æ¼”ç¤º2-ä»£ç†åˆ›å»ºæ—¶æœº"><a href="#æ¼”ç¤º2-ä»£ç†åˆ›å»ºæ—¶æœº" class="header-anchor">#</a> æ¼”ç¤º2 - ä»£ç†åˆ›å»ºæ—¶æœº</h4> <h5 id="ä»£ç å‚è€ƒ-22"><a href="#ä»£ç å‚è€ƒ-22" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>org.springframework.aop.framework.autoproxy.A17_1</strong></p> <h4 id="æ”¶è·ğŸ’¡-27"><a href="#æ”¶è·ğŸ’¡-27" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>ä»£ç†çš„åˆ›å»ºæ—¶æœº
<ul><li>åˆå§‹åŒ–ä¹‹å (æ— å¾ªç¯ä¾èµ–æ—¶)</li> <li>å®ä¾‹åˆ›å»ºå, ä¾èµ–æ³¨å…¥å‰ (æœ‰å¾ªç¯ä¾èµ–æ—¶), å¹¶æš‚å­˜äºäºŒçº§ç¼“å­˜</li></ul></li> <li>ä¾èµ–æ³¨å…¥ä¸åˆå§‹åŒ–ä¸åº”è¯¥è¢«å¢å¼º, ä»åº”è¢«æ–½åŠ äºåŸå§‹å¯¹è±¡</li></ol> <h4 id="æ¼”ç¤º3-before-å¯¹åº”çš„ä½çº§é€šçŸ¥"><a href="#æ¼”ç¤º3-before-å¯¹åº”çš„ä½çº§é€šçŸ¥" class="header-anchor">#</a> æ¼”ç¤º3 - @Before å¯¹åº”çš„ä½çº§é€šçŸ¥</h4> <h5 id="ä»£ç å‚è€ƒ-23"><a href="#ä»£ç å‚è€ƒ-23" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>org.springframework.aop.framework.autoproxy.A17_2</strong></p> <h4 id="æ”¶è·ğŸ’¡-28"><a href="#æ”¶è·ğŸ’¡-28" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>@Before å‰ç½®é€šçŸ¥ä¼šè¢«è½¬æ¢ä¸ºåŸå§‹çš„ AspectJMethodBeforeAdvice å½¢å¼, è¯¥å¯¹è±¡åŒ…å«äº†å¦‚ä¸‹ä¿¡æ¯
<ol><li>é€šçŸ¥ä»£ç ä»å“ªå„¿æ¥</li> <li>åˆ‡ç‚¹æ˜¯ä»€ä¹ˆ(è¿™é‡Œä¸ºå•¥è¦åˆ‡ç‚¹, åé¢è§£é‡Š)</li> <li>é€šçŸ¥å¯¹è±¡å¦‚ä½•åˆ›å»º, æœ¬ä¾‹å…±ç”¨åŒä¸€ä¸ª Aspect å¯¹è±¡</li></ol></li> <li>ç±»ä¼¼çš„è¿˜æœ‰
<ol><li>AspectJAroundAdvice (ç¯ç»•é€šçŸ¥)</li> <li>AspectJAfterReturningAdvice</li> <li>AspectJAfterThrowingAdvice (ç¯ç»•é€šçŸ¥)</li> <li>AspectJAfterAdvice (ç¯ç»•é€šçŸ¥)</li></ol></li></ol> <h3 id="_18-é™æ€é€šçŸ¥è°ƒç”¨"><a href="#_18-é™æ€é€šçŸ¥è°ƒç”¨" class="header-anchor">#</a> 18) é™æ€é€šçŸ¥è°ƒç”¨</h3> <p>ä»£ç†å¯¹è±¡è°ƒç”¨æµç¨‹å¦‚ä¸‹ï¼ˆä»¥ JDK åŠ¨æ€ä»£ç†å®ç°ä¸ºä¾‹ï¼‰</p> <ul><li>ä» ProxyFactory è·å¾— Target å’Œç¯ç»•é€šçŸ¥é“¾ï¼Œæ ¹æ®ä»–ä¿©åˆ›å»º MethodInvocationï¼Œç®€ç§° mi</li> <li>é¦–æ¬¡æ‰§è¡Œ mi.proceed() å‘ç°æœ‰ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨å®ƒçš„ invoke(mi)</li> <li>è¿›å…¥ç¯ç»•é€šçŸ¥1ï¼Œæ‰§è¡Œå‰å¢å¼ºï¼Œå†æ¬¡è°ƒç”¨ mi.proceed() å‘ç°æœ‰ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨å®ƒçš„ invoke(mi)</li> <li>è¿›å…¥ç¯ç»•é€šçŸ¥2ï¼Œæ‰§è¡Œå‰å¢å¼ºï¼Œè°ƒç”¨ mi.proceed() å‘ç°æ²¡æœ‰ç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨ mi.invokeJoinPoint() æ‰§è¡Œç›®æ ‡æ–¹æ³•</li> <li>ç›®æ ‡æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›ç»™ç¯ç»•é€šçŸ¥2ï¼Œæ‰§è¡Œç¯ç»•é€šçŸ¥2 çš„åå¢å¼º</li> <li>ç¯ç»•é€šçŸ¥2ç»§ç»­å°†ç»“æœè¿”å›ç»™ç¯ç»•é€šçŸ¥1ï¼Œæ‰§è¡Œç¯ç»•é€šçŸ¥1 çš„åå¢å¼º</li> <li>ç¯ç»•é€šçŸ¥1è¿”å›æœ€ç»ˆçš„ç»“æœ</li></ul> <p>å›¾ä¸­ä¸åŒé¢œè‰²å¯¹åº”ä¸€æ¬¡ç¯ç»•é€šçŸ¥æˆ–ç›®æ ‡çš„è°ƒç”¨èµ·å§‹è‡³ç»ˆç»“</p> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">sequenceDiagram</span>
<span class="token keyword">participant</span> Proxy
<span class="token keyword">participant</span> ih as InvocationHandler
<span class="token keyword">participant</span> mi as MethodInvocation
<span class="token keyword">participant</span> Factory as ProxyFactory
<span class="token keyword">participant</span> mi1 as MethodInterceptor1
<span class="token keyword">participant</span> mi2 as MethodInterceptor2
<span class="token keyword">participant</span> Target

Proxy <span class="token arrow operator">-&gt;&gt;</span> +ih <span class="token operator">:</span> invoke<span class="token punctuation">(</span><span class="token punctuation">)</span>
ih <span class="token arrow operator">-&gt;&gt;</span> +Factory <span class="token operator">:</span> è·å¾— Target
Factory <span class="token arrow operator">--&gt;&gt;</span> -ih <span class="token operator">:</span> 
ih <span class="token arrow operator">-&gt;&gt;</span> +Factory <span class="token operator">:</span> è·å¾— MethodInterceptor é“¾
Factory <span class="token arrow operator">--&gt;&gt;</span> -ih <span class="token operator">:</span> 
ih <span class="token arrow operator">-&gt;&gt;</span> +mi <span class="token operator">:</span> åˆ›å»º mi
mi <span class="token arrow operator">--&gt;&gt;</span> -ih <span class="token operator">:</span> 
<span class="token keyword">rect</span> rgb<span class="token text string">(200, 223, 255)</span>
ih <span class="token arrow operator">-&gt;&gt;</span> +mi <span class="token operator">:</span> mi.proceed<span class="token punctuation">(</span><span class="token punctuation">)</span>
mi <span class="token arrow operator">-&gt;&gt;</span> +mi1 <span class="token operator">:</span> invoke<span class="token text string">(mi)</span>
mi1 <span class="token arrow operator">-&gt;&gt;</span> mi1 <span class="token operator">:</span> å‰å¢å¼º
<span class="token keyword">rect</span> rgb<span class="token text string">(200, 190, 255)</span>
mi1 <span class="token arrow operator">-&gt;&gt;</span> mi <span class="token operator">:</span> mi.proceed<span class="token punctuation">(</span><span class="token punctuation">)</span>
mi <span class="token arrow operator">-&gt;&gt;</span> +mi2 <span class="token operator">:</span> invoke<span class="token text string">(mi)</span>
mi2 <span class="token arrow operator">-&gt;&gt;</span> mi2 <span class="token operator">:</span> å‰å¢å¼º
<span class="token keyword">rect</span> rgb<span class="token text string">(150, 190, 155)</span>
mi2 <span class="token arrow operator">-&gt;&gt;</span> mi <span class="token operator">:</span> mi.proceed<span class="token punctuation">(</span><span class="token punctuation">)</span>
mi <span class="token arrow operator">-&gt;&gt;</span> +Target <span class="token operator">:</span> mi.invokeJoinPoint<span class="token punctuation">(</span><span class="token punctuation">)</span>
Target <span class="token arrow operator">-&gt;&gt;</span> Target <span class="token operator">:</span> 
Target <span class="token arrow operator">--&gt;&gt;</span> -mi2 <span class="token operator">:</span> ç»“æœ
<span class="token keyword">end</span>
mi2 <span class="token arrow operator">-&gt;&gt;</span> mi2 <span class="token operator">:</span> åå¢å¼º
mi2 <span class="token arrow operator">--&gt;&gt;</span> -mi1 <span class="token operator">:</span> ç»“æœ
<span class="token keyword">end</span>
mi1 <span class="token arrow operator">-&gt;&gt;</span> mi1 <span class="token operator">:</span> åå¢å¼º
mi1 <span class="token arrow operator">--&gt;&gt;</span> -mi <span class="token operator">:</span> ç»“æœ
mi <span class="token arrow operator">--&gt;&gt;</span> -ih <span class="token operator">:</span> 
<span class="token keyword">end</span>
ih <span class="token arrow operator">--&gt;&gt;</span> -Proxy <span class="token operator">:</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h4 id="æ¼”ç¤º1-é€šçŸ¥è°ƒç”¨è¿‡ç¨‹"><a href="#æ¼”ç¤º1-é€šçŸ¥è°ƒç”¨è¿‡ç¨‹" class="header-anchor">#</a> æ¼”ç¤º1 - é€šçŸ¥è°ƒç”¨è¿‡ç¨‹</h4> <h5 id="ä»£ç å‚è€ƒ-24"><a href="#ä»£ç å‚è€ƒ-24" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>org.springframework.aop.framework.A18</strong></p> <h4 id="æ”¶è·ğŸ’¡-29"><a href="#æ”¶è·ğŸ’¡-29" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>ä»£ç†æ–¹æ³•æ‰§è¡Œæ—¶ä¼šåšå¦‚ä¸‹å·¥ä½œ</p> <ol><li>é€šè¿‡ proxyFactory çš„ getInterceptorsAndDynamicInterceptionAdvice() å°†å…¶ä»–é€šçŸ¥ç»Ÿä¸€è½¬æ¢ä¸º MethodInterceptor ç¯ç»•é€šçŸ¥
<ul><li>MethodBeforeAdviceAdapter å°† @Before AspectJMethodBeforeAdvice é€‚é…ä¸º MethodBeforeAdviceInterceptor</li> <li>AfterReturningAdviceAdapter å°† @AfterReturning AspectJAfterReturningAdvice é€‚é…ä¸º AfterReturningAdviceInterceptor</li> <li>è¿™ä½“ç°çš„æ˜¯é€‚é…å™¨è®¾è®¡æ¨¡å¼</li></ul></li> <li>æ‰€è°“é™æ€é€šçŸ¥ï¼Œä½“ç°åœ¨ä¸Šé¢æ–¹æ³•çš„ Interceptors éƒ¨åˆ†ï¼Œè¿™äº›é€šçŸ¥è°ƒç”¨æ—¶æ— éœ€å†æ¬¡æ£€æŸ¥åˆ‡ç‚¹ï¼Œç›´æ¥è°ƒç”¨å³å¯</li> <li>ç»“åˆç›®æ ‡ä¸ç¯ç»•é€šçŸ¥é“¾ï¼Œåˆ›å»º MethodInvocation å¯¹è±¡ï¼Œé€šè¿‡å®ƒå®Œæˆæ•´ä¸ªè°ƒç”¨</li></ol> <h4 id="æ¼”ç¤º2-æ¨¡æ‹Ÿ-methodinvocation"><a href="#æ¼”ç¤º2-æ¨¡æ‹Ÿ-methodinvocation" class="header-anchor">#</a> æ¼”ç¤º2 - æ¨¡æ‹Ÿ MethodInvocation</h4> <h5 id="ä»£ç å‚è€ƒ-25"><a href="#ä»£ç å‚è€ƒ-25" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>org.springframework.aop.framework.A18_1</strong></p> <h4 id="æ”¶è·ğŸ’¡-30"><a href="#æ”¶è·ğŸ’¡-30" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>proceed() æ–¹æ³•è°ƒç”¨é“¾ä¸­ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥</li> <li>æ¯ä¸ªç¯ç»•é€šçŸ¥å†…éƒ¨ç»§ç»­è°ƒç”¨ proceed()</li> <li>è°ƒç”¨åˆ°æ²¡æœ‰æ›´å¤šé€šçŸ¥äº†, å°±è°ƒç”¨ç›®æ ‡æ–¹æ³•</li></ol> <p>MethodInvocation çš„ç¼–ç¨‹æŠ€å·§åœ¨å®ç°æ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ—¶èƒ½ç”¨ä¸Š</p> <h3 id="_19-åŠ¨æ€é€šçŸ¥è°ƒç”¨"><a href="#_19-åŠ¨æ€é€šçŸ¥è°ƒç”¨" class="header-anchor">#</a> 19) åŠ¨æ€é€šçŸ¥è°ƒç”¨</h3> <h4 id="æ¼”ç¤º-å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨"><a href="#æ¼”ç¤º-å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨" class="header-anchor">#</a> æ¼”ç¤º - å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨</h4> <h5 id="ä»£ç å‚è€ƒ-26"><a href="#ä»£ç å‚è€ƒ-26" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>org.springframework.aop.framework.autoproxy.A19</strong></p> <h4 id="æ”¶è·ğŸ’¡-31"><a href="#æ”¶è·ğŸ’¡-31" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>é€šè¿‡ proxyFactory çš„ getInterceptorsAndDynamicInterceptionAdvice() å°†å…¶ä»–é€šçŸ¥ç»Ÿä¸€è½¬æ¢ä¸º MethodInterceptor ç¯ç»•é€šçŸ¥</li> <li>æ‰€è°“åŠ¨æ€é€šçŸ¥ï¼Œä½“ç°åœ¨ä¸Šé¢æ–¹æ³•çš„ DynamicInterceptionAdvice éƒ¨åˆ†ï¼Œè¿™äº›é€šçŸ¥è°ƒç”¨æ—¶å› ä¸ºè¦ä¸ºé€šçŸ¥æ–¹æ³•ç»‘å®šå‚æ•°ï¼Œè¿˜éœ€å†æ¬¡åˆ©ç”¨åˆ‡ç‚¹è¡¨è¾¾å¼</li> <li>åŠ¨æ€é€šçŸ¥è°ƒç”¨å¤æ‚ç¨‹åº¦é«˜ï¼Œæ€§èƒ½è¾ƒä½</li></ol> <h2 id="web"><a href="#web" class="header-anchor">#</a> WEB</h2> <h3 id="_20-requestmappinghandlermapping-ä¸-requestmappinghandleradapter"><a href="#_20-requestmappinghandlermapping-ä¸-requestmappinghandleradapter" class="header-anchor">#</a> 20) RequestMappingHandlerMapping ä¸ RequestMappingHandlerAdapter</h3> <p>RequestMappingHandlerMapping ä¸ RequestMappingHandlerAdapter ä¿©æ˜¯ä¸€å¯¹ï¼Œåˆ†åˆ«ç”¨æ¥</p> <ul><li>å¤„ç† @RequestMapping æ˜ å°„</li> <li>è°ƒç”¨æ§åˆ¶å™¨æ–¹æ³•ã€å¹¶å¤„ç†æ–¹æ³•å‚æ•°ä¸æ–¹æ³•è¿”å›å€¼</li></ul> <h4 id="æ¼”ç¤º1-dispatcherservlet-åˆå§‹åŒ–"><a href="#æ¼”ç¤º1-dispatcherservlet-åˆå§‹åŒ–" class="header-anchor">#</a> æ¼”ç¤º1 - DispatcherServlet åˆå§‹åŒ–</h4> <h5 id="ä»£ç å‚è€ƒ-27"><a href="#ä»£ç å‚è€ƒ-27" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a20</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-32"><a href="#æ”¶è·ğŸ’¡-32" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>DispatcherServlet æ˜¯åœ¨ç¬¬ä¸€æ¬¡è¢«è®¿é—®æ—¶æ‰§è¡Œåˆå§‹åŒ–, ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®ä¿®æ”¹ä¸º Tomcat å¯åŠ¨åå°±åˆå§‹åŒ–</li> <li>åœ¨åˆå§‹åŒ–æ—¶ä¼šä» Spring å®¹å™¨ä¸­æ‰¾ä¸€äº› Web éœ€è¦çš„ç»„ä»¶, å¦‚ HandlerMappingã€HandlerAdapter ç­‰ï¼Œå¹¶é€ä¸€è°ƒç”¨å®ƒä»¬çš„åˆå§‹åŒ–</li> <li>RequestMappingHandlerMapping åˆå§‹åŒ–æ—¶ï¼Œä¼šæ”¶é›†æ‰€æœ‰ @RequestMapping æ˜ å°„ä¿¡æ¯ï¼Œå°è£…ä¸º Mapï¼Œå…¶ä¸­
<ul><li>key æ˜¯ RequestMappingInfo ç±»å‹ï¼ŒåŒ…æ‹¬è¯·æ±‚è·¯å¾„ã€è¯·æ±‚æ–¹æ³•ç­‰ä¿¡æ¯</li> <li>value æ˜¯ HandlerMethod ç±»å‹ï¼ŒåŒ…æ‹¬æ§åˆ¶å™¨æ–¹æ³•å¯¹è±¡ã€æ§åˆ¶å™¨å¯¹è±¡</li> <li>æœ‰äº†è¿™ä¸ª Mapï¼Œå°±å¯ä»¥åœ¨è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œå¿«é€Ÿå®Œæˆæ˜ å°„ï¼Œæ‰¾åˆ° HandlerMethod å¹¶ä¸åŒ¹é…çš„æ‹¦æˆªå™¨ä¸€èµ·è¿”å›ç»™ DispatcherServlet</li></ul></li> <li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ï¼Œä¼šå‡†å¤‡ HandlerMethod è°ƒç”¨æ—¶éœ€è¦çš„å„ä¸ªç»„ä»¶ï¼Œå¦‚ï¼š
<ul><li>HandlerMethodArgumentResolver è§£ææ§åˆ¶å™¨æ–¹æ³•å‚æ•°</li> <li>HandlerMethodReturnValueHandler å¤„ç†æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼</li></ul></li></ol> <h4 id="æ¼”ç¤º2-è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨"><a href="#æ¼”ç¤º2-è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨" class="header-anchor">#</a> æ¼”ç¤º2 - è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨</h4> <h5 id="ä»£ç å‚è€ƒ-28"><a href="#ä»£ç å‚è€ƒ-28" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a20.TokenArgumentResolver</strong> ï¼Œ<strong>com.itheima.a20.YmlReturnValueHandler</strong></p> <h4 id="æ”¶è·ğŸ’¡-33"><a href="#æ”¶è·ğŸ’¡-33" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>ä½“ä¼šå‚æ•°è§£æå™¨çš„ä½œç”¨</li> <li>ä½“ä¼šè¿”å›å€¼å¤„ç†å™¨çš„ä½œç”¨</li></ol> <h3 id="_21-å‚æ•°è§£æå™¨"><a href="#_21-å‚æ•°è§£æå™¨" class="header-anchor">#</a> 21) å‚æ•°è§£æå™¨</h3> <h4 id="æ¼”ç¤º-å¸¸è§å‚æ•°è§£æå™¨"><a href="#æ¼”ç¤º-å¸¸è§å‚æ•°è§£æå™¨" class="header-anchor">#</a> æ¼”ç¤º - å¸¸è§å‚æ•°è§£æå™¨</h4> <h5 id="ä»£ç å‚è€ƒ-29"><a href="#ä»£ç å‚è€ƒ-29" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a21</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-34"><a href="#æ”¶è·ğŸ’¡-34" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>åˆæ­¥äº†è§£ RequestMappingHandlerAdapter çš„è°ƒç”¨è¿‡ç¨‹
<ol><li>æ§åˆ¶å™¨æ–¹æ³•è¢«å°è£…ä¸º HandlerMethod</li> <li>å‡†å¤‡å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢</li> <li>å‡†å¤‡ ModelAndViewContainer ç”¨æ¥å­˜å‚¨ä¸­é—´ Model ç»“æœ</li> <li>è§£ææ¯ä¸ªå‚æ•°å€¼</li></ol></li> <li>è§£æå‚æ•°ä¾èµ–çš„å°±æ˜¯å„ç§å‚æ•°è§£æå™¨ï¼Œå®ƒä»¬éƒ½æœ‰ä¸¤ä¸ªé‡è¦æ–¹æ³•
<ul><li>supportsParameter åˆ¤æ–­æ˜¯å¦æ”¯æŒæ–¹æ³•å‚æ•°</li> <li>resolveArgument è§£ææ–¹æ³•å‚æ•°</li></ul></li> <li>å¸¸è§å‚æ•°çš„è§£æ
<ul><li>@RequestParam</li> <li>çœç•¥ @RequestParam</li> <li>@RequestParam(defaultValue)</li> <li>MultipartFile</li> <li>@PathVariable</li> <li>@RequestHeader</li> <li>@CookieValue</li> <li>@Value</li> <li>HttpServletRequest ç­‰</li> <li>@ModelAttribute</li> <li>çœç•¥ @ModelAttribute</li> <li>@RequestBody</li></ul></li> <li>ç»„åˆæ¨¡å¼åœ¨ Spring ä¸­çš„ä½“ç°</li> <li>@RequestParam, @CookieValue ç­‰æ³¨è§£ä¸­çš„å‚æ•°åã€é»˜è®¤å€¼, éƒ½å¯ä»¥å†™æˆæ´»çš„, å³ä» ${ } #{ }ä¸­è·å–</li></ol> <h3 id="_22-å‚æ•°åè§£æ"><a href="#_22-å‚æ•°åè§£æ" class="header-anchor">#</a> 22) å‚æ•°åè§£æ</h3> <h4 id="æ¼”ç¤º-ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å"><a href="#æ¼”ç¤º-ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å" class="header-anchor">#</a> æ¼”ç¤º - ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å</h4> <h5 id="ä»£ç å‚è€ƒ-30"><a href="#ä»£ç å‚è€ƒ-30" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a22.A22</strong></p> <h4 id="æ”¶è·ğŸ’¡-35"><a href="#æ”¶è·ğŸ’¡-35" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å¦‚æœç¼–è¯‘æ—¶æ·»åŠ äº† -parameters å¯ä»¥ç”Ÿæˆå‚æ•°è¡¨, åå°„æ—¶å°±å¯ä»¥æ‹¿åˆ°å‚æ•°å</li> <li>å¦‚æœç¼–è¯‘æ—¶æ·»åŠ äº† -g å¯ä»¥ç”Ÿæˆè°ƒè¯•ä¿¡æ¯, ä½†åˆ†ä¸ºä¸¤ç§æƒ…å†µ
<ul><li>æ™®é€šç±», ä¼šåŒ…å«å±€éƒ¨å˜é‡è¡¨, ç”¨ asm å¯ä»¥æ‹¿åˆ°å‚æ•°å</li> <li>æ¥å£, ä¸ä¼šåŒ…å«å±€éƒ¨å˜é‡è¡¨, æ— æ³•è·å¾—å‚æ•°å
<ul><li>è¿™ä¹Ÿæ˜¯ MyBatis åœ¨å®ç° Mapper æ¥å£æ—¶ä¸ºä½•è¦æä¾› @Param æ³¨è§£æ¥è¾…åŠ©è·å¾—å‚æ•°å</li></ul></li></ul></li></ol> <h3 id="_23-å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢"><a href="#_23-å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢" class="header-anchor">#</a> 23) å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢</h3> <h4 id="åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°"><a href="#åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°" class="header-anchor">#</a> åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°</h4> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">classDiagram</span>

Formatter <span class="token arrow operator">--|&gt;</span> Printer
Formatter <span class="token arrow operator">--|&gt;</span> Parser

<span class="token keyword">class</span> Converters <span class="token punctuation">{</span>
   Set~GenericConverter~
<span class="token punctuation">}</span>
<span class="token keyword">class</span> Converter

<span class="token keyword">class</span> ConversionService
<span class="token keyword">class</span> FormattingConversionService

ConversionService <span class="token arrow operator">&lt;|--</span> FormattingConversionService
FormattingConversionService <span class="token arrow operator">o--</span> Converters

Printer <span class="token arrow operator">--&gt;</span> Adapter1
Adapter1 <span class="token arrow operator">--&gt;</span> Converters
Parser <span class="token arrow operator">--&gt;</span> Adapter2
Adapter2 <span class="token arrow operator">--&gt;</span> Converters
Converter <span class="token arrow operator">--&gt;</span> Adapter3
Adapter3 <span class="token arrow operator">--&gt;</span> Converters

<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> Formatter
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> Printer
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> Parser
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> Converter
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> ConversionService
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><ul><li>Printer æŠŠå…¶å®ƒç±»å‹è½¬ä¸º String</li> <li>Parser æŠŠ String è½¬ä¸ºå…¶å®ƒç±»å‹</li> <li>Formatter ç»¼åˆ Printer ä¸ Parser åŠŸèƒ½</li> <li>Converter æŠŠç±»å‹ S è½¬ä¸ºç±»å‹ T</li> <li>Printerã€Parserã€Converter ç»è¿‡é€‚é…è½¬æ¢æˆ GenericConverter æ”¾å…¥ Converters é›†åˆ</li> <li>FormattingConversionService åˆ©ç”¨å…¶å®ƒä»¬å®ç°è½¬æ¢</li></ul> <h4 id="åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£"><a href="#åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£" class="header-anchor">#</a> åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£</h4> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">classDiagram</span>

PropertyEditorRegistry <span class="token arrow operator">o--</span> <span class="token string">&quot;å¤š&quot;</span> PropertyEditor

<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> PropertyEditorRegistry
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> PropertyEditor
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>PropertyEditor æŠŠ String ä¸å…¶å®ƒç±»å‹ç›¸äº’è½¬æ¢</li> <li>PropertyEditorRegistry å¯ä»¥æ³¨å†Œå¤šä¸ª PropertyEditor å¯¹è±¡</li> <li>ä¸ç¬¬ä¸€å¥—æ¥å£ç›´æ¥å¯ä»¥é€šè¿‡ FormatterPropertyEditorAdapter æ¥è¿›è¡Œé€‚é…</li></ul> <h4 id="é«˜å±‚æ¥å£ä¸å®ç°"><a href="#é«˜å±‚æ¥å£ä¸å®ç°" class="header-anchor">#</a> é«˜å±‚æ¥å£ä¸å®ç°</h4> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">classDiagram</span>
TypeConverter <span class="token arrow operator">&lt;|--</span> SimpleTypeConverter
TypeConverter <span class="token arrow operator">&lt;|--</span> BeanWrapperImpl
TypeConverter <span class="token arrow operator">&lt;|--</span> DirectFieldAccessor
TypeConverter <span class="token arrow operator">&lt;|--</span> ServletRequestDataBinder

SimpleTypeConverter <span class="token arrow operator">--&gt;</span> TypeConverterDelegate
BeanWrapperImpl <span class="token arrow operator">--&gt;</span> TypeConverterDelegate
DirectFieldAccessor <span class="token arrow operator">--&gt;</span> TypeConverterDelegate
ServletRequestDataBinder <span class="token arrow operator">--&gt;</span> TypeConverterDelegate

TypeConverterDelegate <span class="token arrow operator">--&gt;</span> ConversionService
TypeConverterDelegate <span class="token arrow operator">--&gt;</span> PropertyEditorRegistry

<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> TypeConverter
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> ConversionService
<span class="token annotation important">&lt;&lt;interface&gt;&gt;</span> PropertyEditorRegistry
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li>å®ƒä»¬éƒ½å®ç°äº† TypeConverter è¿™ä¸ªé«˜å±‚è½¬æ¢æ¥å£ï¼Œåœ¨è½¬æ¢æ—¶ï¼Œä¼šç”¨åˆ° TypeConverter Delegate å§”æ´¾ConversionService ä¸ PropertyEditorRegistry çœŸæ­£æ‰§è¡Œè½¬æ¢ï¼ˆFacade é—¨é¢æ¨¡å¼ï¼‰
<ul><li>é¦–å…ˆçœ‹æ˜¯å¦æœ‰è‡ªå®šä¹‰è½¬æ¢å™¨, @InitBinder æ·»åŠ çš„å³å±äºè¿™ç§ (ç”¨äº†é€‚é…å™¨æ¨¡å¼æŠŠ Formatter è½¬ä¸ºéœ€è¦çš„ PropertyEditor)</li> <li>å†çœ‹æœ‰æ²¡æœ‰ ConversionService è½¬æ¢</li> <li>å†åˆ©ç”¨é»˜è®¤çš„ PropertyEditor è½¬æ¢</li> <li>æœ€åæœ‰ä¸€äº›ç‰¹æ®Šå¤„ç†</li></ul></li> <li>SimpleTypeConverter ä»…åšç±»å‹è½¬æ¢</li> <li>BeanWrapperImpl ä¸º bean çš„å±æ€§èµ‹å€¼ï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œèµ° Property</li> <li>DirectFieldAccessor ä¸º bean çš„å±æ€§èµ‹å€¼ï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œèµ° Field</li> <li>ServletRequestDataBinder ä¸º bean çš„å±æ€§æ‰§è¡Œç»‘å®šï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œæ ¹æ® directFieldAccess é€‰æ‹©èµ° Property è¿˜æ˜¯ Fieldï¼Œå…·å¤‡æ ¡éªŒä¸è·å–æ ¡éªŒç»“æœåŠŸèƒ½</li></ul> <h4 id="æ¼”ç¤º1-ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š"><a href="#æ¼”ç¤º1-ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š" class="header-anchor">#</a> æ¼”ç¤º1 - ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š</h4> <h5 id="ä»£ç å‚è€ƒ-31"><a href="#ä»£ç å‚è€ƒ-31" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a23</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-36"><a href="#æ”¶è·ğŸ’¡-36" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>åŸºæœ¬çš„ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®šç”¨æ³•</p> <ul><li>SimpleTypeConverter</li> <li>BeanWrapperImpl</li> <li>DirectFieldAccessor</li> <li>ServletRequestDataBinder</li></ul> <h4 id="æ¼”ç¤º2-æ•°æ®ç»‘å®šå·¥å‚"><a href="#æ¼”ç¤º2-æ•°æ®ç»‘å®šå·¥å‚" class="header-anchor">#</a> æ¼”ç¤º2 - æ•°æ®ç»‘å®šå·¥å‚</h4> <h5 id="ä»£ç å‚è€ƒ-32"><a href="#ä»£ç å‚è€ƒ-32" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a23.TestServletDataBinderFactory</strong></p> <h4 id="æ”¶è·ğŸ’¡-37"><a href="#æ”¶è·ğŸ’¡-37" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>ServletRequestDataBinderFactory çš„ç”¨æ³•å’Œæ‰©å±•ç‚¹</p> <ol><li>å¯ä»¥è§£ææ§åˆ¶å™¨çš„ @InitBinder æ ‡æ³¨æ–¹æ³•ä½œä¸ºæ‰©å±•ç‚¹ï¼Œæ·»åŠ è‡ªå®šä¹‰è½¬æ¢å™¨
<ul><li>æ§åˆ¶å™¨ç§æœ‰èŒƒå›´</li></ul></li> <li>å¯ä»¥é€šè¿‡ ConfigurableWebBindingInitializer é…ç½® ConversionService ä½œä¸ºæ‰©å±•ç‚¹ï¼Œæ·»åŠ è‡ªå®šä¹‰è½¬æ¢å™¨
<ul><li>å…¬å…±èŒƒå›´</li></ul></li> <li>åŒæ—¶åŠ äº† @InitBinder å’Œ ConversionService çš„è½¬æ¢ä¼˜å…ˆçº§
<ol><li>ä¼˜å…ˆé‡‡ç”¨ @InitBinder çš„è½¬æ¢å™¨</li> <li>å…¶æ¬¡ä½¿ç”¨ ConversionService çš„è½¬æ¢å™¨</li> <li>ä½¿ç”¨é»˜è®¤è½¬æ¢å™¨</li> <li>ç‰¹æ®Šå¤„ç†ï¼ˆä¾‹å¦‚æœ‰å‚æ„é€ ï¼‰</li></ol></li></ol> <h4 id="æ¼”ç¤º3-è·å–æ³›å‹å‚æ•°"><a href="#æ¼”ç¤º3-è·å–æ³›å‹å‚æ•°" class="header-anchor">#</a> æ¼”ç¤º3 - è·å–æ³›å‹å‚æ•°</h4> <h5 id="ä»£ç å‚è€ƒ-33"><a href="#ä»£ç å‚è€ƒ-33" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a23.sub</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-38"><a href="#æ”¶è·ğŸ’¡-38" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>java api è·å–æ³›å‹å‚æ•°</li> <li>spring api è·å–æ³›å‹å‚æ•°</li></ol> <h3 id="_24-controlleradvice-ä¹‹-initbinder"><a href="#_24-controlleradvice-ä¹‹-initbinder" class="header-anchor">#</a> 24) @ControllerAdvice ä¹‹ @InitBinder</h3> <h4 id="æ¼”ç¤º-å‡†å¤‡-initbinder"><a href="#æ¼”ç¤º-å‡†å¤‡-initbinder" class="header-anchor">#</a> æ¼”ç¤º - å‡†å¤‡ @InitBinder</h4> <p><strong>å‡†å¤‡ @InitBinder</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">sequenceDiagram</span>
<span class="token keyword">participant</span> adapter as HandlerAdapter
<span class="token keyword">participant</span> bf as WebDataBinderFactory
<span class="token keyword">participant</span> mf as ModelFactory
<span class="token keyword">participant</span> ihm as ServletInvocableHandlerMethod
<span class="token keyword">participant</span> ar as ArgumentResolvers 
<span class="token keyword">participant</span> rh as ReturnValueHandlers
<span class="token keyword">participant</span> container as ModelAndViewContainer
<span class="token keyword">rect</span> rgb<span class="token text string">(200, 150, 255)</span>
adapter <span class="token arrow operator">-&gt;&gt;</span> +bf<span class="token operator">:</span> å‡†å¤‡ @InitBinder
bf <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
<span class="token keyword">end</span>
adapter <span class="token arrow operator">-&gt;&gt;</span> +mf<span class="token operator">:</span> å‡†å¤‡ @ModelAttribute
mf <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> æ·»åŠ Modelæ•°æ®
container <span class="token arrow operator">--&gt;&gt;</span> -mf<span class="token operator">:</span> 
mf <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 

adapter <span class="token arrow operator">-&gt;&gt;</span> +ihm<span class="token operator">:</span> invokeAndHandle
ihm <span class="token arrow operator">-&gt;&gt;</span> +ar<span class="token operator">:</span> è·å– args
ar <span class="token arrow operator">-&gt;&gt;</span> ar<span class="token operator">:</span> æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice
ar <span class="token arrow operator">-&gt;&gt;</span> container<span class="token operator">:</span> æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®
ar <span class="token arrow operator">--&gt;&gt;</span> -ihm<span class="token operator">:</span> args
ihm <span class="token arrow operator">-&gt;&gt;</span> ihm<span class="token operator">:</span> method.invoke<span class="token text string">(bean,args)</span> å¾—åˆ° returnValue
ihm <span class="token arrow operator">-&gt;&gt;</span> +rh<span class="token operator">:</span> å¤„ç† returnValue
rh <span class="token arrow operator">-&gt;&gt;</span> rh<span class="token operator">:</span> æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice
rh <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰
container <span class="token arrow operator">--&gt;&gt;</span> -rh<span class="token operator">:</span> 
rh <span class="token arrow operator">--&gt;&gt;</span> -ihm<span class="token operator">:</span> 
ihm <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
adapter <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> è·å– ModelAndView
container <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><ul><li>RequestMappingHandlerAdapter åœ¨å›¾ä¸­ç¼©å†™ä¸º HandlerAdapter</li> <li>HandlerMethodArgumentResolverComposite åœ¨å›¾ä¸­ç¼©å†™ä¸º ArgumentResolvers</li> <li>HandlerMethodReturnValueHandlerComposite åœ¨å›¾ä¸­ç¼©å†™ä¸º ReturnValueHandlers</li></ul> <h4 id="æ”¶è·ğŸ’¡-39"><a href="#æ”¶è·ğŸ’¡-39" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @InitBinder æ–¹æ³•</li> <li>RequestMappingHandlerAdapter ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œè§£ææ­¤ç±»çš„ @InitBinder æ–¹æ³•</li> <li>ä»¥ä¸Šä¸¤ç§ @InitBinder çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li> <li>æ§åˆ¶å™¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šç»¼åˆåˆ©ç”¨æœ¬ç±»çš„ @InitBinder æ–¹æ³•å’Œ @ControllerAdvice ä¸­çš„ @InitBinder æ–¹æ³•åˆ›å»ºç»‘å®šå·¥å‚</li></ol> <h3 id="_25-æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹"><a href="#_25-æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹" class="header-anchor">#</a> 25) æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹</h3> <h4 id="å›¾1"><a href="#å›¾1" class="header-anchor">#</a> å›¾1</h4> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">classDiagram</span>
<span class="token keyword">class</span> ServletInvocableHandlerMethod <span class="token punctuation">{</span>
    +invokeAndHandle<span class="token text string">(ServletWebRequest,ModelAndViewContainer)</span>
<span class="token punctuation">}</span>
HandlerMethod <span class="token arrow operator">&lt;|--</span> ServletInvocableHandlerMethod
HandlerMethod <span class="token arrow operator">o--</span> bean
HandlerMethod <span class="token arrow operator">o--</span> method
ServletInvocableHandlerMethod <span class="token arrow operator">o--</span> WebDataBinderFactory
ServletInvocableHandlerMethod <span class="token arrow operator">o--</span> ParameterNameDiscoverer
ServletInvocableHandlerMethod <span class="token arrow operator">o--</span> HandlerMethodArgumentResolverComposite
ServletInvocableHandlerMethod <span class="token arrow operator">o--</span> HandlerMethodReturnValueHandlerComposite
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>HandlerMethod éœ€è¦</p> <ul><li>bean å³æ˜¯å“ªä¸ª Controller</li> <li>method å³æ˜¯ Controller ä¸­çš„å“ªä¸ªæ–¹æ³•</li></ul> <p>ServletInvocableHandlerMethod éœ€è¦</p> <ul><li>WebDataBinderFactory è´Ÿè´£å¯¹è±¡ç»‘å®šã€ç±»å‹è½¬æ¢</li> <li>ParameterNameDiscoverer è´Ÿè´£å‚æ•°åè§£æ</li> <li>HandlerMethodArgumentResolverComposite è´Ÿè´£è§£æå‚æ•°</li> <li>HandlerMethodReturnValueHandlerComposite è´Ÿè´£å¤„ç†è¿”å›å€¼</li></ul> <h4 id="å›¾2"><a href="#å›¾2" class="header-anchor">#</a> å›¾2</h4> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">sequenceDiagram</span>
<span class="token keyword">participant</span> adapter as RequestMappingHandlerAdapter
<span class="token keyword">participant</span> bf as WebDataBinderFactory
<span class="token keyword">participant</span> mf as ModelFactory
<span class="token keyword">participant</span> container as ModelAndViewContainer
adapter <span class="token arrow operator">-&gt;&gt;</span> +bf<span class="token operator">:</span> å‡†å¤‡ @InitBinder
bf <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
adapter <span class="token arrow operator">-&gt;&gt;</span> +mf<span class="token operator">:</span> å‡†å¤‡ @ModelAttribute
mf <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> æ·»åŠ Modelæ•°æ®
container <span class="token arrow operator">--&gt;&gt;</span> -mf<span class="token operator">:</span> 
mf <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="å›¾3"><a href="#å›¾3" class="header-anchor">#</a> å›¾3</h4> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">sequenceDiagram</span>
<span class="token keyword">participant</span> adapter as RequestMappingHandlerAdapter
<span class="token keyword">participant</span> ihm as ServletInvocableHandlerMethod
<span class="token keyword">participant</span> ar as ArgumentResolvers
<span class="token keyword">participant</span> rh as ReturnValueHandlers
<span class="token keyword">participant</span> container as ModelAndViewContainer

adapter <span class="token arrow operator">-&gt;&gt;</span> +ihm<span class="token operator">:</span> invokeAndHandle
ihm <span class="token arrow operator">-&gt;&gt;</span> +ar<span class="token operator">:</span> è·å– args
ar <span class="token arrow operator">-&gt;&gt;</span> ar<span class="token operator">:</span> æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice
ar <span class="token arrow operator">-&gt;&gt;</span> container<span class="token operator">:</span> æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”Ÿæˆæ¨¡å‹æ•°æ®
container <span class="token arrow operator">--&gt;&gt;</span> ar<span class="token operator">:</span> 
ar <span class="token arrow operator">--&gt;&gt;</span> -ihm<span class="token operator">:</span> args
ihm <span class="token arrow operator">-&gt;&gt;</span> ihm<span class="token operator">:</span> method.invoke<span class="token text string">(bean,args)</span> å¾—åˆ° returnValue
ihm <span class="token arrow operator">-&gt;&gt;</span> +rh<span class="token operator">:</span> å¤„ç† returnValue
rh <span class="token arrow operator">-&gt;&gt;</span> rh<span class="token operator">:</span> æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice
rh <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰
container <span class="token arrow operator">--&gt;&gt;</span> -rh<span class="token operator">:</span> 
rh <span class="token arrow operator">--&gt;&gt;</span> -ihm<span class="token operator">:</span> 
ihm <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
adapter <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> è·å– ModelAndView
container <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_26-controlleradvice-ä¹‹-modelattribute"><a href="#_26-controlleradvice-ä¹‹-modelattribute" class="header-anchor">#</a> 26) @ControllerAdvice ä¹‹ @ModelAttribute</h3> <h4 id="æ¼”ç¤º-å‡†å¤‡-modelattribute"><a href="#æ¼”ç¤º-å‡†å¤‡-modelattribute" class="header-anchor">#</a> æ¼”ç¤º - å‡†å¤‡ @ModelAttribute</h4> <h5 id="ä»£ç å‚è€ƒ-34"><a href="#ä»£ç å‚è€ƒ-34" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a26</strong> åŒ…</p> <p><strong>å‡†å¤‡ @ModelAttribute</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">sequenceDiagram</span>
<span class="token keyword">participant</span> adapter as HandlerAdapter
<span class="token keyword">participant</span> bf as WebDataBinderFactory
<span class="token keyword">participant</span> mf as ModelFactory
<span class="token keyword">participant</span> ihm as ServletInvocableHandlerMethod
<span class="token keyword">participant</span> ar as ArgumentResolvers 
<span class="token keyword">participant</span> rh as ReturnValueHandlers
<span class="token keyword">participant</span> container as ModelAndViewContainer

adapter <span class="token arrow operator">-&gt;&gt;</span> +bf<span class="token operator">:</span> å‡†å¤‡ @InitBinder
bf <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
<span class="token keyword">rect</span> rgb<span class="token text string">(200, 150, 255)</span>
adapter <span class="token arrow operator">-&gt;&gt;</span> +mf<span class="token operator">:</span> å‡†å¤‡ @ModelAttribute
mf <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> æ·»åŠ Modelæ•°æ®
container <span class="token arrow operator">--&gt;&gt;</span> -mf<span class="token operator">:</span> 
mf <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
<span class="token keyword">end</span>
adapter <span class="token arrow operator">-&gt;&gt;</span> +ihm<span class="token operator">:</span> invokeAndHandle
ihm <span class="token arrow operator">-&gt;&gt;</span> +ar<span class="token operator">:</span> è·å– args
ar <span class="token arrow operator">-&gt;&gt;</span> ar<span class="token operator">:</span> æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice
ar <span class="token arrow operator">-&gt;&gt;</span> container<span class="token operator">:</span> æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®
ar <span class="token arrow operator">--&gt;&gt;</span> -ihm<span class="token operator">:</span> args
ihm <span class="token arrow operator">-&gt;&gt;</span> ihm<span class="token operator">:</span> method.invoke<span class="token text string">(bean,args)</span> å¾—åˆ° returnValue
ihm <span class="token arrow operator">-&gt;&gt;</span> +rh<span class="token operator">:</span> å¤„ç† returnValue
rh <span class="token arrow operator">-&gt;&gt;</span> rh<span class="token operator">:</span> æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice
rh <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰
container <span class="token arrow operator">--&gt;&gt;</span> -rh<span class="token operator">:</span> 
rh <span class="token arrow operator">--&gt;&gt;</span> -ihm<span class="token operator">:</span> 
ihm <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
adapter <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> è·å– ModelAndView
container <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-40"><a href="#æ”¶è·ğŸ’¡-40" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @ModelAttribute æ–¹æ³•</li> <li>RequestMappingHandlerAdapter ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œè§£ææ­¤ç±»çš„ @ModelAttribute æ–¹æ³•</li> <li>ä»¥ä¸Šä¸¤ç§ @ModelAttribute çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li> <li>æ§åˆ¶å™¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šç»¼åˆåˆ©ç”¨æœ¬ç±»çš„ @ModelAttribute æ–¹æ³•å’Œ @ControllerAdvice ä¸­çš„ @ModelAttribute æ–¹æ³•åˆ›å»ºæ¨¡å‹å·¥å‚</li></ol> <h3 id="_27-è¿”å›å€¼å¤„ç†å™¨"><a href="#_27-è¿”å›å€¼å¤„ç†å™¨" class="header-anchor">#</a> 27) è¿”å›å€¼å¤„ç†å™¨</h3> <h4 id="æ¼”ç¤º-å¸¸è§è¿”å›å€¼å¤„ç†å™¨"><a href="#æ¼”ç¤º-å¸¸è§è¿”å›å€¼å¤„ç†å™¨" class="header-anchor">#</a> æ¼”ç¤º - å¸¸è§è¿”å›å€¼å¤„ç†å™¨</h4> <h5 id="ä»£ç å‚è€ƒ-35"><a href="#ä»£ç å‚è€ƒ-35" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a27</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-41"><a href="#æ”¶è·ğŸ’¡-41" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å¸¸è§çš„è¿”å›å€¼å¤„ç†å™¨
<ul><li>ModelAndViewï¼Œåˆ†åˆ«è·å–å…¶æ¨¡å‹å’Œè§†å›¾åï¼Œæ”¾å…¥ ModelAndViewContainer</li> <li>è¿”å›å€¼ç±»å‹ä¸º String æ—¶ï¼ŒæŠŠå®ƒå½“åšè§†å›¾åï¼Œæ”¾å…¥ ModelAndViewContainer</li> <li>è¿”å›å€¼æ·»åŠ äº† @ModelAttribute æ³¨è§£æ—¶ï¼Œå°†è¿”å›å€¼ä½œä¸ºæ¨¡å‹ï¼Œæ”¾å…¥ ModelAndViewContainer
<ul><li>æ­¤æ—¶éœ€æ‰¾åˆ°é»˜è®¤è§†å›¾å</li></ul></li> <li>è¿”å›å€¼çœç•¥ @ModelAttribute æ³¨è§£ä¸”è¿”å›éç®€å•ç±»å‹æ—¶ï¼Œå°†è¿”å›å€¼ä½œä¸ºæ¨¡å‹ï¼Œæ”¾å…¥ ModelAndViewContainer
<ul><li>æ­¤æ—¶éœ€æ‰¾åˆ°é»˜è®¤è§†å›¾å</li></ul></li> <li>è¿”å›å€¼ç±»å‹ä¸º ResponseEntity æ—¶
<ul><li>æ­¤æ—¶èµ° MessageConverterï¼Œå¹¶è®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li></ul></li> <li>è¿”å›å€¼ç±»å‹ä¸º HttpHeaders æ—¶
<ul><li>ä¼šè®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li></ul></li> <li>è¿”å›å€¼æ·»åŠ äº† @ResponseBody æ³¨è§£æ—¶
<ul><li>æ­¤æ—¶èµ° MessageConverterï¼Œå¹¶è®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li></ul></li></ul></li> <li>ç»„åˆæ¨¡å¼åœ¨ Spring ä¸­çš„ä½“ç° + 1</li></ol> <h3 id="_28-messageconverter"><a href="#_28-messageconverter" class="header-anchor">#</a> 28) MessageConverter</h3> <h4 id="æ¼”ç¤º-messageconverter-çš„ä½œç”¨"><a href="#æ¼”ç¤º-messageconverter-çš„ä½œç”¨" class="header-anchor">#</a> æ¼”ç¤º - MessageConverter çš„ä½œç”¨</h4> <h5 id="ä»£ç å‚è€ƒ-36"><a href="#ä»£ç å‚è€ƒ-36" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a28.A28</strong></p> <h4 id="æ”¶è·ğŸ’¡-42"><a href="#æ”¶è·ğŸ’¡-42" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>MessageConverter çš„ä½œç”¨
<ul><li>@ResponseBody æ˜¯è¿”å›å€¼å¤„ç†å™¨è§£æçš„</li> <li>ä½†å…·ä½“è½¬æ¢å·¥ä½œæ˜¯ MessageConverter åšçš„</li></ul></li> <li>å¦‚ä½•é€‰æ‹© MediaType
<ul><li>é¦–å…ˆçœ‹ @RequestMapping ä¸Šæœ‰æ²¡æœ‰æŒ‡å®š</li> <li>å…¶æ¬¡çœ‹ request çš„ Accept å¤´æœ‰æ²¡æœ‰æŒ‡å®š</li> <li>æœ€åæŒ‰ MessageConverter çš„é¡ºåº, è°èƒ½è°å…ˆè½¬æ¢</li></ul></li></ol> <h3 id="_29-controlleradvice-ä¹‹-responsebodyadvice"><a href="#_29-controlleradvice-ä¹‹-responsebodyadvice" class="header-anchor">#</a> 29) @ControllerAdvice ä¹‹ ResponseBodyAdvice</h3> <h4 id="æ¼”ç¤º-responsebodyadvice-å¢å¼º"><a href="#æ¼”ç¤º-responsebodyadvice-å¢å¼º" class="header-anchor">#</a> æ¼”ç¤º - ResponseBodyAdvice å¢å¼º</h4> <h5 id="ä»£ç å‚è€ƒ-37"><a href="#ä»£ç å‚è€ƒ-37" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a29</strong> åŒ…</p> <p><strong>ResponseBodyAdvice å¢å¼º</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">sequenceDiagram</span>
<span class="token keyword">participant</span> adapter as HandlerAdapter
<span class="token keyword">participant</span> bf as WebDataBinderFactory
<span class="token keyword">participant</span> mf as ModelFactory
<span class="token keyword">participant</span> ihm as ServletInvocableHandlerMethod
<span class="token keyword">participant</span> ar as ArgumentResolvers 
<span class="token keyword">participant</span> rh as ReturnValueHandlers
<span class="token keyword">participant</span> container as ModelAndViewContainer

adapter <span class="token arrow operator">-&gt;&gt;</span> +bf<span class="token operator">:</span> å‡†å¤‡ @InitBinder
bf <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
adapter <span class="token arrow operator">-&gt;&gt;</span> +mf<span class="token operator">:</span> å‡†å¤‡ @ModelAttribute
mf <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> æ·»åŠ Modelæ•°æ®
container <span class="token arrow operator">--&gt;&gt;</span> -mf<span class="token operator">:</span> 
mf <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
adapter <span class="token arrow operator">-&gt;&gt;</span> +ihm<span class="token operator">:</span> invokeAndHandle
ihm <span class="token arrow operator">-&gt;&gt;</span> +ar<span class="token operator">:</span> è·å– args
ar <span class="token arrow operator">-&gt;&gt;</span> ar<span class="token operator">:</span> æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice
ar <span class="token arrow operator">-&gt;&gt;</span> container<span class="token operator">:</span> æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®
ar <span class="token arrow operator">--&gt;&gt;</span> -ihm<span class="token operator">:</span> args
ihm <span class="token arrow operator">-&gt;&gt;</span> ihm<span class="token operator">:</span> method.invoke<span class="token text string">(bean,args)</span> å¾—åˆ° returnValue
ihm <span class="token arrow operator">-&gt;&gt;</span> +rh<span class="token operator">:</span> å¤„ç† returnValue
<span class="token keyword">rect</span> rgb<span class="token text string">(200, 150, 255)</span>
rh <span class="token arrow operator">-&gt;&gt;</span> rh<span class="token operator">:</span> æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice
<span class="token keyword">end</span>
rh <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰
container <span class="token arrow operator">--&gt;&gt;</span> -rh<span class="token operator">:</span> 
rh <span class="token arrow operator">--&gt;&gt;</span> -ihm<span class="token operator">:</span> 
ihm <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
adapter <span class="token arrow operator">-&gt;&gt;</span> +container<span class="token operator">:</span> è·å– ModelAndView
container <span class="token arrow operator">--&gt;&gt;</span> -adapter<span class="token operator">:</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-43"><a href="#æ”¶è·ğŸ’¡-43" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>ResponseBodyAdvice è¿”å›å“åº”ä½“å‰åŒ…è£…</li></ol> <h3 id="_30-å¼‚å¸¸è§£æå™¨"><a href="#_30-å¼‚å¸¸è§£æå™¨" class="header-anchor">#</a> 30) å¼‚å¸¸è§£æå™¨</h3> <h4 id="æ¼”ç¤º-exceptionhandlerexceptionresolver"><a href="#æ¼”ç¤º-exceptionhandlerexceptionresolver" class="header-anchor">#</a> æ¼”ç¤º - ExceptionHandlerExceptionResolver</h4> <h5 id="ä»£ç å‚è€ƒ-38"><a href="#ä»£ç å‚è€ƒ-38" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a30.A30</strong></p> <h4 id="æ”¶è·ğŸ’¡-44"><a href="#æ”¶è·ğŸ’¡-44" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å®ƒèƒ½å¤Ÿé‡ç”¨å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ï¼Œå®ç°ç»„ä»¶é‡ç”¨</li> <li>å®ƒèƒ½å¤Ÿæ”¯æŒåµŒå¥—å¼‚å¸¸</li></ol> <h3 id="_31-controlleradvice-ä¹‹-exceptionhandler"><a href="#_31-controlleradvice-ä¹‹-exceptionhandler" class="header-anchor">#</a> 31) @ControllerAdvice ä¹‹ @ExceptionHandler</h3> <h4 id="æ¼”ç¤º-å‡†å¤‡-exceptionhandler"><a href="#æ¼”ç¤º-å‡†å¤‡-exceptionhandler" class="header-anchor">#</a> æ¼”ç¤º - å‡†å¤‡ @ExceptionHandler</h4> <h5 id="ä»£ç å‚è€ƒ-39"><a href="#ä»£ç å‚è€ƒ-39" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a31</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-45"><a href="#æ”¶è·ğŸ’¡-45" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>ExceptionHandlerExceptionResolver åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @ExceptionHandler æ–¹æ³•</li> <li>ExceptionHandlerExceptionResolver ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡å¤„ç†å¼‚å¸¸æ—¶ï¼Œè§£ææ­¤ç±»çš„ @ExceptionHandler æ–¹æ³•</li> <li>ä»¥ä¸Šä¸¤ç§ @ExceptionHandler çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li></ol> <h3 id="_32-tomcat-å¼‚å¸¸å¤„ç†"><a href="#_32-tomcat-å¼‚å¸¸å¤„ç†" class="header-anchor">#</a> 32) Tomcat å¼‚å¸¸å¤„ç†</h3> <ul><li><p>æˆ‘ä»¬çŸ¥é“ @ExceptionHandler åªèƒ½å¤„ç†å‘ç”Ÿåœ¨ mvc æµç¨‹ä¸­çš„å¼‚å¸¸ï¼Œä¾‹å¦‚æ§åˆ¶å™¨å†…ã€æ‹¦æˆªå™¨å†…ï¼Œé‚£ä¹ˆå¦‚æœæ˜¯ Filter å‡ºç°äº†å¼‚å¸¸ï¼Œå¦‚ä½•è¿›è¡Œå¤„ç†å‘¢ï¼Ÿ</p></li> <li><p>åœ¨ Spring Boot ä¸­ï¼Œæ˜¯è¿™ä¹ˆå®ç°çš„ï¼š</p> <ol><li>å› ä¸ºå†…åµŒäº† Tomcat å®¹å™¨ï¼Œå› æ­¤å¯ä»¥é…ç½® Tomcat çš„é”™è¯¯é¡µé¢ï¼ŒFilter ä¸ é”™è¯¯é¡µé¢ä¹‹é—´æ˜¯é€šè¿‡è¯·æ±‚è½¬å‘è·³è½¬çš„ï¼Œå¯ä»¥åœ¨è¿™é‡Œåšæ‰‹è„š</li> <li>å…ˆé€šè¿‡ ErrorPageRegistrarBeanPostProcessor è¿™ä¸ªåå¤„ç†å™¨é…ç½®é”™è¯¯é¡µé¢åœ°å€ï¼Œé»˜è®¤ä¸º <code>/error</code> ä¹Ÿå¯ä»¥é€šè¿‡ <code>${server.error.path}</code> è¿›è¡Œé…ç½®</li> <li>å½“ Filter å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¸ä¼šèµ° Spring æµç¨‹ï¼Œä½†ä¼šèµ° Tomcat çš„é”™è¯¯å¤„ç†ï¼Œäºæ˜¯å°±å¸Œæœ›è½¬å‘è‡³ <code>/error</code> è¿™ä¸ªåœ°å€
<ul><li>å½“ç„¶ï¼Œå¦‚æœæ²¡æœ‰ @ExceptionHandlerï¼Œé‚£ä¹ˆæœ€ç»ˆä¹Ÿä¼šèµ°åˆ° Tomcat çš„é”™è¯¯å¤„ç†</li></ul></li> <li>Spring Boot åˆæä¾›äº†ä¸€ä¸ª BasicErrorControllerï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ ‡å‡† @Controllerï¼Œ@RequestMapping é…ç½®ä¸º <code>/error</code>ï¼Œæ‰€ä»¥å¤„ç†å¼‚å¸¸çš„èŒè´£å°±åˆå›åˆ°äº† Spring</li> <li>å¼‚å¸¸ä¿¡æ¯ç”±äºä¼šè¢« Tomcat æ”¾å…¥ request ä½œç”¨åŸŸï¼Œå› æ­¤ BasicErrorController é‡Œä¹Ÿèƒ½è·å–åˆ°</li> <li>å…·ä½“å¼‚å¸¸ä¿¡æ¯ä¼šç”± DefaultErrorAttributes å°è£…å¥½</li> <li>BasicErrorController é€šè¿‡ Accept å¤´åˆ¤æ–­éœ€è¦ç”Ÿæˆå“ªç§ MediaType çš„å“åº”
<ul><li>å¦‚æœè¦çš„ä¸æ˜¯ text/htmlï¼Œèµ° MessageConverter æµç¨‹</li> <li>å¦‚æœéœ€è¦ text/htmlï¼Œèµ° mvc æµç¨‹ï¼Œæ­¤æ—¶åˆåˆ†ä¸¤ç§æƒ…å†µ
<ul><li>é…ç½®äº† ErrorViewResolverï¼Œæ ¹æ®çŠ¶æ€ç å»æ‰¾ View</li> <li>æ²¡é…ç½®æˆ–æ²¡æ‰¾åˆ°ï¼Œç”¨ BeanNameViewResolver æ ¹æ®ä¸€ä¸ªå›ºå®šä¸º error çš„åå­—æ‰¾åˆ° Viewï¼Œå³æ‰€è°“çš„ WhitelabelErrorView</li></ul></li></ul></li></ol></li></ul> <blockquote><p><em><strong>è¯„ä»·</strong></em></p> <ul><li>ä¸€ä¸ªé”™è¯¯å¤„ç†æå¾—è¿™ä¹ˆå¤æ‚ï¼Œå°±é—®æ¶å¿ƒä¸ï¼Ÿ</li></ul></blockquote> <h4 id="æ¼”ç¤º1-é”™è¯¯é¡µå¤„ç†"><a href="#æ¼”ç¤º1-é”™è¯¯é¡µå¤„ç†" class="header-anchor">#</a> æ¼”ç¤º1 - é”™è¯¯é¡µå¤„ç†</h4> <h5 id="å…³é”®ä»£ç -2"><a href="#å…³é”®ä»£ç -2" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span> <span class="token comment">// â¬…ï¸ä¿®æ”¹äº† Tomcat æœåŠ¡å™¨é»˜è®¤é”™è¯¯åœ°å€, å‡ºé”™æ—¶ä½¿ç”¨è¯·æ±‚è½¬å‘æ–¹å¼è·³è½¬</span>
<span class="token keyword">public</span> <span class="token class-name">ErrorPageRegistrar</span> <span class="token function">errorPageRegistrar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> webServerFactory <span class="token operator">-&gt;</span> webServerFactory<span class="token punctuation">.</span><span class="token function">addErrorPages</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ErrorPage</span><span class="token punctuation">(</span><span class="token string">&quot;/error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span> <span class="token comment">// â¬…ï¸TomcatServletWebServerFactory åˆå§‹åŒ–å‰ç”¨å®ƒå¢å¼º, æ³¨å†Œæ‰€æœ‰ ErrorPageRegistrar</span>
<span class="token keyword">public</span> <span class="token class-name">ErrorPageRegistrarBeanPostProcessor</span> <span class="token function">errorPageRegistrarBeanPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ErrorPageRegistrarBeanPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-46"><a href="#æ”¶è·ğŸ’¡-46" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>Tomcat çš„é”™è¯¯é¡µå¤„ç†æ‰‹æ®µ</li></ol> <h4 id="æ¼”ç¤º2-basicerrorcontroller"><a href="#æ¼”ç¤º2-basicerrorcontroller" class="header-anchor">#</a> æ¼”ç¤º2 - BasicErrorController</h4> <h5 id="å…³é”®ä»£ç -3"><a href="#å…³é”®ä»£ç -3" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span> <span class="token comment">// â¬…ï¸ErrorProperties å°è£…ç¯å¢ƒé”®å€¼, ErrorAttributes æ§åˆ¶æœ‰å“ªäº›é”™è¯¯ä¿¡æ¯</span>
<span class="token keyword">public</span> <span class="token class-name">BasicErrorController</span> <span class="token function">basicErrorController</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ErrorProperties</span> errorProperties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ErrorProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    errorProperties<span class="token punctuation">.</span><span class="token function">setIncludeException</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BasicErrorController</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultErrorAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> errorProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span> <span class="token comment">// â¬…ï¸åç§°ä¸º error çš„è§†å›¾, ä½œä¸º BasicErrorController çš„ text/html å“åº”ç»“æœ</span>
<span class="token keyword">public</span> <span class="token class-name">View</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">View</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">render</span><span class="token punctuation">(</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">&gt;</span></span> model<span class="token punctuation">,</span> 
            <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
            <span class="token class-name">HttpServletResponse</span> response
        <span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;text/html;charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
                    &lt;h3&gt;æœåŠ¡å™¨å†…éƒ¨é”™è¯¯&lt;/h3&gt;
                    &quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span> <span class="token comment">// â¬…ï¸æ”¶é›†å®¹å™¨ä¸­æ‰€æœ‰ View å¯¹è±¡, bean çš„åå­—ä½œä¸ºè§†å›¾å</span>
<span class="token keyword">public</span> <span class="token class-name">ViewResolver</span> <span class="token function">viewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BeanNameViewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-47"><a href="#æ”¶è·ğŸ’¡-47" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>Spring Boot ä¸­ BasicErrorController å¦‚ä½•å·¥ä½œ</li></ol> <h3 id="_33-beannameurlhandlermapping-ä¸-simplecontrollerhandleradapter"><a href="#_33-beannameurlhandlermapping-ä¸-simplecontrollerhandleradapter" class="header-anchor">#</a> 33) BeanNameUrlHandlerMapping ä¸ SimpleControllerHandlerAdapter</h3> <h4 id="æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"><a href="#æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨" class="header-anchor">#</a> æ¼”ç¤º - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</h4> <h5 id="å…³é”®ä»£ç -4"><a href="#å…³é”®ä»£ç -4" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">BeanNameUrlHandlerMapping</span> <span class="token function">beanNameUrlHandlerMapping</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BeanNameUrlHandlerMapping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">SimpleControllerHandlerAdapter</span> <span class="token function">simpleControllerHandlerAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleControllerHandlerAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;/c3&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Controller</span> <span class="token function">controller3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;this is c3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-48"><a href="#æ”¶è·ğŸ’¡-48" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>BeanNameUrlHandlerMappingï¼Œä»¥ / å¼€å¤´çš„ bean çš„åå­—ä¼šè¢«å½“ä½œæ˜ å°„è·¯å¾„</li> <li>è¿™äº› bean æœ¬èº«å½“ä½œ handlerï¼Œè¦æ±‚å®ç° Controller æ¥å£</li> <li>SimpleControllerHandlerAdapterï¼Œè°ƒç”¨ handler</li> <li>æ¨¡æ‹Ÿå®ç°è¿™ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</li></ol> <h3 id="_34-routerfunctionmapping-ä¸-handlerfunctionadapter"><a href="#_34-routerfunctionmapping-ä¸-handlerfunctionadapter" class="header-anchor">#</a> 34) RouterFunctionMapping ä¸ HandlerFunctionAdapter</h3> <h4 id="æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨-2"><a href="#æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨-2" class="header-anchor">#</a> æ¼”ç¤º - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</h4> <h5 id="å…³é”®ä»£ç -5"><a href="#å…³é”®ä»£ç -5" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">RouterFunctionMapping</span> <span class="token function">routerFunctionMapping</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RouterFunctionMapping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">HandlerFunctionAdapter</span> <span class="token function">handlerFunctionAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HandlerFunctionAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">RouterFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServerResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">r1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//           â¬‡ï¸æ˜ å°„æ¡ä»¶   â¬‡ï¸handler</span>
    <span class="token keyword">return</span> <span class="token function">route</span><span class="token punctuation">(</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/r1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request <span class="token operator">-&gt;</span> <span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">&quot;this is r1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-49"><a href="#æ”¶è·ğŸ’¡-49" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>RouterFunctionMapping, é€šè¿‡ RequestPredicate æ¡ä»¶æ˜ å°„</li> <li>handler è¦å®ç° HandlerFunction æ¥å£</li> <li>HandlerFunctionAdapter, è°ƒç”¨ handler</li></ol> <h3 id="_35-simpleurlhandlermapping-ä¸-httprequesthandleradapter"><a href="#_35-simpleurlhandlermapping-ä¸-httprequesthandleradapter" class="header-anchor">#</a> 35) SimpleUrlHandlerMapping ä¸ HttpRequestHandlerAdapter</h3> <h4 id="æ¼”ç¤º1-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"><a href="#æ¼”ç¤º1-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨" class="header-anchor">#</a> æ¼”ç¤º1 - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</h4> <h5 id="ä»£ç å‚è€ƒ-40"><a href="#ä»£ç å‚è€ƒ-40" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>org.springframework.boot.autoconfigure.web.servlet.A35</strong></p> <h5 id="å…³é”®ä»£ç -6"><a href="#å…³é”®ä»£ç -6" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">SimpleUrlHandlerMapping</span> <span class="token function">simpleUrlHandlerMapping</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">SimpleUrlHandlerMapping</span> handlerMapping <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleUrlHandlerMapping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ResourceHttpRequestHandler</span><span class="token punctuation">&gt;</span></span> map 
        <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBeansOfType</span><span class="token punctuation">(</span><span class="token class-name">ResourceHttpRequestHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    handlerMapping<span class="token punctuation">.</span><span class="token function">setUrlMap</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> handlerMapping<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">HttpRequestHandlerAdapter</span> <span class="token function">httpRequestHandlerAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HttpRequestHandlerAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResourceHttpRequestHandler</span> <span class="token function">handler1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ResourceHttpRequestHandler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceHttpRequestHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    handler<span class="token punctuation">.</span><span class="token function">setLocations</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;static/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> handler<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;/img/**&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResourceHttpRequestHandler</span> <span class="token function">handler2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ResourceHttpRequestHandler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceHttpRequestHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    handler<span class="token punctuation">.</span><span class="token function">setLocations</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;images/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> handler<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-50"><a href="#æ”¶è·ğŸ’¡-50" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>SimpleUrlHandlerMapping ä¸ä¼šåœ¨åˆå§‹åŒ–æ—¶æ”¶é›†æ˜ å°„ä¿¡æ¯ï¼Œéœ€è¦æ‰‹åŠ¨æ”¶é›†</li> <li>SimpleUrlHandlerMapping æ˜ å°„è·¯å¾„</li> <li>ResourceHttpRequestHandler ä½œä¸ºé™æ€èµ„æº handler</li> <li>HttpRequestHandlerAdapter, è°ƒç”¨æ­¤ handler</li></ol> <h4 id="æ¼”ç¤º2-é™æ€èµ„æºè§£æä¼˜åŒ–"><a href="#æ¼”ç¤º2-é™æ€èµ„æºè§£æä¼˜åŒ–" class="header-anchor">#</a> æ¼”ç¤º2 - é™æ€èµ„æºè§£æä¼˜åŒ–</h4> <h5 id="å…³é”®ä»£ç -7"><a href="#å…³é”®ä»£ç -7" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResourceHttpRequestHandler</span> <span class="token function">handler1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ResourceHttpRequestHandler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceHttpRequestHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    handler<span class="token punctuation">.</span><span class="token function">setLocations</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;static/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    handler<span class="token punctuation">.</span><span class="token function">setResourceResolvers</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
            <span class="token comment">// â¬‡ï¸ç¼“å­˜ä¼˜åŒ–</span>
            <span class="token keyword">new</span> <span class="token class-name">CachingResourceResolver</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ConcurrentMapCache</span><span class="token punctuation">(</span><span class="token string">&quot;cache1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// â¬‡ï¸å‹ç¼©ä¼˜åŒ–</span>
            <span class="token keyword">new</span> <span class="token class-name">EncodedResourceResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// â¬‡ï¸åŸå§‹èµ„æºè§£æ</span>
            <span class="token keyword">new</span> <span class="token class-name">PathResourceResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> handler<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-51"><a href="#æ”¶è·ğŸ’¡-51" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>è´£ä»»é“¾æ¨¡å¼ä½“ç°</li> <li>å‹ç¼©æ–‡ä»¶éœ€è¦æ‰‹åŠ¨ç”Ÿæˆ</li></ol> <h4 id="æ¼”ç¤º3-æ¬¢è¿é¡µ"><a href="#æ¼”ç¤º3-æ¬¢è¿é¡µ" class="header-anchor">#</a> æ¼”ç¤º3 - æ¬¢è¿é¡µ</h4> <h5 id="å…³é”®ä»£ç -8"><a href="#å…³é”®ä»£ç -8" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">WelcomePageHandlerMapping</span> <span class="token function">welcomePageHandlerMapping</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Resource</span> resource <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:static/index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WelcomePageHandlerMapping</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> context<span class="token punctuation">,</span> resource<span class="token punctuation">,</span> <span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">SimpleControllerHandlerAdapter</span> <span class="token function">simpleControllerHandlerAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleControllerHandlerAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-52"><a href="#æ”¶è·ğŸ’¡-52" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>æ¬¢è¿é¡µæ”¯æŒé™æ€æ¬¢è¿é¡µä¸åŠ¨æ€æ¬¢è¿é¡µ</li> <li>WelcomePageHandlerMapping æ˜ å°„æ¬¢è¿é¡µï¼ˆå³åªæ˜ å°„ '/'ï¼‰
<ul><li>å®ƒå†…ç½®çš„ handler ParameterizableViewController ä½œç”¨æ˜¯ä¸æ‰§è¡Œé€»è¾‘ï¼Œä»…æ ¹æ®è§†å›¾åæ‰¾è§†å›¾</li> <li>è§†å›¾åå›ºå®šä¸º forward:index.html</li></ul></li> <li>SimpleControllerHandlerAdapter, è°ƒç”¨ handler
<ul><li>è½¬å‘è‡³ /index.html</li> <li>å¤„ç† /index.html åˆä¼šèµ°ä¸Šé¢çš„é™æ€èµ„æºå¤„ç†æµç¨‹</li></ul></li></ol> <h4 id="æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“"><a href="#æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“" class="header-anchor">#</a> æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“</h4> <ol><li>HandlerMapping è´Ÿè´£å»ºç«‹è¯·æ±‚ä¸æ§åˆ¶å™¨ä¹‹é—´çš„æ˜ å°„å…³ç³»
<ul><li>RequestMappingHandlerMapping (ä¸ @RequestMapping åŒ¹é…)</li> <li>WelcomePageHandlerMapping    (/)</li> <li>BeanNameUrlHandlerMapping    (ä¸ bean çš„åå­—åŒ¹é… ä»¥ / å¼€å¤´)</li> <li>RouterFunctionMapping        (å‡½æ•°å¼ RequestPredicate, HandlerFunction)</li> <li>SimpleUrlHandlerMapping      (é™æ€èµ„æº é€šé…ç¬¦ /** /img/**)</li> <li>ä¹‹é—´ä¹Ÿä¼šæœ‰é¡ºåºé—®é¢˜, boot ä¸­é»˜è®¤é¡ºåºå¦‚ä¸Š</li></ul></li> <li>HandlerAdapter è´Ÿè´£å®ç°å¯¹å„ç§å„æ ·çš„ handler çš„é€‚é…è°ƒç”¨
<ul><li>RequestMappingHandlerAdapter å¤„ç†ï¼š@RequestMapping æ–¹æ³•
<ul><li>å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ä½“ç°äº†ç»„åˆæ¨¡å¼</li></ul></li> <li>SimpleControllerHandlerAdapter å¤„ç†ï¼šController æ¥å£</li> <li>HandlerFunctionAdapter å¤„ç†ï¼šHandlerFunction å‡½æ•°å¼æ¥å£</li> <li>HttpRequestHandlerAdapter å¤„ç†ï¼šHttpRequestHandler æ¥å£ (é™æ€èµ„æºå¤„ç†)</li> <li>è¿™ä¹Ÿæ˜¯å…¸å‹é€‚é…å™¨æ¨¡å¼ä½“ç°</li></ul></li></ol> <h3 id="_36-mvc-å¤„ç†æµç¨‹"><a href="#_36-mvc-å¤„ç†æµç¨‹" class="header-anchor">#</a> 36) mvc å¤„ç†æµç¨‹</h3> <p>å½“æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚ <code>http://localhost:8080/hello</code> åï¼Œè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼Œå…¶å¤„ç†æµç¨‹æ˜¯ï¼š</p> <ol><li><p>æœåŠ¡å™¨æä¾›äº† DispatcherServletï¼Œå®ƒä½¿ç”¨çš„æ˜¯æ ‡å‡† Servlet æŠ€æœ¯</p> <ul><li>è·¯å¾„ï¼šé»˜è®¤æ˜ å°„è·¯å¾„ä¸º <code>/</code>ï¼Œå³ä¼šåŒ¹é…åˆ°æ‰€æœ‰è¯·æ±‚ URLï¼Œå¯ä½œä¸ºè¯·æ±‚çš„ç»Ÿä¸€å…¥å£ï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸º<strong>å‰æ§åˆ¶å™¨</strong> <ul><li>jsp ä¸ä¼šåŒ¹é…åˆ° DispatcherServlet</li> <li>å…¶å®ƒæœ‰è·¯å¾„çš„ Servlet åŒ¹é…ä¼˜å…ˆçº§ä¹Ÿé«˜äº DispatcherServlet</li></ul></li> <li>åˆ›å»ºï¼šåœ¨ Boot ä¸­ï¼Œç”± DispatcherServletAutoConfiguration è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æä¾› DispatcherServlet çš„ bean</li> <li>åˆå§‹åŒ–ï¼šDispatcherServlet åˆå§‹åŒ–æ—¶ä¼šä¼˜å…ˆåˆ°å®¹å™¨é‡Œå¯»æ‰¾å„ç§ç»„ä»¶ï¼Œä½œä¸ºå®ƒçš„æˆå‘˜å˜é‡
<ul><li>HandlerMappingï¼Œåˆå§‹åŒ–æ—¶è®°å½•æ˜ å°„å…³ç³»</li> <li>HandlerAdapterï¼Œåˆå§‹åŒ–æ—¶å‡†å¤‡å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ã€æ¶ˆæ¯è½¬æ¢å™¨</li> <li>HandlerExceptionResolverï¼Œåˆå§‹åŒ–æ—¶å‡†å¤‡å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ã€æ¶ˆæ¯è½¬æ¢å™¨</li> <li>ViewResolver</li></ul></li></ul></li> <li><p>DispatcherServlet ä¼šåˆ©ç”¨ RequestMappingHandlerMapping æŸ¥æ‰¾æ§åˆ¶å™¨æ–¹æ³•</p> <ul><li><p>ä¾‹å¦‚æ ¹æ® /hello è·¯å¾„æ‰¾åˆ° @RequestMapping(&quot;/hello&quot;) å¯¹åº”çš„æ§åˆ¶å™¨æ–¹æ³•</p></li> <li><p>æ§åˆ¶å™¨æ–¹æ³•ä¼šè¢«å°è£…ä¸º HandlerMethod å¯¹è±¡ï¼Œå¹¶ç»“åˆåŒ¹é…åˆ°çš„æ‹¦æˆªå™¨ä¸€èµ·è¿”å›ç»™ DispatcherServlet</p></li> <li><p>HandlerMethod å’Œæ‹¦æˆªå™¨åˆåœ¨ä¸€èµ·ç§°ä¸º HandlerExecutionChainï¼ˆè°ƒç”¨é“¾ï¼‰å¯¹è±¡</p></li></ul></li> <li><p>DispatcherServlet æ¥ä¸‹æ¥ä¼šï¼š</p> <ol><li>è°ƒç”¨æ‹¦æˆªå™¨çš„ preHandle æ–¹æ³•</li> <li>RequestMappingHandlerAdapter è°ƒç”¨ handle æ–¹æ³•ï¼Œå‡†å¤‡æ•°æ®ç»‘å®šå·¥å‚ã€æ¨¡å‹å·¥å‚ã€ModelAndViewContainerã€å°† HandlerMethod å®Œå–„ä¸º ServletInvocableHandlerMethod
<ul><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹1ï¸âƒ£ï¼šè¡¥å……æ¨¡å‹æ•°æ®</li> <li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹2ï¸âƒ£ï¼šè¡¥å……è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨</li> <li>ä½¿ç”¨ HandlerMethodArgumentResolver å‡†å¤‡å‚æ•°
<ul><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹3ï¸âƒ£ï¼šRequestBody å¢å¼º</li></ul></li> <li>è°ƒç”¨ ServletInvocableHandlerMethod</li> <li>ä½¿ç”¨ HandlerMethodReturnValueHandler å¤„ç†è¿”å›å€¼
<ul><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹4ï¸âƒ£ï¼šResponseBody å¢å¼º</li></ul></li> <li>æ ¹æ® ModelAndViewContainer è·å– ModelAndView
<ul><li>å¦‚æœè¿”å›çš„ ModelAndView ä¸º nullï¼Œä¸èµ°ç¬¬ 4 æ­¥è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹
<ul><li>ä¾‹å¦‚ï¼Œæœ‰çš„è¿”å›å€¼å¤„ç†å™¨è°ƒç”¨äº† HttpMessageConverter æ¥å°†ç»“æœè½¬æ¢ä¸º JSONï¼Œè¿™æ—¶ ModelAndView å°±ä¸º null</li></ul></li> <li>å¦‚æœè¿”å›çš„ ModelAndView ä¸ä¸º nullï¼Œä¼šåœ¨ç¬¬ 4 æ­¥èµ°è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹</li></ul></li></ul></li> <li>è°ƒç”¨æ‹¦æˆªå™¨çš„ postHandle æ–¹æ³•</li> <li>å¤„ç†å¼‚å¸¸æˆ–è§†å›¾æ¸²æŸ“
<ul><li>å¦‚æœ 1~3 å‡ºç°å¼‚å¸¸ï¼Œèµ° ExceptionHandlerExceptionResolver å¤„ç†å¼‚å¸¸æµç¨‹
<ul><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹5ï¸âƒ£ï¼š@ExceptionHandler å¼‚å¸¸å¤„ç†</li></ul></li> <li>æ­£å¸¸ï¼Œèµ°è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹</li></ul></li> <li>è°ƒç”¨æ‹¦æˆªå™¨çš„ afterCompletion æ–¹æ³•</li></ol></li></ol> <h2 id="boot"><a href="#boot" class="header-anchor">#</a> Boot</h2> <h3 id="_37-boot-éª¨æ¶é¡¹ç›®"><a href="#_37-boot-éª¨æ¶é¡¹ç›®" class="header-anchor">#</a> 37) Boot éª¨æ¶é¡¹ç›®</h3> <p>å¦‚æœæ˜¯ linux ç¯å¢ƒï¼Œç”¨ä»¥ä¸‹å‘½ä»¤å³å¯è·å– spring boot çš„éª¨æ¶ pom.xml</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">curl</span> <span class="token parameter variable">-G</span> https://start.spring.io/pom.xml <span class="token parameter variable">-d</span> <span class="token assign-left variable">dependencies</span><span class="token operator">=</span>web,mysql,mybatis <span class="token parameter variable">-o</span> pom.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ Postman ç­‰å·¥å…·å®ç°</p> <p>è‹¥æƒ³è·å–æ›´å¤šç”¨æ³•ï¼Œè¯·å‚è€ƒ</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">curl</span> https://start.spring.io
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_38-boot-waré¡¹ç›®"><a href="#_38-boot-waré¡¹ç›®" class="header-anchor">#</a> 38) Boot Waré¡¹ç›®</h3> <p>æ­¥éª¤1ï¼šåˆ›å»ºæ¨¡å—ï¼ŒåŒºåˆ«åœ¨äºæ‰“åŒ…æ–¹å¼é€‰æ‹© war</p> <img title="" src="https://vingkin-1304361015.cos.ap-shanghai.myqcloud.com/os/image-20211021160145072.png" alt="image-20211021160145072" style="zoom:50%;"> <p>æ¥ä¸‹æ¥å‹¾é€‰ Spring Web æ”¯æŒ</p> <img title="" src="https://vingkin-1304361015.cos.ap-shanghai.myqcloud.com/os/image-20211021162416525.png" alt="image-20211021162416525" style="zoom:50%;"> <p>æ­¥éª¤2ï¼šç¼–å†™æ§åˆ¶å™¨</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">abc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¿›å…¥äº†æ§åˆ¶å™¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>æ­¥éª¤3ï¼šç¼–å†™ jsp è§†å›¾ï¼Œæ–°å»º webapp ç›®å½•å’Œä¸€ä¸ª hello.jsp æ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶åä¸æ§åˆ¶å™¨æ–¹æ³•è¿”å›çš„è§†å›¾é€»è¾‘åä¸€è‡´</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>src
    |- main
        |- java
        |- resources
        |- webapp
            |- hello.jsp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>æ­¥éª¤4ï¼šé…ç½®è§†å›¾è·¯å¾„ï¼Œæ‰“å¼€ application.properties æ–‡ä»¶</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">spring.mvc.view.prefix</span><span class="token punctuation">=</span><span class="token value attr-value">/</span>
<span class="token key attr-name">spring.mvc.view.suffix</span><span class="token punctuation">=</span><span class="token value attr-value">.jsp</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>å°†æ¥ prefix + æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼ + suffix å³ä¸ºè§†å›¾å®Œæ•´è·¯å¾„</p></blockquote> <h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="header-anchor">#</a> æµ‹è¯•</h4> <p>å¦‚æœç”¨ mvn æ’ä»¶ <code>mvn spring-boot:run</code> æˆ– main æ–¹æ³•æµ‹è¯•</p> <ul><li>å¿…é¡»æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼Œå› ä¸ºæ­¤æ—¶ç”¨çš„è¿˜æ˜¯å†…åµŒ tomcatï¼Œè€Œå†…åµŒ tomcat é»˜è®¤ä¸å¸¦ jasperï¼ˆç”¨æ¥è§£æ jspï¼‰</li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.tomcat.embed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tomcat-embed-jasper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ Idea é…ç½® tomcat æ¥æµ‹è¯•ï¼Œæ­¤æ—¶ç”¨çš„æ˜¯å¤–ç½® tomcat</p> <ul><li>éª¨æ¶ç”Ÿæˆçš„ä»£ç ä¸­ï¼Œå¤šäº†ä¸€ä¸ª ServletInitializerï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯é…ç½®å¤–ç½® Tomcat ä½¿ç”¨çš„ï¼Œåœ¨å¤–ç½® Tomcat å¯åŠ¨åï¼Œå»è°ƒç”¨å®ƒåˆ›å»ºå’Œè¿è¡Œ SpringApplication</li></ul> <h4 id="å¯ç¤º"><a href="#å¯ç¤º" class="header-anchor">#</a> å¯ç¤º</h4> <p>å¯¹äº jar é¡¹ç›®ï¼Œè‹¥è¦æ”¯æŒ jspï¼Œä¹Ÿå¯ä»¥åœ¨åŠ å…¥ jasper ä¾èµ–çš„å‰æä¸‹ï¼ŒæŠŠ jsp æ–‡ä»¶ç½®å…¥ <code>META-INF/resources</code></p> <h3 id="_39-boot-å¯åŠ¨è¿‡ç¨‹"><a href="#_39-boot-å¯åŠ¨è¿‡ç¨‹" class="header-anchor">#</a> 39) Boot å¯åŠ¨è¿‡ç¨‹</h3> <p>é˜¶æ®µä¸€ï¼šSpringApplication æ„é€ </p> <ol><li>è®°å½• BeanDefinition æº</li> <li>æ¨æ–­åº”ç”¨ç±»å‹</li> <li>è®°å½• ApplicationContext åˆå§‹åŒ–å™¨</li> <li>è®°å½•ç›‘å¬å™¨</li> <li>æ¨æ–­ä¸»å¯åŠ¨ç±»</li></ol> <p>é˜¶æ®µäºŒï¼šæ‰§è¡Œ run æ–¹æ³•</p> <ol><li><p>å¾—åˆ° SpringApplicationRunListenersï¼Œåå­—å–å¾—ä¸å¥½ï¼Œå®é™…æ˜¯äº‹ä»¶å‘å¸ƒå™¨</p> <ul><li>å‘å¸ƒ application starting äº‹ä»¶1ï¸âƒ£</li></ul></li> <li><p>å°è£…å¯åŠ¨ args</p></li> <li><p>å‡†å¤‡ Environment æ·»åŠ å‘½ä»¤è¡Œå‚æ•°ï¼ˆ*ï¼‰</p></li> <li><p>ConfigurationPropertySources å¤„ç†ï¼ˆ*ï¼‰</p> <ul><li>å‘å¸ƒ application environment å·²å‡†å¤‡äº‹ä»¶2ï¸âƒ£</li></ul></li> <li><p>é€šè¿‡ EnvironmentPostProcessorApplicationListener è¿›è¡Œ env åå¤„ç†ï¼ˆ*ï¼‰</p> <ul><li>application.propertiesï¼Œç”± StandardConfigDataLocationResolver è§£æ</li> <li>spring.application.json</li></ul></li> <li><p>ç»‘å®š spring.main åˆ° SpringApplication å¯¹è±¡ï¼ˆ*ï¼‰</p></li> <li><p>æ‰“å° bannerï¼ˆ*ï¼‰</p></li> <li><p>åˆ›å»ºå®¹å™¨</p></li> <li><p>å‡†å¤‡å®¹å™¨</p> <ul><li>å‘å¸ƒ application context å·²åˆå§‹åŒ–äº‹ä»¶3ï¸âƒ£</li></ul></li> <li><p>åŠ è½½ bean å®šä¹‰</p> <ul><li>å‘å¸ƒ application prepared äº‹ä»¶4ï¸âƒ£</li></ul></li> <li><p>refresh å®¹å™¨</p> <ul><li>å‘å¸ƒ application started äº‹ä»¶5ï¸âƒ£</li></ul></li> <li><p>æ‰§è¡Œ runner</p> <ul><li><p>å‘å¸ƒ application ready äº‹ä»¶6ï¸âƒ£</p></li> <li><p>è¿™å…¶ä¸­æœ‰å¼‚å¸¸ï¼Œå‘å¸ƒ application failed äº‹ä»¶7ï¸âƒ£</p></li></ul></li></ol> <blockquote><p>å¸¦ * çš„æœ‰ç‹¬ç«‹çš„ç¤ºä¾‹</p></blockquote> <h4 id="æ¼”ç¤º-å¯åŠ¨è¿‡ç¨‹"><a href="#æ¼”ç¤º-å¯åŠ¨è¿‡ç¨‹" class="header-anchor">#</a> æ¼”ç¤º - å¯åŠ¨è¿‡ç¨‹</h4> <p><strong>com.itheima.a39.A39_1</strong> å¯¹åº” SpringApplication æ„é€ </p> <p><strong>com.itheima.a39.A39_2</strong> å¯¹åº”ç¬¬1æ­¥ï¼Œå¹¶æ¼”ç¤º 7 ä¸ªäº‹ä»¶</p> <p><strong>com.itheima.a39.A39_3</strong> å¯¹åº”ç¬¬2ã€8åˆ°12æ­¥</p> <p><strong>org.springframework.boot.Step3</strong></p> <p><strong>org.springframework.boot.Step4</strong></p> <p><strong>org.springframework.boot.Step5</strong></p> <p><strong>org.springframework.boot.Step6</strong></p> <p><strong>org.springframework.boot.Step7</strong></p> <h4 id="æ”¶è·ğŸ’¡-53"><a href="#æ”¶è·ğŸ’¡-53" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>SpringApplication æ„é€ æ–¹æ³•ä¸­æ‰€åšçš„æ“ä½œ
<ul><li>å¯ä»¥æœ‰å¤šç§æºç”¨æ¥åŠ è½½ bean å®šä¹‰</li> <li>åº”ç”¨ç±»å‹æ¨æ–­</li> <li>æ·»åŠ å®¹å™¨åˆå§‹åŒ–å™¨</li> <li>æ·»åŠ ç›‘å¬å™¨</li> <li>æ¼”ç¤ºä¸»ç±»æ¨æ–­</li></ul></li> <li>å¦‚ä½•è¯»å– spring.factories ä¸­çš„é…ç½®</li> <li>ä»é…ç½®ä¸­è·å–é‡è¦çš„äº‹ä»¶å‘å¸ƒå™¨ï¼šSpringApplicationRunListeners</li> <li>å®¹å™¨çš„åˆ›å»ºã€åˆå§‹åŒ–å™¨å¢å¼ºã€åŠ è½½ bean å®šä¹‰ç­‰</li> <li>CommandLineRunnerã€ApplicationRunner çš„ä½œç”¨</li> <li>ç¯å¢ƒå¯¹è±¡
<ol><li>å‘½ä»¤è¡Œ PropertySource</li> <li>ConfigurationPropertySources è§„èŒƒç¯å¢ƒé”®åç§°</li> <li>EnvironmentPostProcessor åå¤„ç†å¢å¼º
<ul><li>ç”± EventPublishingRunListener é€šè¿‡ç›‘å¬äº‹ä»¶2ï¸âƒ£æ¥è°ƒç”¨</li></ul></li> <li>ç»‘å®š spring.main å‰ç¼€çš„ key value è‡³ SpringApplication</li></ol></li> <li>Banner</li></ol> <h3 id="_40-tomcat-å†…åµŒå®¹å™¨"><a href="#_40-tomcat-å†…åµŒå®¹å™¨" class="header-anchor">#</a> 40) Tomcat å†…åµŒå®¹å™¨</h3> <p>Tomcat åŸºæœ¬ç»“æ„</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Server
â””â”€â”€â”€Service
    â”œâ”€â”€â”€Connector (åè®®, ç«¯å£)
    â””â”€â”€â”€Engine
        â””â”€â”€â”€Host(è™šæ‹Ÿä¸»æœº localhost)
            â”œâ”€â”€â”€Context1 (åº”ç”¨1, å¯ä»¥è®¾ç½®è™šæ‹Ÿè·¯å¾„, / å³ url èµ·å§‹è·¯å¾„; é¡¹ç›®ç£ç›˜è·¯å¾„, å³ docBase )
            â”‚   â”‚   index.html
            â”‚   â””â”€â”€â”€WEB-INF
            â”‚       â”‚   web.xml (servlet, filter, listener) 3.0
            â”‚       â”œâ”€â”€â”€classes (servlet, controller, service ...)
            â”‚       â”œâ”€â”€â”€jsp
            â”‚       â””â”€â”€â”€lib (ç¬¬ä¸‰æ–¹ jar åŒ…)
            â””â”€â”€â”€Context2 (åº”ç”¨2)
                â”‚   index.html
                â””â”€â”€â”€WEB-INF
                        web.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="æ¼”ç¤º1-tomcat-å†…åµŒå®¹å™¨"><a href="#æ¼”ç¤º1-tomcat-å†…åµŒå®¹å™¨" class="header-anchor">#</a> æ¼”ç¤º1 - Tomcat å†…åµŒå®¹å™¨</h4> <h5 id="å…³é”®ä»£ç -9"><a href="#å…³é”®ä»£ç -9" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">LifecycleException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.åˆ›å»º Tomcat å¯¹è±¡</span>
    <span class="token class-name">Tomcat</span> tomcat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tomcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tomcat<span class="token punctuation">.</span><span class="token function">setBaseDir</span><span class="token punctuation">(</span><span class="token string">&quot;tomcat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2.åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹, å³ docBase æ–‡ä»¶å¤¹</span>
    <span class="token class-name">File</span> docBase <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createTempDirectory</span><span class="token punctuation">(</span><span class="token string">&quot;boot.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    docBase<span class="token punctuation">.</span><span class="token function">deleteOnExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3.åˆ›å»º Tomcat é¡¹ç›®, åœ¨ Tomcat ä¸­ç§°ä¸º Context</span>
    <span class="token class-name">Context</span> context <span class="token operator">=</span> tomcat<span class="token punctuation">.</span><span class="token function">addContext</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> docBase<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4.ç¼–ç¨‹æ·»åŠ  Servlet</span>
    context<span class="token punctuation">.</span><span class="token function">addServletContainerInitializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ServletContainerInitializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onStartup</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">,</span> <span class="token class-name">ServletContext</span> ctx<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
            <span class="token class-name">HelloServlet</span> helloServlet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelloServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ctx<span class="token punctuation">.</span><span class="token function">addServlet</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">,</span> helloServlet<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 5.å¯åŠ¨ Tomcat</span>
    tomcat<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 6.åˆ›å»ºè¿æ¥å™¨, è®¾ç½®ç›‘å¬ç«¯å£</span>
    <span class="token class-name">Connector</span> connector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Connector</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Http11Nio2Protocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connector<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tomcat<span class="token punctuation">.</span><span class="token function">setConnector</span><span class="token punctuation">(</span>connector<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h4 id="æ¼”ç¤º2-é›†æˆ-spring-å®¹å™¨"><a href="#æ¼”ç¤º2-é›†æˆ-spring-å®¹å™¨" class="header-anchor">#</a> æ¼”ç¤º2 - é›†æˆ Spring å®¹å™¨</h4> <h5 id="å…³é”®ä»£ç -10"><a href="#å…³é”®ä»£ç -10" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">WebApplicationContext</span> springContext <span class="token operator">=</span> <span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 4.ç¼–ç¨‹æ·»åŠ  Servlet</span>
context<span class="token punctuation">.</span><span class="token function">addServletContainerInitializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ServletContainerInitializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onStartup</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">,</span> <span class="token class-name">ServletContext</span> ctx<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token comment">// â¬‡ï¸é€šè¿‡ ServletRegistrationBean æ·»åŠ  DispatcherServlet ç­‰</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ServletRegistrationBean</span> registrationBean <span class="token operator">:</span> 
             springContext<span class="token punctuation">.</span><span class="token function">getBeansOfType</span><span class="token punctuation">(</span><span class="token class-name">ServletRegistrationBean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            registrationBean<span class="token punctuation">.</span><span class="token function">onStartup</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_41-boot-è‡ªåŠ¨é…ç½®"><a href="#_41-boot-è‡ªåŠ¨é…ç½®" class="header-anchor">#</a> 41) Boot è‡ªåŠ¨é…ç½®</h3> <h4 id="aopautoconfiguration"><a href="#aopautoconfiguration" class="header-anchor">#</a> AopAutoConfiguration</h4> <p>Spring Boot æ˜¯åˆ©ç”¨äº†è‡ªåŠ¨é…ç½®ç±»æ¥ç®€åŒ–äº† aop ç›¸å…³é…ç½®</p> <ul><li>AOP è‡ªåŠ¨é…ç½®ç±»ä¸º <code>org.springframework.boot.autoconfigure.aop.AopAutoConfiguration</code></li> <li>å¯ä»¥é€šè¿‡ <code>spring.aop.auto=false</code> ç¦ç”¨ aop è‡ªåŠ¨é…ç½®</li> <li>AOP è‡ªåŠ¨é…ç½®çš„æœ¬è´¨æ˜¯é€šè¿‡ <code>@EnableAspectJAutoProxy</code> æ¥å¼€å¯äº†è‡ªåŠ¨ä»£ç†ï¼Œå¦‚æœåœ¨å¼•å¯¼ç±»ä¸Šè‡ªå·±æ·»åŠ äº† <code>@EnableAspectJAutoProxy</code> é‚£ä¹ˆä»¥è‡ªå·±æ·»åŠ çš„ä¸ºå‡†</li> <li><code>@EnableAspectJAutoProxy</code> çš„æœ¬è´¨æ˜¯å‘å®¹å™¨ä¸­æ·»åŠ äº† <code>AnnotationAwareAspectJAutoProxyCreator</code> è¿™ä¸ª bean åå¤„ç†å™¨ï¼Œå®ƒèƒ½å¤Ÿæ‰¾åˆ°å®¹å™¨ä¸­æ‰€æœ‰åˆ‡é¢ï¼Œå¹¶ä¸ºåŒ¹é…åˆ‡ç‚¹çš„ç›®æ ‡ç±»åˆ›å»ºä»£ç†ï¼Œåˆ›å»ºä»£ç†çš„å·¥ä½œä¸€èˆ¬æ˜¯åœ¨ bean çš„åˆå§‹åŒ–é˜¶æ®µå®Œæˆçš„</li></ul> <h4 id="datasourceautoconfiguration"><a href="#datasourceautoconfiguration" class="header-anchor">#</a> DataSourceAutoConfiguration</h4> <ul><li>å¯¹åº”çš„è‡ªåŠ¨é…ç½®ç±»ä¸ºï¼šorg.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration</li> <li>å®ƒå†…éƒ¨é‡‡ç”¨äº†æ¡ä»¶è£…é…ï¼Œé€šè¿‡æ£€æŸ¥å®¹å™¨çš„ beanï¼Œä»¥åŠç±»è·¯å¾„ä¸‹çš„ classï¼Œæ¥å†³å®šè¯¥ @Bean æ˜¯å¦ç”Ÿæ•ˆ</li></ul> <p>ç®€å•è¯´æ˜ä¸€ä¸‹ï¼ŒSpring Boot æ”¯æŒä¸¤å¤§ç±»æ•°æ®æºï¼š</p> <ul><li>EmbeddedDatabase - å†…åµŒæ•°æ®åº“è¿æ¥æ± </li> <li>PooledDataSource - éå†…åµŒæ•°æ®åº“è¿æ¥æ± </li></ul> <p>PooledDataSource åˆæ”¯æŒå¦‚ä¸‹æ•°æ®æº</p> <ul><li>hikari æä¾›çš„ HikariDataSource</li> <li>tomcat-jdbc æä¾›çš„ DataSource</li> <li>dbcp2 æä¾›çš„ BasicDataSource</li> <li>oracle æä¾›çš„ PoolDataSourceImpl</li></ul> <p>å¦‚æœçŸ¥é“æ•°æ®æºçš„å®ç°ç±»ç±»å‹ï¼Œå³æŒ‡å®šäº† <code>spring.datasource.type</code>ï¼Œç†è®ºä¸Šå¯ä»¥æ”¯æŒæ‰€æœ‰æ•°æ®æºï¼Œä½†è¿™æ ·åšçš„ä¸€ä¸ªæœ€å¤§é—®é¢˜æ˜¯æ— æ³•è®¢åˆ¶æ¯ç§æ•°æ®æºçš„è¯¦ç»†é…ç½®ï¼ˆå¦‚æœ€å¤§ã€æœ€å°è¿æ¥æ•°ç­‰ï¼‰</p> <h4 id="mybatisautoconfiguration"><a href="#mybatisautoconfiguration" class="header-anchor">#</a> MybatisAutoConfiguration</h4> <ul><li>MyBatis è‡ªåŠ¨é…ç½®ç±»ä¸º <code>org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</code></li> <li>å®ƒä¸»è¦é…ç½®äº†ä¸¤ä¸ª bean
<ul><li>SqlSessionFactory - MyBatis æ ¸å¿ƒå¯¹è±¡ï¼Œç”¨æ¥åˆ›å»º SqlSession</li> <li>SqlSessionTemplate - SqlSession çš„å®ç°ï¼Œæ­¤å®ç°ä¼šä¸å½“å‰çº¿ç¨‹ç»‘å®š</li> <li>ç”¨ ImportBeanDefinitionRegistrar çš„æ–¹å¼æ‰«ææ‰€æœ‰æ ‡æ³¨äº† @Mapper æ³¨è§£çš„æ¥å£</li> <li>ç”¨ AutoConfigurationPackages æ¥ç¡®å®šæ‰«æçš„åŒ…</li></ul></li> <li>è¿˜æœ‰ä¸€ä¸ªç›¸å…³çš„ beanï¼šMybatisPropertiesï¼Œå®ƒä¼šè¯»å–é…ç½®æ–‡ä»¶ä¸­å¸¦ <code>mybatis.</code> å‰ç¼€çš„é…ç½®é¡¹è¿›è¡Œå®šåˆ¶é…ç½®</li></ul> <p>@MapperScan æ³¨è§£çš„ä½œç”¨ä¸ MybatisAutoConfiguration ç±»ä¼¼ï¼Œä¼šæ³¨å†Œ MapperScannerConfigurer æœ‰å¦‚ä¸‹åŒºåˆ«</p> <ul><li>@MapperScan æ‰«æå…·ä½“åŒ…ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥é…ç½®å…³æ³¨å“ªä¸ªæ³¨è§£ï¼‰</li> <li>@MapperScan å¦‚æœä¸æŒ‡å®šæ‰«æå…·ä½“åŒ…ï¼Œåˆ™ä¼šæŠŠå¼•å¯¼ç±»èŒƒå›´å†…ï¼Œæ‰€æœ‰æ¥å£å½“åš Mapper æ¥å£</li> <li>MybatisAutoConfiguration å…³æ³¨çš„æ˜¯æ‰€æœ‰æ ‡æ³¨ @Mapper æ³¨è§£çš„æ¥å£ï¼Œä¼šå¿½ç•¥æ‰é @Mapper æ ‡æ³¨çš„æ¥å£</li></ul> <p>è¿™é‡Œæœ‰åŒå­¦æœ‰ç–‘é—®ï¼Œä¹‹å‰ä»‹ç»çš„éƒ½æ˜¯å°†å…·ä½“ç±»äº¤ç»™ Spring ç®¡ç†ï¼Œæ€ä¹ˆåˆ°äº† MyBatis è¿™å„¿ï¼Œæ¥å£å°±å¯ä»¥è¢«ç®¡ç†å‘¢ï¼Ÿ</p> <ul><li>å…¶å®å¹¶éå°†æ¥å£äº¤ç»™ Spring ç®¡ç†ï¼Œè€Œæ˜¯æ¯ä¸ªæ¥å£ä¼šå¯¹åº”ä¸€ä¸ª MapperFactoryBeanï¼Œæ˜¯åè€…è¢« Spring æ‰€ç®¡ç†ï¼Œæ¥å£åªæ˜¯ä½œä¸º MapperFactoryBean çš„ä¸€ä¸ªå±æ€§æ¥é…ç½®</li></ul> <h4 id="transactionautoconfiguration"><a href="#transactionautoconfiguration" class="header-anchor">#</a> TransactionAutoConfiguration</h4> <ul><li><p>äº‹åŠ¡è‡ªåŠ¨é…ç½®ç±»æœ‰ä¸¤ä¸ªï¼š</p> <ul><li><code>org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration</code></li> <li><code>org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration</code></li></ul></li> <li><p>å‰è€…é…ç½®äº† DataSourceTransactionManager ç”¨æ¥æ‰§è¡Œäº‹åŠ¡çš„æäº¤ã€å›æ»šæ“ä½œ</p></li> <li><p>åè€…åŠŸèƒ½ä¸Šå¯¹æ ‡ @EnableTransactionManagementï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰ä¸ª bean</p> <ul><li>BeanFactoryTransactionAttributeSourceAdvisor äº‹åŠ¡åˆ‡é¢ç±»ï¼ŒåŒ…å«é€šçŸ¥å’Œåˆ‡ç‚¹</li> <li>TransactionInterceptor äº‹åŠ¡é€šçŸ¥ç±»ï¼Œç”±å®ƒåœ¨ç›®æ ‡æ–¹æ³•è°ƒç”¨å‰ååŠ å…¥äº‹åŠ¡æ“ä½œ</li> <li>AnnotationTransactionAttributeSource ä¼šè§£æ @Transactional åŠäº‹åŠ¡å±æ€§ï¼Œä¹ŸåŒ…å«äº†åˆ‡ç‚¹åŠŸèƒ½</li></ul></li> <li><p>å¦‚æœè‡ªå·±é…ç½®äº† DataSourceTransactionManager æˆ–æ˜¯åœ¨å¼•å¯¼ç±»åŠ äº† @EnableTransactionManagementï¼Œåˆ™ä»¥è‡ªå·±é…ç½®çš„ä¸ºå‡†</p></li></ul> <h4 id="servletwebserverfactoryautoconfiguration"><a href="#servletwebserverfactoryautoconfiguration" class="header-anchor">#</a> ServletWebServerFactoryAutoConfiguration</h4> <ul><li>æä¾› ServletWebServerFactory</li></ul> <h4 id="dispatcherservletautoconfiguration"><a href="#dispatcherservletautoconfiguration" class="header-anchor">#</a> DispatcherServletAutoConfiguration</h4> <ul><li>æä¾› DispatcherServlet</li> <li>æä¾› DispatcherServletRegistrationBean</li></ul> <h4 id="webmvcautoconfiguration"><a href="#webmvcautoconfiguration" class="header-anchor">#</a> WebMvcAutoConfiguration</h4> <ul><li>é…ç½® DispatcherServlet çš„å„é¡¹ç»„ä»¶ï¼Œæä¾›çš„ bean è§è¿‡çš„æœ‰
<ul><li>å¤šé¡¹ HandlerMapping</li> <li>å¤šé¡¹ HandlerAdapter</li> <li>HandlerExceptionResolver</li></ul></li></ul> <h4 id="errormvcautoconfiguration"><a href="#errormvcautoconfiguration" class="header-anchor">#</a> ErrorMvcAutoConfiguration</h4> <ul><li>æä¾›çš„ bean æœ‰ BasicErrorController</li></ul> <h4 id="multipartautoconfiguration"><a href="#multipartautoconfiguration" class="header-anchor">#</a> MultipartAutoConfiguration</h4> <ul><li>å®ƒæä¾›äº† org.springframework.web.multipart.support.StandardServletMultipartResolver</li> <li>è¯¥ bean ç”¨æ¥è§£æ multipart/form-data æ ¼å¼çš„æ•°æ®</li></ul> <h4 id="httpencodingautoconfiguration"><a href="#httpencodingautoconfiguration" class="header-anchor">#</a> HttpEncodingAutoConfiguration</h4> <ul><li>POST è¯·æ±‚å‚æ•°å¦‚æœæœ‰ä¸­æ–‡ï¼Œæ— éœ€ç‰¹æ®Šè®¾ç½®ï¼Œè¿™æ˜¯å› ä¸º Spring Boot å·²ç»é…ç½®äº† org.springframework.boot.web.servlet.filter.OrderedCharacterEncodingFilter</li> <li>å¯¹åº”é…ç½® server.servlet.encoding.charset=UTF-8ï¼Œé»˜è®¤å°±æ˜¯ UTF-8</li> <li>å½“ç„¶ï¼Œå®ƒåªå½±å“é json æ ¼å¼çš„æ•°æ®</li></ul> <h4 id="æ¼”ç¤º-è‡ªåŠ¨é…ç½®ç±»åŸç†"><a href="#æ¼”ç¤º-è‡ªåŠ¨é…ç½®ç±»åŸç†" class="header-anchor">#</a> æ¼”ç¤º - è‡ªåŠ¨é…ç½®ç±»åŸç†</h4> <h5 id="å…³é”®ä»£ç -11"><a href="#å…³é”®ä»£ç -11" class="header-anchor">#</a> å…³é”®ä»£ç </h5> <p>å‡è®¾å·²æœ‰ç¬¬ä¸‰æ–¹çš„ä¸¤ä¸ªè‡ªåŠ¨é…ç½®ç±»</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span> <span class="token comment">// â¬…ï¸ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">AutoConfiguration1</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Bean1</span> <span class="token function">bean1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Bean1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span> <span class="token comment">// â¬…ï¸ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">AutoConfiguration2</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Bean2</span> <span class="token function">bean2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Bean2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>æä¾›ä¸€ä¸ªé…ç½®æ–‡ä»¶ META-INF/spring.factoriesï¼Œkey ä¸ºå¯¼å…¥å™¨ç±»åï¼Œå€¼ä¸ºå¤šä¸ªè‡ªåŠ¨é…ç½®ç±»åï¼Œç”¨é€—å·åˆ†éš”</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">MyImportSelector</span><span class="token punctuation">=</span><span class="token value attr-value">\
AutoConfiguration1,\
AutoConfiguration2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p><em><strong>æ³¨æ„</strong></em></p> <ul><li>ä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­ MyImportSelector ä¸ AutoConfiguration1ï¼ŒAutoConfiguration2 ä¸ºç®€æ´å‡çœç•¥äº†åŒ…åï¼Œè‡ªå·±æµ‹è¯•æ—¶è¯·å°†åŒ…åæ ¹æ®æƒ…å†µè¡¥å…¨</li></ul></blockquote> <p>å¼•å…¥è‡ªåŠ¨é…ç½®</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span> <span class="token comment">// â¬…ï¸æœ¬é¡¹ç›®çš„é…ç½®ç±»</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">MyImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Config</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyImportSelector</span> <span class="token keyword">implements</span> <span class="token class-name">DeferredImportSelector</span> <span class="token punctuation">{</span>
    <span class="token comment">// â¬‡ï¸è¯¥æ–¹æ³•ä» META-INF/spring.factories è¯»å–è‡ªåŠ¨é…ç½®ç±»åï¼Œè¿”å›çš„ String[] å³ä¸ºè¦å¯¼å…¥çš„é…ç½®ç±»</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">SpringFactoriesLoader</span>
            <span class="token punctuation">.</span><span class="token function">loadFactoryNames</span><span class="token punctuation">(</span><span class="token class-name">MyImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-54"><a href="#æ”¶è·ğŸ’¡-54" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>è‡ªåŠ¨é…ç½®ç±»æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªé…ç½®ç±»è€Œå·²ï¼Œåªæ˜¯ç”¨ META-INF/spring.factories ç®¡ç†ï¼Œä¸åº”ç”¨é…ç½®ç±»è§£è€¦</li> <li>@Enable æ‰“å¤´çš„æ³¨è§£æœ¬è´¨æ˜¯åˆ©ç”¨äº† @Import</li> <li>@Import é…åˆ DeferredImportSelector å³å¯å®ç°å¯¼å…¥ï¼ŒselectImports æ–¹æ³•çš„è¿”å›å€¼å³ä¸ºè¦å¯¼å…¥çš„é…ç½®ç±»å</li> <li>DeferredImportSelector çš„å¯¼å…¥ä¼šåœ¨æœ€åæ‰§è¡Œï¼Œä¸ºçš„æ˜¯è®©å…¶å®ƒé…ç½®ä¼˜å…ˆè§£æ</li></ol> <h3 id="_42-æ¡ä»¶è£…é…åº•å±‚"><a href="#_42-æ¡ä»¶è£…é…åº•å±‚" class="header-anchor">#</a> 42) æ¡ä»¶è£…é…åº•å±‚</h3> <p>æ¡ä»¶è£…é…çš„åº•å±‚æ˜¯æœ¬è´¨ä¸Šæ˜¯ @Conditional ä¸ Conditionï¼Œè¿™ä¸¤ä¸ªæ³¨è§£ã€‚å¼•å…¥è‡ªåŠ¨é…ç½®ç±»æ—¶ï¼ŒæœŸæœ›æ»¡è¶³ä¸€å®šæ¡ä»¶æ‰èƒ½è¢« Spring ç®¡ç†ï¼Œä¸æ»¡è¶³åˆ™ä¸ç®¡ç†ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿ</p> <p>æ¯”å¦‚æ¡ä»¶æ˜¯ã€ç±»è·¯å¾„ä¸‹å¿…é¡»æœ‰ dataSourceã€‘è¿™ä¸ª bean ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿ</p> <p>é¦–å…ˆç¼–å†™æ¡ä»¶åˆ¤æ–­ç±»ï¼Œå®ƒå®ç° Condition æ¥å£ï¼Œç¼–å†™æ¡ä»¶åˆ¤æ–­é€»è¾‘</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyCondition1</span> <span class="token keyword">implements</span> <span class="token class-name">Condition</span> <span class="token punctuation">{</span> 
    <span class="token comment">// â¬‡ï¸å¦‚æœå­˜åœ¨ Druid ä¾èµ–ï¼Œæ¡ä»¶æˆç«‹</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">ConditionContext</span> context<span class="token punctuation">,</span> <span class="token class-name">AnnotatedTypeMetadata</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å…¶æ¬¡ï¼Œåœ¨è¦å¯¼å…¥çš„è‡ªåŠ¨é…ç½®ç±»ä¸Šæ·»åŠ  <code>@Conditional(MyCondition1.class)</code>ï¼Œå°†æ¥æ­¤ç±»è¢«å¯¼å…¥æ—¶å°±ä¼šåšæ¡ä»¶æ£€æŸ¥</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span> <span class="token comment">// ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span>
<span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">MyCondition1</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// â¬…ï¸åŠ å…¥æ¡ä»¶</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">AutoConfiguration1</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Bean1</span> <span class="token function">bean1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Bean1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>åˆ†åˆ«æµ‹è¯•åŠ å…¥å’Œå»é™¤ druid ä¾èµ–ï¼Œè§‚å¯Ÿ bean1 æ˜¯å¦å­˜åœ¨äºå®¹å™¨</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="æ”¶è·ğŸ’¡-55"><a href="#æ”¶è·ğŸ’¡-55" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å­¦ä¹ ä¸€ç§ç‰¹æ®Šçš„ if - else</li></ol> <h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="header-anchor">#</a> å…¶å®ƒ</h2> <h3 id="_43-factorybean"><a href="#_43-factorybean" class="header-anchor">#</a> 43) FactoryBean</h3> <h4 id="æ¼”ç¤º-factorybean"><a href="#æ¼”ç¤º-factorybean" class="header-anchor">#</a> æ¼”ç¤º - FactoryBean</h4> <h5 id="ä»£ç å‚è€ƒ-41"><a href="#ä»£ç å‚è€ƒ-41" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a43</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-56"><a href="#æ”¶è·ğŸ’¡-56" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>å®ƒçš„ä½œç”¨æ˜¯ç”¨åˆ¶é€ åˆ›å»ºè¿‡ç¨‹è¾ƒä¸ºå¤æ‚çš„äº§å“, å¦‚ SqlSessionFactory, ä½† @Bean å·²å…·å¤‡ç­‰ä»·åŠŸèƒ½</li> <li>ä½¿ç”¨ä¸Šè¾ƒä¸ºå¤æ€ª, ä¸€ä¸ç•™ç¥å°±ä¼šç”¨é”™
<ol><li>è¢« FactoryBean åˆ›å»ºçš„äº§å“
<ul><li>ä¼šè®¤ä¸ºåˆ›å»ºã€ä¾èµ–æ³¨å…¥ã€Aware æ¥å£å›è°ƒã€å‰åˆå§‹åŒ–è¿™äº›éƒ½æ˜¯ FactoryBean çš„èŒè´£, è¿™äº›æµç¨‹éƒ½ä¸ä¼šèµ°</li> <li>å”¯æœ‰ååˆå§‹åŒ–çš„æµç¨‹ä¼šèµ°, ä¹Ÿå°±æ˜¯äº§å“å¯ä»¥è¢«ä»£ç†å¢å¼º</li> <li>å•ä¾‹çš„äº§å“ä¸ä¼šå­˜å‚¨äº BeanFactory çš„ singletonObjects æˆå‘˜ä¸­, è€Œæ˜¯å¦ä¸€ä¸ª factoryBeanObjectCache æˆå‘˜ä¸­</li></ul></li> <li>æŒ‰åå­—å»è·å–æ—¶, æ‹¿åˆ°çš„æ˜¯äº§å“å¯¹è±¡, åå­—å‰é¢åŠ  &amp; è·å–çš„æ˜¯å·¥å‚å¯¹è±¡</li></ol></li></ol> <h3 id="_44-indexed-åŸç†"><a href="#_44-indexed-åŸç†" class="header-anchor">#</a> 44) @Indexed åŸç†</h3> <p>çœŸå®é¡¹ç›®ä¸­ï¼Œåªéœ€è¦åŠ å…¥ä»¥ä¸‹ä¾èµ–å³å¯</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-context-indexer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="æ¼”ç¤º-indexed"><a href="#æ¼”ç¤º-indexed" class="header-anchor">#</a> æ¼”ç¤º - @Indexed</h4> <h5 id="ä»£ç å‚è€ƒ-42"><a href="#ä»£ç å‚è€ƒ-42" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a44</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-57"><a href="#æ”¶è·ğŸ’¡-57" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>åœ¨ç¼–è¯‘æ—¶å°±æ ¹æ® @Indexed ç”Ÿæˆ META-INF/spring.components æ–‡ä»¶</li> <li>æ‰«ææ—¶
<ul><li>å¦‚æœå‘ç° META-INF/spring.components å­˜åœ¨, ä»¥å®ƒä¸ºå‡†åŠ è½½ bean definition</li> <li>å¦åˆ™, ä¼šéå†åŒ…ä¸‹æ‰€æœ‰ class èµ„æº (åŒ…æ‹¬ jar å†…çš„)</li></ul></li> <li>è§£å†³çš„é—®é¢˜ï¼Œåœ¨ç¼–è¯‘æœŸå°±æ‰¾åˆ° @Component ç»„ä»¶ï¼ŒèŠ‚çœè¿è¡ŒæœŸé—´æ‰«æ @Component çš„æ—¶é—´</li></ol> <h3 id="_45-ä»£ç†è¿›ä¸€æ­¥ç†è§£"><a href="#_45-ä»£ç†è¿›ä¸€æ­¥ç†è§£" class="header-anchor">#</a> 45) ä»£ç†è¿›ä¸€æ­¥ç†è§£</h3> <h4 id="æ¼”ç¤º-ä»£ç†"><a href="#æ¼”ç¤º-ä»£ç†" class="header-anchor">#</a> æ¼”ç¤º - ä»£ç†</h4> <h5 id="ä»£ç å‚è€ƒ-43"><a href="#ä»£ç å‚è€ƒ-43" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a45</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-58"><a href="#æ”¶è·ğŸ’¡-58" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li><p>spring ä»£ç†çš„è®¾è®¡ç‰¹ç‚¹</p> <ul><li><p>ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–å½±å“çš„æ˜¯åŸå§‹å¯¹è±¡</p> <ul><li>å› æ­¤ cglib ä¸èƒ½ç”¨ MethodProxy.invokeSuper()</li></ul></li> <li><p>ä»£ç†ä¸ç›®æ ‡æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼ŒäºŒè€…æˆå‘˜å˜é‡å¹¶ä¸å…±ç”¨æ•°æ®</p></li></ul></li> <li><p>static æ–¹æ³•ã€final æ–¹æ³•ã€private æ–¹æ³•å‡æ— æ³•å¢å¼º</p> <ul><li>è¿›ä¸€æ­¥ç†è§£ä»£ç†å¢å¼ºåŸºäºæ–¹æ³•é‡å†™</li></ul></li></ol> <h3 id="_46-value-è£…é…åº•å±‚"><a href="#_46-value-è£…é…åº•å±‚" class="header-anchor">#</a> 46) @Value è£…é…åº•å±‚</h3> <h4 id="æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤"><a href="#æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤" class="header-anchor">#</a> æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤</h4> <ol><li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º Optionalï¼Œæ˜¯ï¼Œåˆ™è¿›è¡Œå°è£…ï¼ˆéå»¶è¿Ÿï¼‰ï¼Œå¦åˆ™å‘ä¸‹èµ°</li> <li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º ObjectFactory æˆ– ObjectProviderï¼Œæ˜¯ï¼Œåˆ™è¿›è¡Œå°è£…ï¼ˆå»¶è¿Ÿï¼‰ï¼Œå¦åˆ™å‘ä¸‹èµ°</li> <li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹ï¼ˆæˆå‘˜æˆ–å‚æ•°ï¼‰ä¸Šæ˜¯å¦ç”¨ @Lazy ä¿®é¥°ï¼Œæ˜¯ï¼Œåˆ™è¿”å›ä»£ç†ï¼Œå¦åˆ™å‘ä¸‹èµ°</li> <li>è§£æ @Value çš„å€¼
<ol><li>å¦‚æœéœ€è¦çš„å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œå…ˆè§£æ ${ }ï¼Œå†è§£æ #{ }</li> <li>ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œéœ€è¦ç”¨ TypeConverter è½¬æ¢</li></ol></li> <li>çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º Streamã€Arrayã€Collectionã€Mapï¼Œæ˜¯ï¼Œåˆ™æŒ‰é›†åˆå¤„ç†ï¼Œå¦åˆ™å‘ä¸‹èµ°</li> <li>åœ¨ BeanFactory çš„ resolvableDependencies ä¸­æ‰¾æœ‰æ²¡æœ‰ç±»å‹åˆé€‚çš„å¯¹è±¡æ³¨å…¥ï¼Œæ²¡æœ‰å‘ä¸‹èµ°</li> <li>åœ¨ BeanFactory åŠçˆ¶å·¥å‚ä¸­æ‰¾ç±»å‹åŒ¹é…çš„ bean è¿›è¡Œç­›é€‰ï¼Œç­›é€‰æ—¶ä¼šè€ƒè™‘ @Qualifier åŠæ³›å‹</li> <li>ç»“æœä¸ªæ•°ä¸º 0 æŠ›å‡º NoSuchBeanDefinitionException å¼‚å¸¸</li> <li>å¦‚æœç»“æœ &gt; 1ï¼Œå†æ ¹æ® @Primary è¿›è¡Œç­›é€‰</li> <li>å¦‚æœç»“æœä» &gt; 1ï¼Œå†æ ¹æ®æˆå‘˜åæˆ–å˜é‡åè¿›è¡Œç­›é€‰</li> <li>ç»“æœä» &gt; 1ï¼ŒæŠ›å‡º NoUniqueBeanDefinitionException å¼‚å¸¸</li></ol> <h4 id="æ¼”ç¤º-value-è£…é…è¿‡ç¨‹"><a href="#æ¼”ç¤º-value-è£…é…è¿‡ç¨‹" class="header-anchor">#</a> æ¼”ç¤º - @Value è£…é…è¿‡ç¨‹</h4> <h5 id="ä»£ç å‚è€ƒ-44"><a href="#ä»£ç å‚è€ƒ-44" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a46</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-59"><a href="#æ”¶è·ğŸ’¡-59" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>ContextAnnotationAutowireCandidateResolver ä½œç”¨ä¹‹ä¸€ï¼Œè·å– @Value çš„å€¼</li> <li>äº†è§£ ${ } å¯¹åº”çš„è§£æå™¨</li> <li>äº†è§£ #{ } å¯¹åº”çš„è§£æå™¨</li> <li>TypeConvert çš„ä¸€é¡¹ä½“ç°</li></ol> <h3 id="_47-autowired-è£…é…åº•å±‚"><a href="#_47-autowired-è£…é…åº•å±‚" class="header-anchor">#</a> 47) @Autowired è£…é…åº•å±‚</h3> <h4 id="æ¼”ç¤º-autowired-è£…é…è¿‡ç¨‹"><a href="#æ¼”ç¤º-autowired-è£…é…è¿‡ç¨‹" class="header-anchor">#</a> æ¼”ç¤º - @Autowired è£…é…è¿‡ç¨‹</h4> <h5 id="ä»£ç å‚è€ƒ-45"><a href="#ä»£ç å‚è€ƒ-45" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a47</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-60"><a href="#æ”¶è·ğŸ’¡-60" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <ol><li>@Autowired æœ¬è´¨ä¸Šæ˜¯æ ¹æ®æˆå‘˜å˜é‡æˆ–æ–¹æ³•å‚æ•°çš„ç±»å‹è¿›è¡Œè£…é…</li> <li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ Optionalï¼Œéœ€è¦æ ¹æ® Optional æ³›å‹æ‰¾åˆ° beanï¼Œå†å°è£…ä¸º Optional å¯¹è±¡è£…é…</li> <li>å¦‚æœå¾…è£…é…çš„ç±»å‹æ˜¯ ObjectFactoryï¼Œéœ€è¦æ ¹æ® ObjectFactory æ³›å‹åˆ›å»º ObjectFactory å¯¹è±¡è£…é…
<ul><li>æ­¤æ–¹æ³•å¯ä»¥å»¶è¿Ÿ bean çš„è·å–</li></ul></li> <li>å¦‚æœå¾…è£…é…çš„æˆå‘˜å˜é‡æˆ–æ–¹æ³•å‚æ•°ä¸Šç”¨ @Lazy æ ‡æ³¨ï¼Œä¼šåˆ›å»ºä»£ç†å¯¹è±¡è£…é…
<ul><li>æ­¤æ–¹æ³•å¯ä»¥å»¶è¿ŸçœŸå® bean çš„è·å–</li> <li>è¢«è£…é…çš„ä»£ç†ä¸ä½œä¸º bean</li></ul></li> <li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯æ•°ç»„ï¼Œéœ€è¦è·å–æ•°ç»„å…ƒç´ ç±»å‹ï¼Œæ ¹æ®æ­¤ç±»å‹æ‰¾åˆ°å¤šä¸ª bean è¿›è¡Œè£…é…</li> <li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ Collection æˆ–å…¶å­æ¥å£ï¼Œéœ€è¦è·å– Collection æ³›å‹ï¼Œæ ¹æ®æ­¤ç±»å‹æ‰¾åˆ°å¤šä¸ª bean</li> <li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ ApplicationContext ç­‰ç‰¹æ®Šç±»å‹
<ul><li>ä¼šåœ¨ BeanFactory çš„ resolvableDependencies æˆå‘˜æŒ‰ç±»å‹æŸ¥æ‰¾è£…é…</li> <li>resolvableDependencies æ˜¯ map é›†åˆï¼Œkey æ˜¯ç‰¹æ®Šç±»å‹ï¼Œvalue æ˜¯å…¶å¯¹åº”å¯¹è±¡</li> <li>ä¸èƒ½ç›´æ¥æ ¹æ® key è¿›è¡ŒæŸ¥æ‰¾ï¼Œè€Œæ˜¯ç”¨ isAssignableFrom é€ä¸€å°è¯•å³è¾¹ç±»å‹æ˜¯å¦å¯ä»¥è¢«èµ‹å€¼ç»™å·¦è¾¹çš„ key ç±»å‹</li></ul></li> <li>å¦‚æœå¾…è£…é…ç±»å‹æœ‰æ³›å‹å‚æ•°
<ul><li>éœ€è¦åˆ©ç”¨ ContextAnnotationAutowireCandidateResolver æŒ‰æ³›å‹å‚æ•°ç±»å‹ç­›é€‰</li></ul></li> <li>å¦‚æœå¾…è£…é…ç±»å‹æœ‰ @Qualifier
<ul><li>éœ€è¦åˆ©ç”¨ ContextAnnotationAutowireCandidateResolver æŒ‰æ³¨è§£æä¾›çš„ bean åç§°ç­›é€‰</li></ul></li> <li>æœ‰ @Primary æ ‡æ³¨çš„ @Component æˆ– @Bean çš„å¤„ç†</li> <li>ä¸æˆå‘˜å˜é‡åæˆ–æ–¹æ³•å‚æ•°ååŒå bean çš„å¤„ç†</li></ol> <h3 id="_48-äº‹ä»¶ç›‘å¬å™¨"><a href="#_48-äº‹ä»¶ç›‘å¬å™¨" class="header-anchor">#</a> 48) äº‹ä»¶ç›‘å¬å™¨</h3> <h4 id="æ¼”ç¤º-äº‹ä»¶ç›‘å¬å™¨"><a href="#æ¼”ç¤º-äº‹ä»¶ç›‘å¬å™¨" class="header-anchor">#</a> æ¼”ç¤º - äº‹ä»¶ç›‘å¬å™¨</h4> <h5 id="ä»£ç å‚è€ƒ-46"><a href="#ä»£ç å‚è€ƒ-46" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a48</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-61"><a href="#æ”¶è·ğŸ’¡-61" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>äº‹ä»¶ç›‘å¬å™¨çš„ä¸¤ç§æ–¹å¼</p> <ol><li>å®ç° ApplicationListener æ¥å£
<ul><li>æ ¹æ®æ¥å£æ³›å‹ç¡®å®šäº‹ä»¶ç±»å‹</li></ul></li> <li>@EventListener æ ‡æ³¨ç›‘å¬æ–¹æ³•
<ul><li>æ ¹æ®ç›‘å¬å™¨æ–¹æ³•å‚æ•°ç¡®å®šäº‹ä»¶ç±»å‹</li> <li>è§£ææ—¶æœºï¼šåœ¨ SmartInitializingSingletonï¼ˆæ‰€æœ‰å•ä¾‹åˆå§‹åŒ–å®Œæˆåï¼‰ï¼Œè§£ææ¯ä¸ªå•ä¾‹ bean</li></ul></li></ol> <h3 id="_49-äº‹ä»¶å‘å¸ƒå™¨"><a href="#_49-äº‹ä»¶å‘å¸ƒå™¨" class="header-anchor">#</a> 49) äº‹ä»¶å‘å¸ƒå™¨</h3> <h4 id="æ¼”ç¤º-äº‹ä»¶å‘å¸ƒå™¨"><a href="#æ¼”ç¤º-äº‹ä»¶å‘å¸ƒå™¨" class="header-anchor">#</a> æ¼”ç¤º - äº‹ä»¶å‘å¸ƒå™¨</h4> <h5 id="ä»£ç å‚è€ƒ-47"><a href="#ä»£ç å‚è€ƒ-47" class="header-anchor">#</a> ä»£ç å‚è€ƒ</h5> <p><strong>com.itheima.a49</strong> åŒ…</p> <h4 id="æ”¶è·ğŸ’¡-62"><a href="#æ”¶è·ğŸ’¡-62" class="header-anchor">#</a> æ”¶è·ğŸ’¡</h4> <p>äº‹ä»¶å‘å¸ƒå™¨æ¨¡æ‹Ÿå®ç°</p> <ol><li>addApplicationListenerBean è´Ÿè´£æ”¶é›†å®¹å™¨ä¸­çš„ç›‘å¬å™¨
<ul><li>ç›‘å¬å™¨ä¼šç»Ÿä¸€è½¬æ¢ä¸º GenericApplicationListener å¯¹è±¡ï¼Œä»¥æ”¯æŒåˆ¤æ–­äº‹ä»¶ç±»å‹</li></ul></li> <li>multicastEvent éå†ç›‘å¬å™¨é›†åˆï¼Œå‘å¸ƒäº‹ä»¶
<ul><li>å‘å¸ƒå‰å…ˆé€šè¿‡ GenericApplicationListener.supportsEventType åˆ¤æ–­æ”¯æŒè¯¥äº‹ä»¶ç±»å‹æ‰å‘äº‹ä»¶</li> <li>å¯ä»¥åˆ©ç”¨çº¿ç¨‹æ± è¿›è¡Œå¼‚æ­¥å‘äº‹ä»¶ä¼˜åŒ–</li></ul></li> <li>å¦‚æœå‘é€çš„äº‹ä»¶å¯¹è±¡ä¸æ˜¯ ApplicationEvent ç±»å‹ï¼ŒSpring ä¼šæŠŠå®ƒåŒ…è£…ä¸º PayloadApplicationEvent å¹¶ç”¨æ³›å‹æŠ€æœ¯è§£æäº‹ä»¶å¯¹è±¡çš„åŸå§‹ç±»å‹
<ul><li>è§†é¢‘ä¸­æœªè®²è§£</li></ul></li></ol></div></section> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/vingkin/Blog/edit/docs/docs/guide/interview/spriiiiing.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/Blog/guide/interview/Spring.html" class="prev">
            Spring
          </a></span> <span class="next"><a href="/Blog/guide/interview/SpringMVC.html">
            SpringMVC
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#å®¹å™¨ä¸-bean" class="sidebar-link reco-side-å®¹å™¨ä¸-bean" data-v-cb1513f6>å®¹å™¨ä¸ bean</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_1-å®¹å™¨æ¥å£" class="sidebar-link reco-side-_1-å®¹å™¨æ¥å£" data-v-cb1513f6>1) å®¹å™¨æ¥å£</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_2-å®¹å™¨å®ç°" class="sidebar-link reco-side-_2-å®¹å™¨å®ç°" data-v-cb1513f6>2) å®¹å™¨å®ç°</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_3-bean-çš„ç”Ÿå‘½å‘¨æœŸ" class="sidebar-link reco-side-_3-bean-çš„ç”Ÿå‘½å‘¨æœŸ" data-v-cb1513f6>3) Bean çš„ç”Ÿå‘½å‘¨æœŸ</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_4-bean-åå¤„ç†å™¨" class="sidebar-link reco-side-_4-bean-åå¤„ç†å™¨" data-v-cb1513f6>4) Bean åå¤„ç†å™¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_5-beanfactory-åå¤„ç†å™¨" class="sidebar-link reco-side-_5-beanfactory-åå¤„ç†å™¨" data-v-cb1513f6>5) BeanFactory åå¤„ç†å™¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_6-aware-æ¥å£" class="sidebar-link reco-side-_6-aware-æ¥å£" data-v-cb1513f6>6) Aware æ¥å£</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_7-åˆå§‹åŒ–ä¸é”€æ¯" class="sidebar-link reco-side-_7-åˆå§‹åŒ–ä¸é”€æ¯" data-v-cb1513f6>7) åˆå§‹åŒ–ä¸é”€æ¯</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_8-scope" class="sidebar-link reco-side-_8-scope" data-v-cb1513f6>8) Scope</a></li><li class="level-2" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#aop" class="sidebar-link reco-side-aop" data-v-cb1513f6>AOP</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_9-aop-å®ç°ä¹‹-ajc-ç¼–è¯‘å™¨" class="sidebar-link reco-side-_9-aop-å®ç°ä¹‹-ajc-ç¼–è¯‘å™¨" data-v-cb1513f6>9) AOP å®ç°ä¹‹ ajc ç¼–è¯‘å™¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_10-aop-å®ç°ä¹‹-agent-ç±»åŠ è½½" class="sidebar-link reco-side-_10-aop-å®ç°ä¹‹-agent-ç±»åŠ è½½" data-v-cb1513f6>10) AOP å®ç°ä¹‹ agent ç±»åŠ è½½</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_11-aop-å®ç°ä¹‹-proxy" class="sidebar-link reco-side-_11-aop-å®ç°ä¹‹-proxy" data-v-cb1513f6>11) AOP å®ç°ä¹‹ proxy</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_12-jdk-åŠ¨æ€ä»£ç†è¿›é˜¶" class="sidebar-link reco-side-_12-jdk-åŠ¨æ€ä»£ç†è¿›é˜¶" data-v-cb1513f6>12) jdk åŠ¨æ€ä»£ç†è¿›é˜¶</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_13-cglib-ä»£ç†è¿›é˜¶" class="sidebar-link reco-side-_13-cglib-ä»£ç†è¿›é˜¶" data-v-cb1513f6>13) cglib ä»£ç†è¿›é˜¶</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_14-cglib-é¿å…åå°„è°ƒç”¨" class="sidebar-link reco-side-_14-cglib-é¿å…åå°„è°ƒç”¨" data-v-cb1513f6>14) cglib é¿å…åå°„è°ƒç”¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_15-jdk-å’Œ-cglib-åœ¨-spring-ä¸­çš„ç»Ÿä¸€" class="sidebar-link reco-side-_15-jdk-å’Œ-cglib-åœ¨-spring-ä¸­çš„ç»Ÿä¸€" data-v-cb1513f6>15) jdk å’Œ cglib åœ¨ Spring ä¸­çš„ç»Ÿä¸€</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_16-åˆ‡ç‚¹åŒ¹é…" class="sidebar-link reco-side-_16-åˆ‡ç‚¹åŒ¹é…" data-v-cb1513f6>16) åˆ‡ç‚¹åŒ¹é…</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_17-ä»-aspect-åˆ°-advisor" class="sidebar-link reco-side-_17-ä»-aspect-åˆ°-advisor" data-v-cb1513f6>17) ä» @Aspect åˆ° Advisor</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_18-é™æ€é€šçŸ¥è°ƒç”¨" class="sidebar-link reco-side-_18-é™æ€é€šçŸ¥è°ƒç”¨" data-v-cb1513f6>18) é™æ€é€šçŸ¥è°ƒç”¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_19-åŠ¨æ€é€šçŸ¥è°ƒç”¨" class="sidebar-link reco-side-_19-åŠ¨æ€é€šçŸ¥è°ƒç”¨" data-v-cb1513f6>19) åŠ¨æ€é€šçŸ¥è°ƒç”¨</a></li><li class="level-2" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#web" class="sidebar-link reco-side-web" data-v-cb1513f6>WEB</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_20-requestmappinghandlermapping-ä¸-requestmappinghandleradapter" class="sidebar-link reco-side-_20-requestmappinghandlermapping-ä¸-requestmappinghandleradapter" data-v-cb1513f6>20) RequestMappingHandlerMapping ä¸ RequestMappingHandlerAdapter</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_21-å‚æ•°è§£æå™¨" class="sidebar-link reco-side-_21-å‚æ•°è§£æå™¨" data-v-cb1513f6>21) å‚æ•°è§£æå™¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_22-å‚æ•°åè§£æ" class="sidebar-link reco-side-_22-å‚æ•°åè§£æ" data-v-cb1513f6>22) å‚æ•°åè§£æ</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_23-å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢" class="sidebar-link reco-side-_23-å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢" data-v-cb1513f6>23) å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_24-controlleradvice-ä¹‹-initbinder" class="sidebar-link reco-side-_24-controlleradvice-ä¹‹-initbinder" data-v-cb1513f6>24) @ControllerAdvice ä¹‹ @InitBinder</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_25-æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹" class="sidebar-link reco-side-_25-æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹" data-v-cb1513f6>25) æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_26-controlleradvice-ä¹‹-modelattribute" class="sidebar-link reco-side-_26-controlleradvice-ä¹‹-modelattribute" data-v-cb1513f6>26) @ControllerAdvice ä¹‹ @ModelAttribute</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_27-è¿”å›å€¼å¤„ç†å™¨" class="sidebar-link reco-side-_27-è¿”å›å€¼å¤„ç†å™¨" data-v-cb1513f6>27) è¿”å›å€¼å¤„ç†å™¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_28-messageconverter" class="sidebar-link reco-side-_28-messageconverter" data-v-cb1513f6>28) MessageConverter</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_29-controlleradvice-ä¹‹-responsebodyadvice" class="sidebar-link reco-side-_29-controlleradvice-ä¹‹-responsebodyadvice" data-v-cb1513f6>29) @ControllerAdvice ä¹‹ ResponseBodyAdvice</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_30-å¼‚å¸¸è§£æå™¨" class="sidebar-link reco-side-_30-å¼‚å¸¸è§£æå™¨" data-v-cb1513f6>30) å¼‚å¸¸è§£æå™¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_31-controlleradvice-ä¹‹-exceptionhandler" class="sidebar-link reco-side-_31-controlleradvice-ä¹‹-exceptionhandler" data-v-cb1513f6>31) @ControllerAdvice ä¹‹ @ExceptionHandler</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_32-tomcat-å¼‚å¸¸å¤„ç†" class="sidebar-link reco-side-_32-tomcat-å¼‚å¸¸å¤„ç†" data-v-cb1513f6>32) Tomcat å¼‚å¸¸å¤„ç†</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_33-beannameurlhandlermapping-ä¸-simplecontrollerhandleradapter" class="sidebar-link reco-side-_33-beannameurlhandlermapping-ä¸-simplecontrollerhandleradapter" data-v-cb1513f6>33) BeanNameUrlHandlerMapping ä¸ SimpleControllerHandlerAdapter</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_34-routerfunctionmapping-ä¸-handlerfunctionadapter" class="sidebar-link reco-side-_34-routerfunctionmapping-ä¸-handlerfunctionadapter" data-v-cb1513f6>34) RouterFunctionMapping ä¸ HandlerFunctionAdapter</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_35-simpleurlhandlermapping-ä¸-httprequesthandleradapter" class="sidebar-link reco-side-_35-simpleurlhandlermapping-ä¸-httprequesthandleradapter" data-v-cb1513f6>35) SimpleUrlHandlerMapping ä¸ HttpRequestHandlerAdapter</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_36-mvc-å¤„ç†æµç¨‹" class="sidebar-link reco-side-_36-mvc-å¤„ç†æµç¨‹" data-v-cb1513f6>36) mvc å¤„ç†æµç¨‹</a></li><li class="level-2" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#boot" class="sidebar-link reco-side-boot" data-v-cb1513f6>Boot</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_37-boot-éª¨æ¶é¡¹ç›®" class="sidebar-link reco-side-_37-boot-éª¨æ¶é¡¹ç›®" data-v-cb1513f6>37) Boot éª¨æ¶é¡¹ç›®</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_38-boot-waré¡¹ç›®" class="sidebar-link reco-side-_38-boot-waré¡¹ç›®" data-v-cb1513f6>38) Boot Waré¡¹ç›®</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_39-boot-å¯åŠ¨è¿‡ç¨‹" class="sidebar-link reco-side-_39-boot-å¯åŠ¨è¿‡ç¨‹" data-v-cb1513f6>39) Boot å¯åŠ¨è¿‡ç¨‹</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_40-tomcat-å†…åµŒå®¹å™¨" class="sidebar-link reco-side-_40-tomcat-å†…åµŒå®¹å™¨" data-v-cb1513f6>40) Tomcat å†…åµŒå®¹å™¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_41-boot-è‡ªåŠ¨é…ç½®" class="sidebar-link reco-side-_41-boot-è‡ªåŠ¨é…ç½®" data-v-cb1513f6>41) Boot è‡ªåŠ¨é…ç½®</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_42-æ¡ä»¶è£…é…åº•å±‚" class="sidebar-link reco-side-_42-æ¡ä»¶è£…é…åº•å±‚" data-v-cb1513f6>42) æ¡ä»¶è£…é…åº•å±‚</a></li><li class="level-2" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#å…¶å®ƒ" class="sidebar-link reco-side-å…¶å®ƒ" data-v-cb1513f6>å…¶å®ƒ</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_43-factorybean" class="sidebar-link reco-side-_43-factorybean" data-v-cb1513f6>43) FactoryBean</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_44-indexed-åŸç†" class="sidebar-link reco-side-_44-indexed-åŸç†" data-v-cb1513f6>44) @Indexed åŸç†</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_45-ä»£ç†è¿›ä¸€æ­¥ç†è§£" class="sidebar-link reco-side-_45-ä»£ç†è¿›ä¸€æ­¥ç†è§£" data-v-cb1513f6>45) ä»£ç†è¿›ä¸€æ­¥ç†è§£</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_46-value-è£…é…åº•å±‚" class="sidebar-link reco-side-_46-value-è£…é…åº•å±‚" data-v-cb1513f6>46) @Value è£…é…åº•å±‚</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_47-autowired-è£…é…åº•å±‚" class="sidebar-link reco-side-_47-autowired-è£…é…åº•å±‚" data-v-cb1513f6>47) @Autowired è£…é…åº•å±‚</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_48-äº‹ä»¶ç›‘å¬å™¨" class="sidebar-link reco-side-_48-äº‹ä»¶ç›‘å¬å™¨" data-v-cb1513f6>48) äº‹ä»¶ç›‘å¬å™¨</a></li><li class="level-3" data-v-cb1513f6><a href="/Blog/guide/interview/spriiiiing.html#_49-äº‹ä»¶å‘å¸ƒå™¨" class="sidebar-link reco-side-_49-äº‹ä»¶å‘å¸ƒå™¨" data-v-cb1513f6>49) äº‹ä»¶å‘å¸ƒå™¨</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/Blog/assets/js/app.4417eb82.js" defer></script><script src="/Blog/assets/js/3.2daec6eb.js" defer></script><script src="/Blog/assets/js/1.3441dec7.js" defer></script><script src="/Blog/assets/js/44.155af8d3.js" defer></script>
  </body>
</html>
